<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>可观测性 on Martin Liu's Blog</title><link>https://martinliu.cn/tags/%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7/</link><description>Recent content in 可观测性 on Martin Liu's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Thu, 19 Sep 2024 11:22:53 +0800</lastBuildDate><atom:link href="https://martinliu.cn/tags/%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7/index.xml" rel="self" type="application/rss+xml"/><item><title>2024 年 Gartner 可观测性平台魔力象限</title><link>https://martinliu.cn/blog/2024-magic-quadrant-for-observability-platforms/</link><pubDate>Thu, 15 Aug 2024 10:04:45 +0800</pubDate><guid>https://martinliu.cn/blog/2024-magic-quadrant-for-observability-platforms/</guid><description>&lt;img src="https://martinliu.cn/blog/2024-magic-quadrant-for-observability-platforms/pexels-pavel-danilyuk-9143804.jpg" alt="Featured image of post 2024 年 Gartner 可观测性平台魔力象限" />&lt;p>可观测性平台通过分析、可视化、自动化以及 AI 技术，将遥测数据转化为可执行的洞察。虽然大多数平台都包括应用性能监控（APM）功能，但仅靠 APM 是不够的。I&amp;amp;O 领导者可以参考此研究，探索相关供应商及解决方案。&lt;/p>
&lt;h2 id="市场定义与描述">市场定义与描述
&lt;/h2>&lt;p>Gartner 将可观测性平台定义为：能够从日志、指标、事件和追踪等多种来源获取遥测数据（运营数据）的产品。它们旨在帮助企业了解应用、服务及基础设施的健康状况、性能表现，及行为趋势。可观测性平台可以通过人工操作或机器智能分析遥测数据，识别影响终端用户体验的系统行为变化，例如服务中断或性能下降。这些平台可以让问题在早期，甚至是预防阶段就得到解决。可观测性解决方案被广泛的应用于 IT 运营/运维、站点稳定性工程师/SRE、云与平台团队、应用开发人员，以及产品负责人。&lt;/p>
&lt;p>现代企业高度依赖关键的数字应用和服务，这些应用和服务不仅是创收工具，还直接影响客户体验和企业运营效率。中断、性能下降和不稳定现象都会直接冲击企业的营收、客户满意度及品牌形象。&lt;/p>
&lt;p>可观测性平台能帮助企业提升关键应用和服务的可用性、性能和恢复力。成功投资和部署可观测性平台能够避免收入损失，同时加快产品开发周期，改善品牌形象。&lt;/p>
&lt;p>以下是可观测性平台解决的一些典型场景或业务问题：&lt;/p>
&lt;ul>
&lt;li>&lt;strong>IT 运营&lt;/strong>：IT 运营团队负责确保生产环境中的应用和服务始终可用、迅速响应且性能卓越，尤其是在高峰期。可观测性平台可以在问题出现时及时发出告警，并帮助团队通过数据分析找到根本原因。&lt;/li>
&lt;li>&lt;strong>平台工程&lt;/strong>：平台工程师的工作类似于 IT 运营和软件开发。可观测性平台帮助他们确保生产环境始终达到服务质量目标 (SLO)，同时推动持续的数据驱动改进与平台优化。&lt;/li>
&lt;li>&lt;strong>软件开发&lt;/strong>：开发团队将可观测性平台集成到 CI/CD 流水线中，提供新代码部署的快速反馈，加快新功能发布，同时提高产品的恢复力。&lt;/li>
&lt;li>&lt;strong>业务分析&lt;/strong>：业务分析师利用可观测性平台分析企业的关键业务指标，例如零售商可能会评估放弃购物车的成本和客户的平均消费金额。&lt;/li>
&lt;/ul>
&lt;h3 id="必备功能">必备功能
&lt;/h3>&lt;p>可观测性平台至少应具备以下基本功能：&lt;/p>
&lt;ul>
&lt;li>获取、存储并分析运营遥测数据流，数据来源包括但不限于指标、事件、日志和追踪信息。&lt;/li>
&lt;li>识别并分析应用、服务或基础设施的行为变化，从而判断是否存在可用性中断、性能下降，或是否对终端用户体验产生了影响。&lt;/li>
&lt;li>通过提供拓扑依赖关系映射和业务服务之间的关联，为遥测数据增加上下文信息，进一步丰富数据内容。&lt;/li>
&lt;/ul>
&lt;h3 id="常见功能">常见功能
&lt;/h3>&lt;p>可观测性平台通常具备以下功能：&lt;/p>
&lt;ul>
&lt;li>监控通过浏览器、移动应用和 API 提供的应用与服务的用户体验。&lt;/li>
&lt;li>与其他运营管理、服务管理和软件开发技术集成，如 IT 服务管理、配置管理数据库、事件与事故响应管理、编排与自动化及 DevOps 工具。&lt;/li>
&lt;li>从公有云平台（如 Amazon CloudWatch、Microsoft Azure Monitor 和 Google Cloud Operations）收集遥测数据。&lt;/li>
&lt;li>支持多种遥测数据类型（如追踪、指标和日志）的交互式分析，帮助深入了解用户与应用行为。&lt;/li>
&lt;li>借助高级分析与机器学习，提供基于数据的洞察，超越手动查询或分析的能力。&lt;/li>
&lt;li>自动发现并映射相关的基础设施、网络和应用组件及服务。&lt;/li>
&lt;li>支持成本管理功能，能够度量和优化应用工作负载成本，或优化可观测性平台的利用率和支出。&lt;/li>
&lt;li>业务流程与活动监控，例如用户的登录到结账流程、转化率追踪漏斗分析、客户注册或贷款申请的流程。&lt;/li>
&lt;li>提供应用安全功能，能够识别受监控应用中的已知漏洞，并阻止对这些漏洞的攻击尝试。&lt;/li>
&lt;/ul>
&lt;h2 id="魔力象限">魔力象限
&lt;/h2>&lt;p>&lt;img src="https://martinliu.cn/blog/2024-magic-quadrant-for-observability-platforms/Figure-1.png"
width="570"
height="592"
srcset="https://martinliu.cn/blog/2024-magic-quadrant-for-observability-platforms/Figure-1_hu_1975c31a63051b2f.png 480w, https://martinliu.cn/blog/2024-magic-quadrant-for-observability-platforms/Figure-1_hu_8dc0e52a0a3e012f.png 1024w"
loading="lazy"
alt="图 1: Y24Q3 可观测性平台魔力象限"
class="gallery-image"
data-flex-grow="96"
data-flex-basis="231px"
>&lt;/p>
&lt;p>供应商优势与注意事项分析如下。&lt;/p>
&lt;h3 id="amazon-web-services">Amazon Web Services
&lt;/h3>&lt;p>Amazon Web Services (AWS) 在此次魔力象限中被归类为挑战者。AWS 的可观测性解决方案包括 Amazon CloudWatch、AWS X-Ray、Amazon Managed Service for Prometheus、Amazon Managed Grafana 和 AWS Distro for OpenTelemetry，支持端到端的 observability 使用场景。这些服务是 AWS Cloud Operations 的一部分，涵盖治理和财务管理。AWS 的业务遍布全球，其客户主要为大型企业，并且 AWS 定期发布和更新产品。&lt;/p>
&lt;h4 id="优势">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>应用信号&lt;/strong>：AWS 于 2023 年末推出了 CloudWatch Application Signals，这是第一个专注于应用程序监控的 CloudWatch 服务。通过此服务，运维人员可以通过设定服务质量目标 (SLO) 并使用服务视图来管理系统健康和性能，同时对出现的问题进行分类。&lt;/li>
&lt;li>&lt;strong>统一的可观测性平台&lt;/strong>：AWS 支持 OpenTelemetry、Prometheus 和 Selenium 等行业标准，提升了跨平台的互操作性。即使没有使用代理，AWS 之外的工作负载也可以通过 Managed Grafana 服务进行监控和可视化。&lt;/li>
&lt;li>&lt;strong>全球影响力&lt;/strong>：AWS 在全球范围内扩展迅速，已宣布新增四个地区和 18 个本地区域。Observability 服务全球可用，客户可以根据需求决定如何设置遥测数据在生命周期中的存储策略。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>竞争环境&lt;/strong>：尽管 AWS 可观测性工具近年来有所改进，如推出 CloudWatch Application Signals 和 Internet Monitor，但 AWS 也为本研究中的许多供应商提供托管服务，并通过 AWS Marketplace 与其合作。此种合作关系在时间上优先考虑客户选择，但与 AWS 平台的统一性存在矛盾。&lt;/li>
&lt;li>&lt;strong>成本管理&lt;/strong>：与 AWS 其他服务类似，observability 按需付费，基于多种消费模式，可能不完全适应所有运营模式或使用场景。&lt;/li>
&lt;li>&lt;strong>服务复杂性&lt;/strong>：AWS 提供多达 28 种监控与 observability 服务，尽管这展示了广泛的产品线，但也容易引起客户混淆。改进的文档有助于客户根据实际需求区分 CloudWatch 的功能。&lt;/li>
&lt;/ul>
&lt;h3 id="bmc">BMC
&lt;/h3>&lt;p>BMC 在本次魔力象限中被归类为利基参与者。其 BMC Helix Operations Management 平台提供了丰富的 ServiceOps 和 observability 功能，涵盖 BMC Helix Discovery 及其他组件。BMC 在 IT 服务管理领域中拥有重要地位，其 BMC Helix ITSM（前称 Remedy）产品以及主机解决方案有着广泛的应用。BMC 的业务覆盖全球主要市场。&lt;/p>
&lt;h4 id="优势-1">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>广泛的客户基础&lt;/strong>：作为传统的“四大” IT 运营技术供应商之一，BMC 在大型企业和政府机构中具有重要影响力。这种既有的影响力使 BMC 在向 observability 过渡时具备优势。&lt;/li>
&lt;li>&lt;strong>服务运营集成&lt;/strong>：BMC 的可观测性解决方案可以与第三方工具兼容，同时与其自身的 ITSM、发现工具和 CMDB 紧密集成，具有潜在的工具整合优势。&lt;/li>
&lt;li>&lt;strong>故障分析工具&lt;/strong>：该平台提供健康时间线和健康评分功能，帮助用户了解应用程序或服务的性能变化，还支持快速检查变化情况。它还具备“情况解释”功能，通过 BMC HelixGPT 等 AI 技术，解释问题可能的根本原因。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-1">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>产品组合复杂性&lt;/strong>：BMC 的解决方案依赖其众多产品组件，尽管可以单独授权使用，但某些功能仍需依赖自定义仪表板。例如，SLO 功能并非开箱即用。&lt;/li>
&lt;li>&lt;strong>定价不透明&lt;/strong>：BMC 未公开其定价，除非是针对政府客户或云市场的定价。这与 observability 行业的趋势不符，客户通常希望在早期获取价格信息以进行成本评估。&lt;/li>
&lt;li>&lt;strong>现有 BMC 环境&lt;/strong>：BMC 的大部分客户仍在使用其旧有技术，如 BMC PATROL 和 TrueSight。BMC 已对其产品进行现代化改造，如推出云原生的 Helix 平台，并收购了 Netreo。因此，客户需要明确的升级路径指导，以顺利过渡到新平台。&lt;/li>
&lt;/ul>
&lt;h3 id="chronosphere">Chronosphere
&lt;/h3>&lt;p>Chronosphere 在此次魔力象限中被评为领导者。其可观测性平台解决方案包括 Chronosphere Observability Platform 和 Chronosphere Telemetry Pipeline，业务主要集中在美国和 EMEA 地区，客户大多来自北美。&lt;/p>
&lt;p>Chronosphere 的创始人在 Uber 工作期间开发了 M3DB 时间序列数据库，如今公司仍在支持这一开源项目。近期，Chronosphere 收购了遥测管道供应商 Calyptia（Fluent Bit 的创建者），并与 CrowdStrike 建立了合作，作为其日志获取和分析产品的基础。&lt;/p>
&lt;h4 id="优势-2">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>遥测数据管理与治理&lt;/strong>：Chronosphere 提供一个控制平面，客户可以使用该平台分析遥测数据的使用情况，并在数据收集时制定策略与规则。这使得成本优化和数据治理变得更加高效，这是其他供应商难以提供的功能。&lt;/li>
&lt;li>&lt;strong>依托开源技术&lt;/strong>：Chronosphere 支持 Prometheus 风格的指标采集以及 OpenTelemetry，用于收集指标、日志和追踪数据。这为那些不愿继续自行管理 Prometheus 或 Jaeger 环境的组织提供了迁移便利。收购 Calyptia 也带来了 Fluent Bit 这一开源工具，进一步丰富了 Chronosphere 的遥测管道能力。&lt;/li>
&lt;li>&lt;strong>单租户架构&lt;/strong>：Chronosphere 为每位客户提供独立的租户环境和专属存储空间。这有效避免了不同客户之间的资源争用，同时提高了数据安全性。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-2">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>地理覆盖范围&lt;/strong>：尽管 Chronosphere 的服务可以在全球使用，但其平台目前仅托管在美国的公有云区域。这可能会引发某些客户对数据主权的担忧，或在某些地区导致延迟问题。公司计划于 2024 年在 EMEA 地区部署托管服务。&lt;/li>
&lt;li>&lt;strong>数字体验监控功能缺乏&lt;/strong>：Chronosphere 目前不提供专门的数字体验监控功能，如合成监控或真实用户监控（RUM）。虽然客户可以将数字体验监控的遥测数据上传至 Chronosphere 进行分析，但这些数据的生成和传输需要客户自行解决。&lt;/li>
&lt;li>&lt;strong>缺少自带代理&lt;/strong>：Chronosphere 不包含自带的埋点代理，因此被监控的系统需要以与 Prometheus 或 OpenTelemetry 兼容的方式进行埋点，或使用 Fluent Bit 支持的格式。Chronosphere 也支持从其他供应商的代理获取遥测数据，客户可选择兼容的代理进行使用。&lt;/li>
&lt;/ul>
&lt;h3 id="datadog">Datadog
&lt;/h3>&lt;p>Datadog 在此次魔力象限中被评为领导者。其 SaaS 平台不仅提供可观测性解决方案，还覆盖云安全领域。Datadog 的业务主要集中在美国和 EMEA 地区，同时在亚太和拉丁美洲市场逐步扩展，服务的客户从初创企业到大型企业。近期，Datadog 对其平台进行了多项改进，包括升级仪表板、笔记本和 Watchdog AI 功能，推出了 Flex Logs、移动应用测试、数据流监控以及动态埋点功能。此外，还推出了事件管理功能，将 Datadog 和其他 可观测性工具中的事件整合到统一视图中进行管理。&lt;/p>
&lt;h4 id="优势-3">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>战略愿景与销售执行力&lt;/strong>：Datadog 迅速构建了多项新功能，涵盖 APM、日志管理、数字体验监控（DEM）、安全和软件交付等领域，赢得了许多寻求高端解决方案的企业的青睐。其产品驱动增长（PLG）模式帮助企业在大中小规模的组织中扩大客户基础并提升客户参与度。&lt;/li>
&lt;li>&lt;strong>可视化能力&lt;/strong>：Datadog 提供了强大且用户友好的可视化功能，使用户能够在一个界面中查看所有遥测数据，并支持通过小部件轻松定制仪表板。&lt;/li>
&lt;li>&lt;strong>产品发展路线&lt;/strong>：Datadog 具备强大的产品发展规划，专注于提升 observability、DevSecOps、自动化修复、软件交付以及遥测数据的治理。其策略是打造一个将所有功能无缝整合在一起的平台。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-3">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>定价问题&lt;/strong>：虽然 Datadog 在官网上提供了详细的定价信息，但一些客户反映，随着使用量的增长，成本可能迅速上升。为了应对这一问题，Datadog 提供了可配置的遥测数据获取控制，帮助客户在预算范围内管理成本。&lt;/li>
&lt;li>&lt;strong>复杂的业务模式&lt;/strong>：随着产品线的扩展，Datadog 目前在其官网上提供 20 个独立的产品模块，每个模块都有独立的定价结构，这可能让客户在理解和谈判价格时感到困惑。为了简化流程，Datadog 已开始推出捆绑产品选项。&lt;/li>
&lt;li>&lt;strong>代理管理功能缺乏&lt;/strong>：目前，Datadog 缺乏针对代理群组的管理和自动化部署功能，这给大规模部署带来了一定的复杂性。该公司表示，相关功能正在开发中，并已进入测试阶段。&lt;/li>
&lt;/ul>
&lt;h3 id="dynatrace">Dynatrace
&lt;/h3>&lt;p>Dynatrace 在此次魔力象限中被评为领导者。其 observability 和安全平台包含多个模块，包括基础设施与应用可观测性、安全分析与防护、数字体验管理、自动化功能以及业务分析。Dynatrace 的客户遍布全球，尤其集中在拉丁美洲、亚太地区等各大市场，主要为大型企业和科技驱动型公司。Dynatrace 最近收购了开发者工具供应商 Rookout 和安全厂商 Runecast，进一步扩展其产品线。&lt;/p>
&lt;h4 id="优势-4">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>广泛的产品组合&lt;/strong>：Dynatrace 提供全面的 observability 和安全解决方案，尤其受到大型企业的青睐。其覆盖范围包括现代架构（如 Kubernetes、容器、云函数）的可观测性，及主机和 SAP 等传统企业解决方案的监控。&lt;/li>
&lt;li>&lt;strong>AI 技术创新&lt;/strong>：Dynatrace 对其 Davis AI 引擎进行了重大升级，全面采用 AI 技术进行因果分析和预测建模，并且推出了基于生成式 AI 的智能助手，显著提升了平台的智能化水平。&lt;/li>
&lt;li>&lt;strong>平台的灵活性与扩展性&lt;/strong>：Dynatrace 的 AppEngine 和 AutomationEngine 使平台具备更强的扩展能力，用户和第三方开发者可以针对特定行业或业务需求开发定制应用和自动化流程，超越了简单的健康监控和性能分析。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-4">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>采购的复杂性&lt;/strong>：Dynatrace 于 2023 年引入了新的订阅模式 Dynatrace Platform Subscription（DPS），要求客户承诺年度最低消费额度并使用递减率定价机制。虽然很多客户接受了该模式，并能够使用所有的 Dynatrace 产品，但一些采购部门对最低承诺和新组件的定价模式保持谨慎。&lt;/li>
&lt;li>&lt;strong>日志管理应用的进展缓慢&lt;/strong>：尽管 Dynatrace 在 2023 年推出了新机制，能够高效处理大量日志数据，客户对此技术表示出浓厚兴趣，但目前并未出现广泛采用 Dynatrace 进行大规模日志管理的趋势。&lt;/li>
&lt;li>&lt;strong>对中小企业的适应性&lt;/strong>：Dynatrace 主要为大型企业设计，虽然通过公有云市场可以降低部分门槛，但中小企业可能因为成本原因，选择将其用于监控最核心的业务系统。&lt;/li>
&lt;/ul>
&lt;h3 id="elastic">Elastic
&lt;/h3>&lt;p>Elastic 在此次魔力象限中被评为领导者。Elastic Observability 基于广泛使用的 Elastic Search AI 平台（原 Elasticsearch）构建，同时支撑其搜索和安全产品。Elastic Observability 可以通过 SaaS 提供，也可自托管使用。公司总部位于北美，客户主要分布在美洲和 EMEA 地区，并在亚太地区实现了显著增长。Elastic 的未来发展规划包括通过新查询语言和 AI 助手提升分析能力和站点稳定性工程（SRE）效率。&lt;/p>
&lt;h4 id="优势-5">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>深度 AI 集成&lt;/strong>：Elastic 在其平台中深度集成了 AI，提供 30 多种机器学习模型、定制模型集成，并配备了基于检索增强生成（RAG）的 AI 助手，增强了传统数据分析能力。&lt;/li>
&lt;li>&lt;strong>开放性与灵活性&lt;/strong>：Elastic Observability 源自开源的 Elasticsearch 数据平台，能够在大规模下处理多样化的高基数数据。其开放架构为平台提供了极高的灵活性和可扩展性。&lt;/li>
&lt;li>&lt;strong>多样化的部署选择&lt;/strong>：Elastic Observability 支持全球多个区域的部署，涵盖所有主要云服务提供商，并提供自托管选项。这使得它能够满足不同客户的数据主权需求，并符合区域性法规要求，例如美国政府的 FedRAMP 认证。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-5">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>市场认知度低&lt;/strong>：尽管 Elastic 的搜索和安全产品知名度较高，但其可观测性产品的市场认知度和应用率仍有待提升。公司正在积极推动其可观测性产品的市场销售和推广。&lt;/li>
&lt;li>&lt;strong>学习曲线较陡峭&lt;/strong>：作为开源软件，Elastic 可能需要更多的学习和培训时间，尤其是对于计划自托管的组织，需确保有足够的技术能力支持。&lt;/li>
&lt;li>&lt;strong>定价模型复杂&lt;/strong>：Elastic 采用基于计算资源的定价模型，与其他厂商的定价模式不同。尽管 Elastic 提供了定价计算器，但在采购、成本评估和预算预测过程中，可能较难进行直观比较。&lt;/li>
&lt;/ul>
&lt;h3 id="grafana-labs">Grafana Labs
&lt;/h3>&lt;p>Grafana Labs 也是本次魔力象限中的领导者。公司创建于开源项目 Grafana 之上，并推出了诸如 Loki、Tempo、Mimir 等其他开源项目。Grafana Labs 的可观测性平台包括 Grafana Cloud 可视化、指标、日志、配置文件以及机器学习功能，客户遍布全球，主要集中在美洲和 EMEA 地区。&lt;/p>
&lt;h4 id="优势-6">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>全球托管灵活性&lt;/strong>：Grafana Cloud 目前在全球 19 个 AWS、Azure 和 GCP 区域托管，使客户能够根据延迟需求和数据主权选择合适的托管位置。&lt;/li>
&lt;li>&lt;strong>持续功能更新&lt;/strong>：在过去的 12 个月里，Grafana Labs 显著增强了 Grafana Cloud 的功能，特别是在应用程序监控、SLO 管理和自适应指标方面，这些功能可以帮助企业更有效地管理成本。&lt;/li>
&lt;li>&lt;strong>灵活的数据集成&lt;/strong>：Grafana 平台能够连接不同的遥测收集系统，并实现跨系统的数据可视化和告警，避免了数据迁移或存储在 Grafana Cloud 中的需求，极大增强了其组合能力。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-6">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>学习曲线较高&lt;/strong>：随着功能的不断扩展，掌握 Grafana 平台变得更加复杂，配置可能需要手动编辑 YAML 或 JSON 文件，这对初学者来说具有挑战性。&lt;/li>
&lt;li>&lt;strong>成本预测困难&lt;/strong>：新用户可能会发现难以预测在 Grafana Cloud 上的指标支出，尤其是活动系列和每分钟数据点等度量标准并不容易获得。使用免费的 Grafana Cloud 版本可能有助于缓解这一问题。&lt;/li>
&lt;li>&lt;strong>合作竞争关系的复杂性&lt;/strong>：Grafana Labs 与其他 observability 供应商之间的合作关系可能会变得复杂，尤其是在其自身业务快速扩展的情况下。尽管与 AWS、Google 和 Microsoft 的合作有助于缓解这一问题，但仍需保持关注。&lt;/li>
&lt;/ul>
&lt;h3 id="honeycomb">Honeycomb
&lt;/h3>&lt;p>Honeycomb 是本次魔力象限中的远见者。其 observability 服务基于优化的数据存储和查询引擎，专注于探测应用和基础设施中的模式和异常。Honeycomb 作为可观测性平台，支持 APM 使用场景，并以 SaaS 形式提供服务。其客户遍布全球，主要集中在北美和 EMEA 地区。&lt;br>
最近的更新包括推出了 Kubernetes 监控功能和前端可观测性功能（现阶段为早期访问版本）。&lt;/p>
&lt;h4 id="优势-7">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>Kubernetes 专用工具&lt;/strong>：2023 年，Honeycomb 推出了 Kubernetes 监控工具，使 SRE 能够更快速地诊断容器化环境中的问题。&lt;/li>
&lt;li>&lt;strong>高度参与的客户社区&lt;/strong>：Honeycomb 与其用户群保持紧密联系，定期举办研讨会，活跃的 Slack 社区以及社交媒体互动，让客户能够直接提供反馈。&lt;/li>
&lt;li>&lt;strong>全球化扩展&lt;/strong>：2024 年初，Honeycomb 在欧洲部署了基于 SaaS 的新实例，使客户能够根据数据主权要求选择将 observability 数据存储在美国、欧盟，或同时存储在两者之间。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-7">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>企业市场的影响力有限&lt;/strong>：虽然 Honeycomb 在云原生和技术驱动型企业中很受欢迎，但在更广泛的企业市场中其影响力相对较小，Gartner 客户较少将其作为可观测性平台的候选供应商。&lt;/li>
&lt;li>&lt;strong>技术导向的聚焦&lt;/strong>：Honeycomb 的宣传主要面向技术专家，特别是 SRE 和平台团队，可能忽略了提供商业和客户行为洞察的潜力，而这些内容往往是 I&amp;amp;O 预算持有者更关心的。&lt;/li>
&lt;li>&lt;strong>定价难以预测&lt;/strong>：Honeycomb 的定价基于摄取到平台中的事件量，客户难以预测事件数量以及未来 12 个月的增长。&lt;/li>
&lt;/ul>
&lt;h3 id="ibm">IBM
&lt;/h3>&lt;p>IBM 是本次魔力象限中的远见者。IBM 的 Instana可观测性平台既可以作为 SaaS 提供，也可以通过自托管方式部署，使用单代理架构。其客户主要为中大型企业，集中在北美和西欧。IBM 的监控产品覆盖从主机到现代云架构。IBM 还计划收购基础设施自动化公司 HashiCorp，该公司的 Terraform 产品与许多可观测性平台都有集成。&lt;/p>
&lt;h4 id="优势-8">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>精确的遥测数据&lt;/strong>：Instana 以每秒级别的精度收集指标，并在三秒内生成通知，这为提升可用性和确保服务质量目标 (SLO) 达成提供了支持。&lt;/li>
&lt;li>&lt;strong>简单的定价模式&lt;/strong>：IBM Instana 采用按主机计费的简单定价模式，在市场中具备竞争力。&lt;/li>
&lt;li>&lt;strong>AI 集成优势&lt;/strong>：Instana 提供自动化 observability，利用 AI 生成洞察并辅助决策。IBM 最近推出了 watsonx 和 Concert，这些生成式 AI 技术将进一步扩展 Instana 的智能化功能。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-8">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>有限的安全功能&lt;/strong>：Instana 的安全功能较为有限，更多依赖 IBM 其他产品提供这方面的支持。虽然 Gartner 认为安全功能是可选的，但客户需要根据需求决定是否需要集成安全解决方案。&lt;/li>
&lt;li>&lt;strong>市场认知度不足&lt;/strong>：IBM Instana 在市场中的知名度较低，很多现有的 IBM 客户甚至不知道这一产品的存在，即使他们正在寻找可观测性解决方案。虽然 IBM 为使用其传统 IT 工具的客户提供了升级到 Instana 的路径，但很多客户对此并不知情。&lt;/li>
&lt;li>&lt;strong>日志摄取的限制&lt;/strong>：目前 Instana 的日志摄取仅限于应用日志和容器化环境。扩展到更广泛的环境是其 2024 年的发展计划之一。&lt;/li>
&lt;/ul>
&lt;h3 id="logicmonitor">LogicMonitor
&lt;/h3>&lt;p>LogicMonitor 是本次魔力象限中的远见者。其 LM Envision 平台从混合基础设施监控发展为可观测性解决方案。LogicMonitor 提供无代理的 SaaS 平台，涵盖基础设施、网络、SD-WAN、云和应用监控，并具备 AI 功能。客户主要来自美洲和 EMEA，且在亚太地区业务不断扩展。过去一年内，LogicMonitor 发布了多项新工具，包括 Edwin AI（用于事件摄取与关联）、生成式 AI 聊天机器人 LM Copilot 以及用于云成本管理的 LM 成本优化。&lt;/p>
&lt;h4 id="优势-9">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>高扩展性&lt;/strong>：LogicMonitor 使用无代理收集器来监控资源，这些收集器可根据服务器容量和数据需求进行自动负载均衡，确保高数据处理能力，并支持故障切换。其平台提供 99.9% 的可用性 SLA，确保监控始终可用。&lt;/li>
&lt;li>&lt;strong>容器支持广泛&lt;/strong>：LogicMonitor 对 Kubernetes 容器环境提供了强大的支持，无需修改容器代码即可进行监控。&lt;/li>
&lt;li>&lt;strong>简单定价&lt;/strong>：LogicMonitor 的定价模式简洁明了，适用于各种规模的企业，尤其适合托管服务提供商（MSP）模式下的企业。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-9">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>observability 功能有限&lt;/strong>：尽管 LogicMonitor 近年来有所投资，但它仍然主要专注于基础设施和网络监控，缺乏数字体验监控和威胁检测等功能，与同行相比存在差距。&lt;/li>
&lt;li>&lt;strong>仪表板和用户界面&lt;/strong>：尽管提供了多种监控模板，但 LogicMonitor 的用户界面在市场上相对落后，操作时需要多次点击才能深入分析数据和获取上下文信息。公司正在发布新界面，预计将有所改善。&lt;/li>
&lt;li>&lt;strong>市场影响力&lt;/strong>：尽管投入了大量市场宣传，但 LogicMonitor 在市场上的认知度仍然有限，特别是在 observability 领域的扩展上，客户认知度仍需提升。&lt;/li>
&lt;/ul>
&lt;h3 id="logzio">Logz.io
&lt;/h3>&lt;p>Logz.io 作为远见者，基于开源技术提供其 Open 360可观测性平台，涵盖应用、Kubernetes 和基础设施监控，支持日志管理和云安全信息及事件管理（SIEM）。Logz.io 的客户多为开源技术友好的中小型企业，主要分布在美洲和 EMEA 地区。其未来规划包括进一步利用生成式 AI 增强平台能力，并引入业务导向功能，如 SLO 管理。&lt;/p>
&lt;h4 id="优势-10">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>成本优化&lt;/strong>：Logz.io 专注于降低 observability 成本，其数据优化中心提供强大的遥测成本管理功能，如数据过滤、分层存储、追踪采样等。&lt;/li>
&lt;li>&lt;strong>从开源到企业的无缝衔接&lt;/strong>：对于已经使用开源监控工具的企业，Logz.io 提供了快速实现企业级 observability 的路径。&lt;/li>
&lt;li>&lt;strong>全球化业务&lt;/strong>：Logz.io 的 Open 360 平台在全球多个 SaaS 实例上运行，支持多语言并符合区域性数据安全法规，客户遍布全球。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-10">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>缺乏前端监控&lt;/strong>：Logz.io 主要专注于通过开源技术收集后台遥测数据，但在前端用户监控和会话回放等功能方面支持不足。&lt;/li>
&lt;li>&lt;strong>技术导向过强&lt;/strong>：Logz.io 平台过于关注技术细节，缺少业务监控和漏斗分析等更贴合商业需求的功能。&lt;/li>
&lt;li>&lt;strong>市场知名度不足&lt;/strong>：尽管 Logz.io 的客户基础在增长，但主要集中在中小型企业，与其他供应商相比，其市场可见度较低，较少出现在客户的候选名单中。&lt;/li>
&lt;/ul>
&lt;h3 id="microsoft">Microsoft
&lt;/h3>&lt;p>Microsoft 在此次魔力象限中被评为挑战者。其 Azure Monitor 是一款原生的 Azure 可观测性平台，专注于中大型企业。公司业务遍布全球。除了引入生成式 AI 功能外，Microsoft 的未来计划还包括一种低成本的日志存储机制和基于服务组的应用建模。&lt;/p>
&lt;h4 id="优势-11">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>AI 集成&lt;/strong>：Microsoft 与 OpenAI 的合作带来了生成式 AI 能力，如通过 Copilot 接口集成到 Azure Monitor 中。Kusto Query Language (KQL) 也支持机器学习，并可以创建处理日志数据的机器学习流水线。&lt;/li>
&lt;li>&lt;strong>Prometheus 支持&lt;/strong>：Azure Monitor 引入了 Prometheus 托管服务，支持从 Azure Kubernetes Service (AKS) 等服务摄取数据，利用 PromQL 进行分析，并通过 Grafana 实现可视化和告警功能。&lt;/li>
&lt;li>&lt;strong>安全监控集成&lt;/strong>：Microsoft 的 Sentinel 和 Defender 产品与 Azure Monitor 无缝集成，提供跨运营和安全功能的统一分析和事件响应能力。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-11">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>SLO 管理缺乏&lt;/strong>：Azure Monitor 尚未提供直接的 SLO 管理功能，相关功能预计在 2024 年推出。当前的 SLO 管理流程相对繁琐。&lt;/li>
&lt;li>&lt;strong>OpenTelemetry 支持延迟&lt;/strong>：尽管 Azure Monitor 可以摄取 OpenTelemetry 数据，但尚不支持直接通过收集器接口处理 OpenTelemetry Protocol (OTLP) 数据。相关功能在 2024 年进入公测。&lt;/li>
&lt;li>&lt;strong>Prometheus 兼容性问题&lt;/strong>：Azure Monitor 对 Prometheus 的支持目前与开源版本存在一些不兼容问题。&lt;/li>
&lt;/ul>
&lt;h3 id="new-relic">New Relic
&lt;/h3>&lt;p>New Relic 在此次魔力象限中被评为领导者。其可观测性平台以 SaaS 形式提供，涵盖 APM、AI 监控、数字体验、基础设施监控、日志管理和安全功能。客户主要为中大型企业，遍布美洲、EMEA 和亚太地区。最近，New Relic 在日志存储优化、AI 监控和应用安全方面进行了增强，并在 2023 年 11 月被 Francisco Partners 和 TPG 收购。&lt;/p>
&lt;h4 id="优势-12">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>灵活的定价&lt;/strong>：New Relic 提供基于摄取量和用户数量的定价模式，以及新的基于计算量的定价，客户可以根据使用量灵活调整成本。&lt;/li>
&lt;li>&lt;strong>AI 监控&lt;/strong>：New Relic 的 AI 监控功能使工程师能够监控 AI 模型的性能，并比较大语言模型（LLM）的成本和效率。&lt;/li>
&lt;li>&lt;strong>统一的数据平台&lt;/strong>：New Relic 的遥测数据平台 (TDP) 专为高效管理遥测数据而优化，支持高基数数据，并原生支持 OpenTelemetry。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-12">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>实施复杂性&lt;/strong>：一些客户反映，初始设置和配置过程较为复杂，特别是对于不熟悉该平台的用户。&lt;/li>
&lt;li>&lt;strong>地理覆盖有限&lt;/strong>：New Relic 的服务交付平台主要位于美国和 EMEA，特别是依赖 AWS 托管的 SaaS 平台。亚太地区的企业可能需要确保其服务符合区域性要求。&lt;/li>
&lt;li>&lt;strong>收购影响&lt;/strong>：New Relic 被收购后，客户对其产品路线图和稳定性有所关注。公司表示已加大平台创新投资，但未来发展仍有待观察。&lt;/li>
&lt;/ul>
&lt;h3 id="oracle">Oracle
&lt;/h3>&lt;p>Oracle 在本次魔力象限中被评为利基参与者。其 Oracle Cloud Observability and Management (O&amp;amp;M) 平台支持混合和多云环境中的应用、日志、基础设施和数据库监控，尤其侧重于 Oracle Cloud Infrastructure (OCI) 和企业应用。Oracle 客户遍布全球，涵盖各行业的中大型企业，包括政府机构。未来，Oracle 计划进一步提升 O&amp;amp;M 为 SRE 团队的体验，集成 ITSM，并专注于日志管理和分析。&lt;/p>
&lt;h4 id="优势-13">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>全球覆盖&lt;/strong>：Oracle 拥有全球化的业务，支持多种语言，并符合区域性法规要求。通过欧盟主权云、FedRAMP 认证以及 OCI 专用区域，Oracle 提供了符合数据主权要求的解决方案。&lt;/li>
&lt;li>&lt;strong>全面的 Oracle 集成&lt;/strong>：Oracle 的 O&amp;amp;M 不仅适用于 OCI，还支持 E-Business Suite 和 PeopleSoft 等应用，客户可以使用定制仪表板和自动化监控，提升用户体验。&lt;/li>
&lt;li>&lt;strong>多云支持&lt;/strong>：Oracle 一直致力于提供支持多云环境的 O&amp;amp;M 解决方案，不局限于自家生态，适应多云工作负载的需求。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-13">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>市场认知度较低&lt;/strong>：虽然 Oracle 将 O&amp;amp;M 定位为多云解决方案，但该产品在现有客户群之外的认知度较低，较少出现在 Gartner 的客户咨询中。&lt;/li>
&lt;li>&lt;strong>生成式 AI 发展较慢&lt;/strong>：虽然大多数供应商在 2023 年都引入了生成式 AI，Oracle 在这方面的进展较为缓慢，目前相关功能仍在开发中。&lt;/li>
&lt;li>&lt;strong>缺乏业务导向功能&lt;/strong>：尽管支持 Apdex 评分，O&amp;amp;M 尚未引入全面的 SLO 管理或错误预算管理功能，难以完全满足 SRE 团队的需求。&lt;/li>
&lt;/ul>
&lt;h3 id="servicenow">ServiceNow
&lt;/h3>&lt;p>ServiceNow 是本次魔力象限中的远见者。其可观测性平台包括 Cloud Observability（原 Lightstep）以及 IT 运营管理 (ITOM) 和 IT 服务管理 (ITSM) 功能。ServiceNow 客户遍布全球，涵盖各行业，其产品路线图侧重于全面引入生成式 AI 功能。&lt;/p>
&lt;h4 id="优势-14">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>支持 OpenTelemetry&lt;/strong>：ServiceNow Cloud Observability 从设计上就支持 OpenTelemetry 数据的摄取和分析，包括基于 Open Agent 管理协议 (OpAmp) 的收集器管理功能。&lt;/li>
&lt;li>&lt;strong>强劲的市场影响力&lt;/strong>：ServiceNow 在企业市场中拥有稳固的基础，特别是在大型企业中，其 ITSM 产品的广泛应用使其能够推动 Cloud Observability 的使用。&lt;/li>
&lt;li>&lt;strong>全面的产品组合&lt;/strong>：Cloud Observability 正逐步与 ServiceNow 的 ITOM 和 ITSM 产品整合，成为 ServiceNow 客户寻求可观测性平台的一个自然选择。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-14">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>认知度不足&lt;/strong>：Gartner 的客户反馈表明，许多企业对 ServiceNow 的 Cloud可观测性解决方案并不熟悉，市场推广力度不及专注于 observability 的供应商。&lt;/li>
&lt;li>&lt;strong>产品组合复杂性&lt;/strong>：Cloud Observability 与 ServiceNow 的其他产品组合并行但独立存在，功能如 SLO 管理属于 ITOM，需要额外购买，增加了复杂性。&lt;/li>
&lt;li>&lt;strong>路线图缺乏创新&lt;/strong>：与市场领导者相比，ServiceNow 在 Cloud Observability 上的创新较少，未来发展方向较为保守。&lt;/li>
&lt;/ul>
&lt;h3 id="splunk">Splunk
&lt;/h3>&lt;p>Splunk 在本次魔力象限中被评为领导者。其可观测性平台包括 Splunk Platform、Splunk IT Service Intelligence 和 Splunk Observability Cloud。Splunk 的客户主要为全球的大型企业。2024 年 3 月 18 日，Cisco 完成了对 Splunk 的收购，并将 AppDynamics 整合到 Splunk 的可观测性产品中。本报告中的参考信息收集于收购完成之前，因此仍然使用 Splunk 的名称。&lt;/p>
&lt;h4 id="优势-15">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>支持 OpenTelemetry&lt;/strong>：Splunk 强大的 OpenTelemetry 支持使其在可观测性平台中表现出色，提供对 Linux、Windows 和 Kubernetes 的全方位支持。&lt;/li>
&lt;li>&lt;strong>SLO 管理功能&lt;/strong>：Splunk Observability 提供了便捷的工作流，帮助客户通过 UI 或自动化工具如 Terraform 管理 SLO，还支持 SLO 消耗率分析告警。&lt;/li>
&lt;li>&lt;strong>一体化解决方案&lt;/strong>：Splunk 通过紧密集成的可观测性平台，能够无缝地支持 IT 运营、工程和网络安全领域的多种使用场景。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-15">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>收购带来的不确定性&lt;/strong>：Cisco 收购 Splunk 后，产品线整合尚未完成，未来销售流程可能存在不确定性。&lt;/li>
&lt;li>&lt;strong>地理覆盖差异&lt;/strong>：Splunk Cloud 的覆盖范围大于 Splunk Observability Cloud，前者在北美、EMEA 和亚太地区有更广泛的分布。对于有严格数据主权要求的客户，需详细检查其具体位置。&lt;/li>
&lt;li>&lt;strong>定价复杂&lt;/strong>：Splunk 的定价模式较为复杂，可能会给客户带来预测成本的难题，特别是在数据摄取和使用量变化较大的情况下。&lt;/li>
&lt;/ul>
&lt;h3 id="sumo-logic">Sumo Logic
&lt;/h3>&lt;p>Sumo Logic 在此次魔力象限中被评为利基参与者。其可观测性平台专注于提供可用性、性能和安全分析，主要服务于全球中小型企业。Sumo Logic 最近推出了基于 AI 的异常检测和优化功能，客户主要分布在美洲和亚太地区。&lt;/p>
&lt;h4 id="优势-16">优势
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>灵活的定价模式&lt;/strong>：Sumo Logic 的定价基于分析而非数据摄取，这意味着客户只需为数据分析付费，而数据摄取成本为 $0。&lt;/li>
&lt;li>&lt;strong>支持 OpenTelemetry&lt;/strong>：Sumo Logic 为所有客户提供 OpenTelemetry 支持，简化了遥测数据的收集和分析。&lt;/li>
&lt;li>&lt;strong>全球覆盖&lt;/strong>：Sumo Logic 平台在全球多个 AWS 区域可用，支持数据驻留和主权要求。&lt;/li>
&lt;/ul>
&lt;h4 id="注意事项-16">注意事项
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>日志为中心&lt;/strong>：Sumo Logic 主要定位为日志分析工具，尽管支持追踪和指标，但对于需要深入应用监控的企业可能不够全面。&lt;/li>
&lt;li>&lt;strong>市场增速缓慢&lt;/strong>：尽管 Sumo Logic 总体收入有所增长，但可观测性平台的收入增长自 2022 年以来几乎停滞不前。&lt;/li>
&lt;li>&lt;strong>缺乏原生合成监控&lt;/strong>：Sumo Logic 没有提供原生的合成监控功能，客户需要使用其他工具来实现此功能，尽管它支持与 Catchpoint 的开箱即用集成。&lt;/li>
&lt;/ul>
&lt;h3 id="添加和删除的供应商">添加和删除的供应商
&lt;/h3>&lt;p>随着市场变化，我们会不断审查和调整魔力象限的纳入标准。因此，魔力象限中的供应商组合可能会随时间发生变化。一年中出现的供应商在次年消失，并不意味着我们对该供应商的看法发生了改变。这可能反映了市场的变化，进而调整了评估标准，或是供应商自身的重点发生了转移。&lt;/p>
&lt;h4 id="新增">新增
&lt;/h4>&lt;p>以下供应商符合纳入标准，并被添加至魔力象限：&lt;/p>
&lt;ul>
&lt;li>BMC&lt;/li>
&lt;li>Chronosphere&lt;/li>
&lt;li>LogicMonitor&lt;/li>
&lt;/ul>
&lt;h4 id="删除">删除
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>Broadcom&lt;/strong> 被删除是因为未能达到市场的客户兴趣指标 (CII) 门槛。&lt;/li>
&lt;li>&lt;strong>Cisco&lt;/strong> 被删除是因为 Cisco Observability Platform 产品已停用。&lt;/li>
&lt;li>&lt;strong>ManageEngine&lt;/strong> 被删除是因为未能达到 CII 门槛。&lt;/li>
&lt;li>&lt;strong>Riverbed&lt;/strong> 被删除是因为未能达到 CII 门槛。&lt;/li>
&lt;li>&lt;strong>SolarWinds&lt;/strong> 被删除是因为未能满足本次研究的纳入标准。&lt;/li>
&lt;/ul>
&lt;h2 id="纳入和排除标准">纳入和排除标准
&lt;/h2>&lt;p>魔力象限的研究通过识别并分析市场中最具相关性的供应商及其产品，帮助客户了解市场状况。为了支持市场识别，通常我们会选择不超过 20 个最具代表性的供应商进行研究。要符合纳入标准，供应商必须满足以下要求：&lt;/p>
&lt;h3 id="市场参与标准">市场参与标准
&lt;/h3>&lt;ul>
&lt;li>截至 2024 年 3 月 14 日，产品或服务必须普遍可用，能够通过常规销售渠道提供给所有客户。&lt;/li>
&lt;li>供应商必须直接销售可观测性平台，并提供至少一线的客户支持服务，包括产品文档、安装指南和参考示例。&lt;/li>
&lt;li>供应商应展示清晰的产品路线图和市场策略。&lt;/li>
&lt;/ul>
&lt;h3 id="性能门槛">性能门槛
&lt;/h3>&lt;p>-可观测性平台必须在两个或多个地理区域拥有至少 50 位付费的生产环境客户。
-可观测性平台在最近 12 个月内的年收入至少达到 7500 万美元，或者年收入至少达到 1000 万美元，并且年收入增长率达到 25%。&lt;/p>
&lt;p>此外，供应商必须在 Gartner 的客户兴趣指标 (CII) 中位居前列。CII 指标通过反映客户兴趣、供应商互动和客户反馈的加权组合来计算。&lt;/p>
&lt;h3 id="荣誉提名">荣誉提名
&lt;/h3>&lt;p>我们正在观察超过 40 家供应商的表现，虽然此次研究重点分析了 17 家供应商，但未被纳入并不意味着它们不具备实力。&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Observe&lt;/strong>：这家公司是最早基于 Snowflake 数据平台构建可观测性平台的供应商之一，在其 2024 年 B 轮融资后表现强劲，尽管未达到此次研究的非功能性要求，但仍是市场中的重要力量。&lt;/li>
&lt;/ul>
&lt;h2 id="评估标准">评估标准
&lt;/h2>&lt;h3 id="执行能力">执行能力
&lt;/h3>&lt;p>Gartner 分析师根据供应商的质量和效率来评估其执行能力。我们评估供应商的过程、系统、方法或程序是否能够使其在市场中保持竞争力、运营高效且富有成效，并能够带来积极的收入增长、客户留存率和声誉。最终，供应商的表现评估将依据其利用自身愿景实现成功的能力。&lt;/p>
&lt;h3 id="产品">产品
&lt;/h3>&lt;p>此标准主要关注供应商在可观测性平台市场中的核心技术竞争力，涵盖当前产品功能、质量和特性。此外，还考虑其产品的可扩展性、稳定性、集成性以及安全特性。&lt;/p>
&lt;h3 id="整体可行性">整体可行性
&lt;/h3>&lt;p>评估供应商整体财务状况及其业务单元的财务健康度，考虑盈利能力、收入来源的地理分布以及研发投入。&lt;/p>
&lt;h3 id="销售执行定价">销售执行/定价
&lt;/h3>&lt;p>评估供应商在市场中的销售表现，重点关注其定价模式的透明度、价值以及复杂性。还包括对定价与折扣、新老客户业务以及与竞争对手的动态对比。&lt;/p>
&lt;h3 id="市场响应能力">市场响应能力
&lt;/h3>&lt;p>衡量供应商根据客户需求变化和市场动态调整策略的灵活性，评估其应对竞争和响应客户反馈的能力。&lt;/p>
&lt;h3 id="市场执行">市场执行
&lt;/h3>&lt;p>评估供应商的市场推广活动，关注其传递信息的清晰度、质量、创意和效果，以及其品牌影响力、产品知名度和客户认同感的提升。&lt;/p>
&lt;h3 id="客户体验">客户体验
&lt;/h3>&lt;p>重点评估客户通过供应商产品和服务实现预期结果的体验，包括客户支持计划、售后服务和区域内合作伙伴的支持情况。高端客户的特别支持项目也在评估范围内。&lt;/p>
&lt;h3 id="运营">运营
&lt;/h3>&lt;p>衡量供应商实现目标并履行承诺的能力，评估其组织结构、技能和合作关系的质量，特别是其遵守服务级别协议 (SLA) 的表现。还考虑其与云服务提供商的合作以及处理停机事件的能力。&lt;/p>
&lt;p>表 1 列出了魔力象限中关于执行能力的具体评估标准。&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>评估标准&lt;/th>
&lt;th>权重&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>客户体验&lt;/td>
&lt;td>高&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>市场响应能力/记录&lt;/td>
&lt;td>高&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>市场推广执行&lt;/td>
&lt;td>中&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>运营&lt;/td>
&lt;td>低&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>整体可行性&lt;/td>
&lt;td>中&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>产品或服务&lt;/td>
&lt;td>高&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>销售执行/定价&lt;/td>
&lt;td>中&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="愿景的完整性">愿景的完整性
&lt;/h3>&lt;p>Gartner 分析师通过评估供应商对当前市场机会的理解能力，以及其阐述未来市场方向、创新和客户需求的能力来衡量其表现。最终，供应商的愿景展望和其实现未来目标的能力将作为评估依据。&lt;/p>
&lt;h3 id="市场理解">市场理解
&lt;/h3>&lt;p>此标准衡量供应商对客户需求的把握，以及如何将这些需求转化为产品。具有清晰市场愿景的供应商能够倾听和理解客户需求，并通过其创新推动市场发展。供应商对 observability 领域的深入理解及其与 APM 的区别也是评估的重要因素。&lt;/p>
&lt;h3 id="营销策略">营销策略
&lt;/h3>&lt;p>评估供应商是否具备清晰的差异化营销信息，以及是否通过社交媒体、广告和客户项目等渠道有效传递这些信息。创新的市场推广策略和真实的差异化也在考量范围内。&lt;/p>
&lt;h3 id="销售策略">销售策略
&lt;/h3>&lt;p>评估供应商的销售策略是否能够利用直接和间接销售、营销、服务和合作伙伴网络，扩大市场覆盖和客户基础。渠道策略及对购买决策者的理解也是关键考量因素。&lt;/p>
&lt;h3 id="产品策略">产品策略
&lt;/h3>&lt;p>评估供应商在产品开发和交付上的策略是否满足当前及未来的市场需求，是否具备差异化功能和持续创新的能力。产品路线图的质量及投资优先级也在评估范围内。&lt;/p>
&lt;h3 id="商业模式">商业模式
&lt;/h3>&lt;p>评估供应商的商业模式是否设计合理且执行有效，能否持续取得成功。考量因素包括对定价模式的预判、业务逻辑以及与开源社区的关系。&lt;/p>
&lt;h3 id="创新">创新
&lt;/h3>&lt;p>评估供应商在新兴技术领域的创新能力，以及对 AI/ML 等新技术的运用，是否能推动产品开发，并与第三方和合作伙伴建立协同效应。&lt;/p>
&lt;h3 id="地理战略">地理战略
&lt;/h3>&lt;p>评估供应商是否具备针对全球市场的战略，能否通过本地资源、合作伙伴和 SaaS 平台满足各地区的需求。考量因素包括区域员工数量、SaaS 平台位置及地区化市场策略的调整。&lt;/p>
&lt;p>本次魔力象限中使用的愿景完整性评估标准列于表 2。&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>评估标准&lt;/th>
&lt;th>权重&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>市场理解&lt;/td>
&lt;td>高&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>市场策略&lt;/td>
&lt;td>中&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>销售策略&lt;/td>
&lt;td>中&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>产品策略&lt;/td>
&lt;td>高&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>商业模式&lt;/td>
&lt;td>高&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>垂直行业策略&lt;/td>
&lt;td>未评级&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>创新&lt;/td>
&lt;td>高&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>地理策略&lt;/td>
&lt;td>中&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="象限描述">象限描述
&lt;/h2>&lt;h3 id="领导者">领导者
&lt;/h3>&lt;p>领导者象限中的供应商提供强大的可观测性产品，能够满足市场的广泛需求，并在扩展客户基础方面非常成功。他们拥有广泛的产品组合，提供卓越的分析能力和可见性，且能够与其他 ITOM 技术无缝集成。领导者具备优异的愿景与执行力，能够满足当前和未来市场的需求，同时持续在创新和客户体验方面表现出色。&lt;/p>
&lt;h3 id="挑战者">挑战者
&lt;/h3>&lt;p>挑战者象限中的供应商通常具备广泛的市场覆盖和大规模的客户部署。他们在执行方面表现强劲，得益于公司整体的销售和品牌影响力。这些供应商通常提供广泛的产品组合，部分供应商可能正处于产品转型阶段，逐步调整其市场焦点。&lt;/p>
&lt;h3 id="远见者">远见者
&lt;/h3>&lt;p>远见者象限中的供应商具备创新计划，能够应对市场需求，但其产品组合尚不成熟。他们在执行方面的能力略低，通常在应对市场变化、整合产品功能以及扩大市场份额方面相对较弱。&lt;/p>
&lt;h3 id="利基参与者">利基参与者
&lt;/h3>&lt;p>利基参与者象限中的供应商主要专注于特定市场或垂直领域，或仅满足有限的使用场景需求。由于他们无法在所有核心功能上表现出深度，通常无法满足更广泛市场的需求。纳入该象限并不意味着其在所竞争市场中的价值受到质疑。&lt;/p>
&lt;h3 id="背景">背景
&lt;/h3>&lt;p>&lt;strong>可观测性平台：未来展望&lt;/strong>&lt;/p>
&lt;p>过去几年里，observability 市场一直在快速发展，竞争激烈，供应商背景和规模各异，开源产品的比例也逐渐增加。虽然产品质量和功能不断提升，但随之而来的成本也在上涨。许多客户开始质疑是否值得为 observability 支付高昂的成本。&lt;/p>
&lt;p>IT 运营同样受到了 AI 技术的深刻影响，尤其是在本次魔力象限项目中，这一现象尤为明显。客户常常询问 AI 在 IT 运营中的角色，以及它与 AIOps 的关系。&lt;/p>
&lt;p>可观测性平台本质上是数据管理和分析工具，越来越多的工具开始将 AI 技术作为基础功能，包括自适应阈值、异常检测等。AI 在可观测性平台中的作用将继续演进，但 Gartner 鼓励客户根据具体的用例评估产品的适用性，而非仅仅关注特定技术的有无。&lt;/p>
&lt;p>市场中的可观测性产品种类繁多，几乎总有一个产品能够满足客户的独特需求。由于魔力象限的篇幅限制，许多优秀的供应商未能被纳入本次研究。如果有任何问题，欢迎联系我们。&lt;/p>
&lt;h2 id="市场概览">市场概览
&lt;/h2>&lt;p>从 APM（应用性能管理）到可观测性平台的发展，反映了市场的更广泛趋势。随着商业数字化、云的普及以及技术在日常生活中扮演的核心角色，工作负载和遥测数据的复杂性和规模都在不断增长，这对理解系统健康、性能和用户体验的能力提出了更高的要求。&lt;/p>
&lt;h3 id="市场扩展">市场扩展
&lt;/h3>&lt;ul>
&lt;li>&lt;strong>现有客户中的扩展&lt;/strong>：过去，APM 工具主要用于监控少量关键应用。但随着可观测性平台功能的提升、部署的简化以及价格下降，更多的应用开始使用这些工具。面对经济波动，组织更倾向于选择能够全面覆盖遥测数据的“全栈”解决方案。&lt;/li>
&lt;li>&lt;strong>新行业的扩展&lt;/strong>：APM 和 可观测性工具最初多应用于 IT 系统成熟的大型企业。如今，中小企业也逐渐采用这些工具，特别是那些基于开源技术的解决方案，帮助他们更轻松地转向现代可观测性平台。&lt;/li>
&lt;li>&lt;strong>云服务商的竞争&lt;/strong>：随着企业在 observability 上的投入增加，云服务商（CSP）也开始推出具备竞争力的原生 可观测性工具，尤其在多平台环境中，它们的吸引力越来越大。&lt;/li>
&lt;/ul>
&lt;h3 id="未来趋势">未来趋势
&lt;/h3>&lt;p>未来几年，可观测性平台市场将继续受到以下趋势的推动：&lt;/p>
&lt;ul>
&lt;li>&lt;strong>数据整合需求&lt;/strong>：用户需要在不切换工具的情况下，整合和分析来自不同源的遥测数据。&lt;/li>
&lt;li>&lt;strong>AI 驱动的自主功能&lt;/strong>：随着 AI 的进步，监控工具将逐渐融入自适应阈值、异常检测等自动化功能，甚至具备更高层次的优化能力。&lt;/li>
&lt;li>&lt;strong>网络安全集成&lt;/strong>：可观测性平台开始增加网络安全功能，未来可能成为此领域的重要竞争者。&lt;/li>
&lt;li>&lt;strong>AI 和 LLM 监控&lt;/strong>：随着 AI 和大语言模型工作负载的部署，可观测性平台将优先支持这些新兴领域。&lt;/li>
&lt;li>&lt;strong>集中式 observability 团队&lt;/strong>：越来越多的组织成立专门团队来集中管理 SLO、遥测数据和事故响应。&lt;/li>
&lt;li>&lt;strong>SaaS 和云服务监控&lt;/strong>：随着更多关键业务依赖 SaaS 和云服务，可观测性平台供应商将继续扩展对这些领域的支持。&lt;/li>
&lt;li>&lt;strong>并购与整合&lt;/strong>：市场的重组仍在继续，未来将有更多并购、产品更新和整合，这将改变供应商格局。&lt;/li>
&lt;/ul>
&lt;h2 id="证据">证据
&lt;/h2>&lt;p>本次研究基于过去 12 个月中超过 1000 次客户互动。此外，我们还结合了来自 Gartner Peer Insights、客户咨询以及公开资料的信息，以补充供应商提供的数据。&lt;/p>
&lt;h3 id="评估标准定义">评估标准定义
&lt;/h3>&lt;h4 id="执行能力-1">执行能力
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>产品/服务&lt;/strong>：评估供应商为市场提供的核心产品和服务，包括当前产品功能、质量、特性、以及是否通过 OEM 协议或合作伙伴提供。&lt;/li>
&lt;li>&lt;strong>整体可行性&lt;/strong>：衡量供应商整体的财务健康状况及其业务单元的成功，评估其继续投资、创新和提供产品的能力。&lt;/li>
&lt;li>&lt;strong>销售执行/定价&lt;/strong>：评估供应商在销售中的能力，包括交易管理、定价策略、售前支持和销售渠道的整体效率。&lt;/li>
&lt;li>&lt;strong>市场响应能力/记录&lt;/strong>：评估供应商根据市场机会、客户需求变化和竞争对手行为的响应能力，以及其在应对市场变化中的灵活性。&lt;/li>
&lt;li>&lt;strong>市场执行&lt;/strong>：评估供应商推广其品牌、提升产品知名度和影响客户心智的能力。包括宣传、促销、思想领导力等活动的效果。&lt;/li>
&lt;li>&lt;strong>客户体验&lt;/strong>：衡量供应商通过产品和服务帮助客户取得成功的能力，特别是技术支持、客户服务以及服务级别协议等方面的表现。&lt;/li>
&lt;li>&lt;strong>运营&lt;/strong>：评估供应商是否具备有效管理和运营其业务的能力，包括组织结构、项目管理、系统和其他运营工具的质量。&lt;/li>
&lt;/ul>
&lt;h4 id="愿景完整性">愿景完整性
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>市场理解&lt;/strong>：衡量供应商理解客户需求并将其转化为产品和服务的能力，展示出清晰的愿景，并能够通过这些愿景引领市场发展。&lt;/li>
&lt;li>&lt;strong>营销策略&lt;/strong>：供应商的营销信息是否清晰、具有差异化，并通过多种渠道有效传达。&lt;/li>
&lt;li>&lt;strong>销售策略&lt;/strong>：评估供应商的销售策略是否覆盖全面，包括直接和间接销售渠道的利用，以及市场覆盖的深度和广度。&lt;/li>
&lt;li>&lt;strong>产品策略&lt;/strong>：供应商在产品开发和交付中的策略是否能够满足当前和未来的市场需求，并体现差异化。&lt;/li>
&lt;li>&lt;strong>商业模式&lt;/strong>：评估供应商的商业模式是否合理且具备可持续性。&lt;/li>
&lt;li>&lt;strong>垂直/行业策略&lt;/strong>：供应商在特定市场细分中的资源配置和产品战略。&lt;/li>
&lt;li>&lt;strong>创新&lt;/strong>：供应商在新技术、整合和协同创新方面的能力和投资力度。&lt;/li>
&lt;li>&lt;strong>地理战略&lt;/strong>：评估供应商是否具备全球扩展的战略，能够根据不同地区的需求调整资源和产品策略。&lt;/li>
&lt;/ul>
&lt;p>原文：&lt;a class="link" href="https://www.gartner.com/doc/reprints?id=1-2HXS17MG&amp;amp;ct=240627&amp;amp;st=sb" target="_blank" rel="noopener"
>https://www.gartner.com/doc/reprints?id=1-2HXS17MG&amp;ct=240627&amp;st=sb&lt;/a>&lt;/p>
&lt;p>❤️ Feature Photo by Pavel Danilyuk: &lt;a class="link" href="https://www.pexels.com/photo/a-bearded-man-with-a-hat-using-binoculars-9143804/" target="_blank" rel="noopener"
>https://www.pexels.com/photo/a-bearded-man-with-a-hat-using-binoculars-9143804/&lt;/a>&lt;/p></description></item><item><title>可观测性的定义和真实含义是什么？</title><link>https://martinliu.cn/blog/what-is-o11y/</link><pubDate>Tue, 29 Aug 2023 15:04:00 +0800</pubDate><guid>https://martinliu.cn/blog/what-is-o11y/</guid><description>&lt;img src="https://martinliu.cn/blog/what-is-o11y/pexels-joshua-woroniecki-3832684.jpg" alt="Featured image of post 可观测性的定义和真实含义是什么？" />&lt;p>“可观测性”英文 observability ，缩写 o11y 。&lt;/p>
&lt;h2 id="常见定义">常见定义
&lt;/h2>&lt;p>最常见的引用来自机械工程领域中关于“控制论”的研究，1960 年鲁道夫·E.卡尔曼首次提出了“可观测性”这个词。&lt;/p>
&lt;p>在控制论中，这个概念涉及：物理机械系统和与之对偶关系的数学模型。然而，这个机械工程师用来研究物理系统的术语，并一定能完全的适用于我们所研究软件应用系统。&lt;/p>
&lt;p>大多数人将“可以根据系统的外部输出信息推断出系统内部状态的好坏（源自于《控制论》）”全盘接受，并套用在了软件行业相关讨论的上下文中。&lt;/p>
&lt;h2 id="常见误解">常见误解
&lt;/h2>&lt;p>降维误读：“可观测性”就是“遥测-telemetry”和“监控-monitor”的同义词。它与监控并没啥区别。就是通常所说的三大支柱（日志、指标和 Trace）。&lt;/p>
&lt;p>厂商的市场宣传：由于市场宣传的需要，目前几乎所有传统做指标、日志和 APM - Trace 的厂商都直接宣称他们都是做可观测性的厂商，提供可观测性产品、解决方案或者 SaaS 服务。常见做法：可观测性是他们扩展出来的，用旧产品改名。&lt;/p>
&lt;p>有些公司会直接的进行概念替换：“我们就是可观测性”。&lt;/p>
&lt;p>以上现实情况，给所有人对可观测性的理解带来了一定的障碍。&lt;/p>
&lt;h2 id="应有的定义">应有的定义
&lt;/h2>&lt;p>在我们排除以上学术上的认祖归宗，以及市场宣传的张冠李戴以后。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/blog/what-is-o11y/o11y-def.jpg"
width="1264"
height="557"
srcset="https://martinliu.cn/blog/what-is-o11y/o11y-def_hu_1907561cf03d811b.jpg 480w, https://martinliu.cn/blog/what-is-o11y/o11y-def_hu_c6658ff6f8388d3b.jpg 1024w"
loading="lazy"
alt="可观测性定义"
class="gallery-image"
data-flex-grow="226"
data-flex-basis="544px"
>&lt;/p>
&lt;p>我们应该可以给出一个关于可观测性更加严谨的定义：&lt;/p>
&lt;ol>
&lt;li>可观测性是应用系统的一种内在属性，我们可以通过可观测性管理工具将其显性的展现出来，用于探索分析。&lt;/li>
&lt;li>度量能力：无论系统中发生着多么费解的现象，它的度量数据能帮助你更好地理解和解释系统当前的状态。可以解答：系统处于什么状态？&lt;/li>
&lt;li>探索能力：我们能够在各类系统状态数据的所有维度和组合之间进行关联分析，并无需遵循某种预定的调试&amp;amp;排查模式和路径，用于解答：系统中发生了什么变化？为什么会发生这样的变化？&lt;/li>
&lt;li>可按需调整能力：最好是不需要改变原有软件系统的代码，如有需要，也能随心所欲的按需埋点覆盖新的洞察认知。&lt;/li>
&lt;/ol>
&lt;p>以上是关于可观测性定义应该具备的描述信息。适用于我们在对软件系统进行运行和维护的上下文中，这个概念应该具有的含义和外延还有很多。&lt;/p>
&lt;h2 id="为何现在o11y很重要">为何现在o11y很重要？
&lt;/h2>&lt;p>特别是在云原生的运维场景中，传统监控并非唯一的最佳方法；而且，传统的指标和日志监控已经捉襟见肘；产品团队和运维人员始终处于很被动的状态，传统监控数据仅限于让我们了解有限的历史状态，很难推理和预测未知故障。在创建了大量告警规则后，告警事件的数量和信噪比都居高不下，运维值守人员终日忙于关闭噪音事件，很难聚焦在有意义的事件上。&lt;/p>
&lt;h2 id="调试排查应用系统">调试&amp;amp;排查应用系统
&lt;/h2>&lt;p>在生产环境中，调试和排查应用系统的故障和性能问题充满着各种挑战。任意一个人是无法完全的理解复杂的软件系统，大部分人都是习惯于使用分解法思考系统故障；先脑补系统的整体架构，然后怀疑某个系统组件，再考虑组件之间的关联关系。在云原生系统中，我们很难准确的在大脑中勾勒出系统架构的全貌，甚至都不能准确的定位出某个组件（子服务）是运行在什么地方（AZ，Host，Pods）。而且，现代分布式系统所发生的故障，是一系列持续的不同的新问题，发生故障的代码有可能是自己开发的，也很可能是第三方依赖组件&amp;amp;外部服务。人的诊断故障的直觉和经验只能对已知的错误模式有效，传统监控就是面向已知问题的，先假设每一个监控点都是确定的未来的故障点。而使用可观测性进行故障诊断，是面向未知问题的，是用来解释未知问题是如何发生的。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/blog/what-is-o11y/know-unknow.jpg"
width="793"
height="715"
srcset="https://martinliu.cn/blog/what-is-o11y/know-unknow_hu_23fe4e7265ee624f.jpg 480w, https://martinliu.cn/blog/what-is-o11y/know-unknow_hu_abb366be3855cdb9.jpg 1024w"
loading="lazy"
alt="已知的未知"
class="gallery-image"
data-flex-grow="110"
data-flex-basis="266px"
>&lt;/p>
&lt;p>用可观测数据度量和感知应用系统的状态，以及状态的变化，就需要认识到数据的两个维度“基数”和“维度”。&lt;/p>
&lt;h3 id="基数">基数
&lt;/h3>&lt;p>基数的定义：关注于一条可观测性数据的某个字段，如果每个字段都是一个 Key - value 对，维度指的是这个组合中 value 的唯一性，也就是值的唯一数量。&lt;/p>
&lt;ul>
&lt;li>高基数字段的例子：用户 ID、UUID、购物车 ID、请求 ID、容器 ID、主机名（弹性、不可变架构）、Pod ID等等。&lt;/li>
&lt;li>低基数字段的例子：性别、种族、国家、婚姻状态等等&lt;/li>
&lt;/ul>
&lt;p>基数对于可观测性的作用是：通过聚合采集到的高基数数据集合，得到低基数的分析结果；可观测性管理拥抱高基数数据，也就拥抱更多未知的可能性，因此它具备感知未知故障模式的先天优势。&lt;/p>
&lt;p>而传统监控（日志、指标）数据的基数一般处于一个合理的规模，默认规避高基数，希望用尽可能少的指标分析定位问题，从工具上反映出来的是枚举法；在日常实践中：监控工具的使用者，倾向于关闭大量的认为没什么用的，或者不会出问题的故障采集点。即使是指标全开，日志尽采，而后续的数据分析和洞察手段往往是低效且滞后的，数据后期处理的高价值工作不是没有能力做，就是没有人力和成本做。&lt;/p>
&lt;p>工具厂商（指标、日志、APM）可能会按照所能覆盖到的监控指标的数量，而增加工具使用的费用。&lt;/p>
&lt;h3 id="维度">维度
&lt;/h3>&lt;p>维度的定义：关注于一条可观测性数据的所有字段的数量，如果每个字段都是一个 Key - value 对，维度指的是这个组合中 key 的数量，也就各种 key 键的多寡。&lt;/p>
&lt;p>高维度可观测性数据是一条结构化数据，代表这一次事件，亦或是一个状态，它的“宽度”可以高达上千个键值对（字段），事件越宽所携带的上线文信息就越丰富。高维度数据的作用是用来回答：到底发生了什么？&lt;/p>
&lt;p>用一组可观测性数据，在多个维度上进行排列组合分析，就是剖析现代软件系统中的所有故障模式的可能性。&lt;/p>
&lt;p>最常见维度组合包括：&lt;/p>
&lt;ol>
&lt;li>用户&lt;/li>
&lt;li>代码&lt;/li>
&lt;li>系统-运行环境&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://martinliu.cn/blog/what-is-o11y/3d.jpg"
width="957"
height="875"
srcset="https://martinliu.cn/blog/what-is-o11y/3d_hu_ac59615077f3e267.jpg 480w, https://martinliu.cn/blog/what-is-o11y/3d_hu_8cd8d8b038260e53.jpg 1024w"
loading="lazy"
alt="排错维度"
class="gallery-image"
data-flex-grow="109"
data-flex-basis="262px"
>&lt;/p>
&lt;h2 id="使用可观测性调试">使用可观测性调试
&lt;/h2>&lt;p>基于充足的应用系统的可观测性数据，进行开放式的探索数据分析，你就能理解系统所进入的任何状态，而且通过多维度的关联分析，还能知道为什么会形成这个状态。&lt;/p>
&lt;p>可观测性管理工具是鼓励开发人员主动的收集应用运行时可能发生的任何事件，包括携带丰富的上下文，充足的遥测数据是日后探索分析的基础。&lt;/p>
&lt;p>可观测性管理工具平台应该是专门为高基数、高维度的遥测数据而设计的，它鼓励应用系统的所有参与方都参与：主动建立有利于故障调试的可观测性数据的活动中来。包括分工完成下面的各种工作：&lt;/p>
&lt;ul>
&lt;li>开发者在可观测性驱动开发思想的指导下，有意识的在代码中引用埋点框架（如 OpenTelemetry），对代码进行必要&amp;amp;足够的埋点。&lt;/li>
&lt;li>运维人员确保不同语言的应用程序在运行前都携带了自动化埋点的探针（Agent）程序，如果是容器化程序，还可以在打镜像的时候设置这个检查点。确保在任何运行环境（开发、测试、准生产、生产）里APM 或者 RUM 的埋点数据都可以在正确的配置下发送回后台的可观测性管理平台，完成数据的采集。操作系统及以下系统环境的指标和日志是基础工作，是参考数据，这里不赘述。&lt;/li>
&lt;li>测试人员和其他，都有使用可观测性数据的习惯，利用可观测性数据回答：bug 修复了么？性能回顾解决了么？错误率和延迟是否都很低了？&lt;/li>
&lt;li>产品经理和服务交付经理通过可观测性数据整理出每一套应用系统的 SLO 管理报告，指导下个迭代的工作方向，安排 bug 修复和特性交付的优先级，评估生产的运行风险。&lt;/li>
&lt;/ul>
&lt;p>分析调试现代化应用系统的难度包括两个层面：&lt;/p>
&lt;ol>
&lt;li>相对简单：系统的硬件和基础设施、云平台等方面，也就是代码以下的所有。&lt;/li>
&lt;li>相对困难：代码、真实用户的问题，也就是代码本身及以上的所有。&lt;/li>
&lt;/ol>
&lt;h2 id="适用于现代应用系统">适用于现代应用系统
&lt;/h2>&lt;p>现代化应用系统指的是运行在云上的，并经过适配改造的，与云平台的各种服务有很多集成的应用系统。它也可能是一个单体的运行在云主机中的应用，但更多的是容器化、微服务化、分布式的应用系统。前者用传统的监控方法也可以有效管理；后者使用可观测性管理方式更加适合。&lt;/p>
&lt;p>具备可观测性的软件的各种运行状态天然能被理解，我们无须猜测其内部状态，无须提前预判可能的故障模式，无须更新程序代码来暴露盲区。&lt;/p>
&lt;p>现代应用系统的故障模式的特点是：以新的、罕见、没发生过的故障模式为主；通常不可预测；需要使用支持高基数、高维度、可自由探索分析的可观测性管理平台进行配套管理。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/blog/what-is-o11y/what-is-o11y.png"
width="3774"
height="5622"
srcset="https://martinliu.cn/blog/what-is-o11y/what-is-o11y_hu_2b6d40e9e38f522f.png 480w, https://martinliu.cn/blog/what-is-o11y/what-is-o11y_hu_d10b660a58a62350.png 1024w"
loading="lazy"
alt="脑图"
class="gallery-image"
data-flex-grow="67"
data-flex-basis="161px"
>&lt;/p>
&lt;p>点击以上图片查看或者下载高清大图。&lt;/p>
&lt;blockquote>
&lt;p>本文参考《可观测性工程》第一章内容。&lt;/p>&lt;/blockquote>
&lt;p>❤️ Feature Photo by Joshua Woroniecki: &lt;a class="link" href="https://www.pexels.com/photo/person-holding-a-compass-3832684/" target="_blank" rel="noopener"
>https://www.pexels.com/photo/person-holding-a-compass-3832684/&lt;/a>&lt;/p></description></item><item><title>究竟可观测性能给我们带来什么？</title><link>https://martinliu.cn/blog/what-observability-give-us/</link><pubDate>Tue, 15 Aug 2023 16:17:43 +0800</pubDate><guid>https://martinliu.cn/blog/what-observability-give-us/</guid><description>&lt;img src="https://martinliu.cn/blog/what-observability-give-us/pexels-pixabay-237258.jpg" alt="Featured image of post 究竟可观测性能给我们带来什么？" />&lt;p>可观测性并不是空穴来风，也非关键词炒作。大家不妨回顾一下我们所熟知的运维管理的演化历程，抛开运维管理中关于流程和人的那些繁文缛节。让我们只关注于：基础设施和应用架构的变迁，关注于这些层出不穷的技术工具侧面。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/blog/what-observability-give-us/o11y-infographic.jpg"
width="840"
height="1858"
srcset="https://martinliu.cn/blog/what-observability-give-us/o11y-infographic_hu_ee3ee15b25bb2125.jpg 480w, https://martinliu.cn/blog/what-observability-give-us/o11y-infographic_hu_4670a269782e06e9.jpg 1024w"
loading="lazy"
alt="可观测性简史"
class="gallery-image"
data-flex-grow="45"
data-flex-basis="108px"
>&lt;/p>
&lt;h2 id="兼容全域信号量">兼容全域信号量
&lt;/h2>&lt;p>从遥测方式的角度看来：任何类型的信号都有各自的用途和道理。武断地选取其一作为可观测性的代名词是一种比较偏激的想法，在Debug生产环境的道路上，我们难以依靠单一方法，一招鲜吃遍天的情况是不可能存在的。我们要根据不同应用系统的特点和服务类型，选择合理的SLI组合，用恰当的信号量来覆盖目标应用系统，目标是打造应用系统本身的可观测性“属性”。这样，你就必须要明智地选择、添加或变化信号类型，要能做到按需求，对症下药。这里不是监控数据源越多越好，盲目的全面覆盖亦是事倍功半的做法；在应对高维度、高基数的运维大数据的场景中，我们很容易走向存储成本飙升的局面，无效杂音数据还能严重稀释有价值的信息点。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/blog/what-observability-give-us/o11y-sig.png"
width="1002"
height="1102"
srcset="https://martinliu.cn/blog/what-observability-give-us/o11y-sig_hu_4e64b3b58bb44b7a.png 480w, https://martinliu.cn/blog/what-observability-give-us/o11y-sig_hu_4cab814d25f8cec3.png 1024w"
loading="lazy"
alt="可观测性信号量类型"
class="gallery-image"
data-flex-grow="90"
data-flex-basis="218px"
>&lt;/p>
&lt;p>所谓全域信号量究竟都有那些：&lt;/p>
&lt;ol>
&lt;li>&lt;strong>日志 Log&lt;/strong>：文本记录系统和应用的活动、事件和错误，提供详细上下文。&lt;/li>
&lt;li>&lt;strong>指标 Metric&lt;/strong>：定量的性能度量，如CPU使用率、请求速率，帮助监控系统状态。&lt;/li>
&lt;li>&lt;strong>分布式追踪 Trace&lt;/strong>：跟踪请求在分布式系统中的路径和性能瓶颈。&lt;/li>
&lt;li>&lt;strong>流数据 Stream&lt;/strong>：实时产生的数据，如用户行为，用于即时监测和分析。&lt;/li>
&lt;li>&lt;strong>用户体验数据 RUM&lt;/strong>：记录用户在应用中的交互、操作和反应，评估体验质量。&lt;/li>
&lt;li>&lt;strong>eBPF&lt;/strong>：扩展 Berkeley Packet Filter，收集内核级别的数据，用于分析和监控。&lt;/li>
&lt;li>&lt;strong>网络性能管理 NPM&lt;/strong>：监测网络带宽、延迟和连接状况，优化网络性能。&lt;/li>
&lt;li>&lt;strong>Profiling&lt;/strong>：分析代码运行时的性能特征，帮助优化应用程序。&lt;/li>
&lt;li>&lt;strong>云服务 Cloud&lt;/strong>：从云提供商获取的监测数据，跟踪资源使用和性能。&lt;/li>
&lt;li>&lt;strong>拨测数据 Uptime/synthetics&lt;/strong>：定期对系统进行外部测试，监测系统在不同地点和条件下的可用性和性能。&lt;/li>
&lt;li>未来新技术：未知类型数据。&lt;/li>
&lt;/ol>
&lt;p>“可观测性管理平台”应当以兼容并蓄全方位的信号量为初始设计目标。这意味着：在观测数据的采集、上传、存储、展示以及关联分析的整个过程中，各类数据都需要能被正确的处理，要能更能合理、有效地进行跨类型的数据关联；在数据下钻的过程中，可以自由地在各种时间线之间跳转和探索。&lt;/p>
&lt;p>当然，监控已知的“未知”是一项基本的管理需求，你应当能使用某一种信号量即可实现。而可观测性更多的是要讨论：对“未知”对象，在“未知”状态间进行变化的管理；这就需要“可观测性平台”能处理多层级、高依赖、多云环境、分布式系统下的高“复杂度”，信号量的全面准备和按需取用往往也只是一个必要条件。&lt;/p>
&lt;p>目前市场上已经有许多运维管理平台都自称为“可观测性”管理平台。但他们中的大多数都是从某个特定监控类型开始，并逐渐扩展覆盖其他更多信号类型的。通常，只有能够涵盖3种以上信号类型的平台，才可能具有出色的实用效果；对于那些已经是有3至5年历史的‘可观测性’产品而言，他们不太可能在短期内实现华丽的转身，也不可能会从头重构一遍自己的产品。&lt;/p>
&lt;h2 id="统一采集和上传工具">统一采集和上传工具
&lt;/h2>&lt;p>在物理机大行其道的时代中，对于一台主机（虚拟机或者物理机）而言，由于它很可能承担着多重角色。而且根据不同团队的管理需求，在其操作系统中会安装多种管理监控代理程序Agent，例如：操作系统指标、日志、数据库、中间件、安全巡检等等；这种叠罗汉的形式不仅给操作系统的资源带来了严重的消耗，甚至还给服务器的管理带来了大量的琐事，例如：数据库监控 Agent 还需要创建专用的用户账号等。为了解决这个问题，很多公司希望使用尽可能少的单一采集代理的模式，例如：BMC 公司的 Patrol 监控产品，拥有多种采集模块 KM（数据库、中间、web 服务器等等），用户可以按需要进行配置，而不需要部署多个采集代理程序。然而，BMC 公司会逐渐收购很多新产品，后来的产品有动态性能基线管理、自动化配置管理等等。从工具厂商的角度看， 他们无法进行快速的产品整合，很难维持单一采集代理的局面。&lt;/p>
&lt;p>在甲方企业的环境中，不同部门会根据自己的需求采购不同的管理工具，部门间的差异导致了工具的重复建设，数据的重复采集，而且数据并不会很轻易的在部门间共享。这样不仅带来了采集工具在同一个主机上的叠加部署，还会导致：独立的运行着大量具有重复数据的孤岛运维数据数据库。这种局面进一步导致了其他问题，例如：同一个主机的同一个故障会在各种工具中都触发多条告警事件；事件风暴来临了。这种混沌的局面，给 AIOps 的工具带来了生存的空间，即使可以产生一些事件收敛和压缩的收益，但这里存在着一个很明显的“治标不治本”的错误。&lt;/p>
&lt;p>时光穿梭到了虚拟化&amp;amp;云原生时代，以上局面并没有发生根本性的改变。反而带来了套娃式深层依赖关系的困境。我们不会把 web、中间件、数据库、消息队列等功能跑在一个 POD 中，但是将其各自独立部署在可横向扩容的子服务（容器服务）中后，这就带来了管理对象的数量呈现指数级飙升的现状。&lt;/p>
&lt;p>容器时代带来了新鲜的监控工具，包括：Prometheus、Grafana、FluntD、Graphite、cAdvisor、Loki、EFK等等。我们可以观察到，新生的工具并不会完全改变：多种采集功能代理并存&amp;amp;叠加的局面。Elastic 看到了部署多种相似代理程序的问题后，最近几年很快的将之前的多种 Beats 程序（多次收购的项目）整合成到了一个统一代理 Elastic Agent中，而这个程序目前还只是多个 Beats 程序的马甲（包装壳）程序。Zabbix 是一个依然长期存在的常见采集代理，我个人推测：在当今容器环境居多的情况下，容器内用云原生监控工具集，容器外依然使用老牌监控工具的组合做法，依然是一个普遍存在的现状。&lt;/p>
&lt;p>多种采集工具集不仅在端点上会造成大量部署和配置的琐事，而且，它们的后台都对应着各自的独立的数据库部署。同一个管理对象在不同的数据库中的字段描述基本上都不同，这导致了：工具集的使用者很难在各类数据库中实现关联分析，用人脑携带着排错的上下文，在一堆控制台之间跳转是相当消耗体力的工作，对齐时间线和监控对象会很快耗尽人的认知上限。CMDB 可能是一个解决方法，而 CMDB 的设计和建设的难度并不亚于构建任何一个监控系统项目本身， 用CMDB解决这个问题的实现难度大，成本高。数据治理也会是一个常见做法，而在这些运维数据库集合之间做 ELT，做数据治理工作，最终实现异类运维信息的归一化的解决方式，也只是一个顺坡下驴的无奈之举，相关实施人员在项目中必将饱尝：将计就计的辛酸。&lt;/p>
&lt;p>貌似最早由 Elastic 推出的统一数据模型（ECS）&lt;a class="link" href="https://www.elastic.co/cn/elasticsearch/common-schema" target="_blank" rel="noopener"
>https://www.elastic.co/cn/elasticsearch/common-schema&lt;/a> 是一个让数据走向标准化定义的可行之道。我们也看到了：OpenTelemetry 项目很快就采纳了 Elastic ECS。CNCF 在随后也推出了相似的观测数据定义模型。我相信 CNCF 一定是看到了，在它的技术蓝图中，可观测性和分析分类中相似&amp;amp;同类工具的快速繁荣。而这些标准也只能让我们望梅止渴，由于目前还没有看到多数厂商、大量开源项目都快速跟随实现和兼容落地的局面。&lt;/p>
&lt;p>观测云的 DataKit 是一款多功能的采集代理程序，它具备解决上述问题的设计，它已经在兼容和对接更广泛的技术生态系统。任何采集代理程序在采集或者对接到了目标数据之后，它其实还需要处理一些列的细节，否则就仍然无法实现“源头治理”，无法避免“garbage in gargage out”的窘境。首先，DataKit 在组织封装数据的时候，所有字段的定义都遵从着一个观测云定义的数据字典（等同于 Elastic ECS ）；其次，上报数据包在封包前，还能做数据的 Pipline 处理，实现了数据字段的丢弃、质量控制、治理和脱敏等问题。最后，DataKit 的采集还可实现对接开源&amp;amp;闭源生态系统，例如接收 DataDog 的 APM 探针数据，对接 OpenTelemetry 的数据等等。它还能实现观测数据在网际、网络间的转发等。&lt;/p>
&lt;h2 id="统一的存储后台">统一的存储后台
&lt;/h2>&lt;p>在构建可观测性平台的过程中，每种类型的信号量都理应得到它最佳的容身之处：&lt;/p>
&lt;ul>
&lt;li>Elasticsearch ：在 Elastic 的 ECS 的加持之下，貌似它是一个很恰当的一库存所有的方案，但前提是你需要能 hold 住性价比。&lt;/li>
&lt;li>时序数据库：不一一列举，适合指标类时序数据。&lt;/li>
&lt;li>列数据库：以 ClickHouse 为代表的实时数据分析的列数据库，可兼容多种信号。&lt;/li>
&lt;li>关系型数据库：WHY NOT。&lt;/li>
&lt;/ul>
&lt;p>从数据入库的角度看，给每种信号量配置其最佳的数据库类型，貌似是一个皆大欢喜的局面。这也不辜负，目前各种开源数据库百花齐放的形势。&lt;/p>
&lt;p>略过上面已经提到的数据孤岛和治理问题不谈。从查询的角度看，用户将不得不学会多种查询语言，前方有 n 种 SQL 语法需要你学习，否则你不得不开发维护一个一对多的查询界面。这里我们暂且不论述：你会如何实现可观测性数据的跨库数据关联分析。&lt;/p>
&lt;p>问题：是否存在一种多模态的统一数据库，将多种类型的信号量数据融入一个统一的数据仓库中？&lt;/p>
&lt;p>实际上，目前的可观测性 SaaS 提供商们，已经给他们的用户提供了这样一种统一融合的数据后端，起码从查询探索可观测性数据的使用体感的角度上，确实是已经做到了。而观测云也正在推出这样一款解决以上统一融合多态并存管理需求的数据库。观测云用户很快将在 SaaS服务中，在私有部署的产品上使用到这种技术。&lt;/p>
&lt;h2 id="自由探索和综合使用数据">自由探索和综合使用数据
&lt;/h2>&lt;p>可观测性数据的价值体现在使用上，能自由的探索和综合的使用各种数据，才能放大数据的价值。在考虑到可观测性数据使用场景的时候，我强烈建议大家运用“第一性原理”来进行思考。这样才能避免对经验的依赖，排除对新可观测性技术能平替所有旧技术的单纯幻想，才能回到可观测性技术的概念本源。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/blog/what-observability-give-us/o11y-define.jpg"
width="1358"
height="669"
srcset="https://martinliu.cn/blog/what-observability-give-us/o11y-define_hu_7efdb74ad596a617.jpg 480w, https://martinliu.cn/blog/what-observability-give-us/o11y-define_hu_971978f7c3b73844.jpg 1024w"
loading="lazy"
alt="可观测性定义"
class="gallery-image"
data-flex-grow="202"
data-flex-basis="487px"
>&lt;/p>
&lt;p>此处省略 n 百字，仅以上图与读者们一起随时随刻的校准自己对“可观测性”定义的理解。&lt;/p>
&lt;h2 id="总结">总结
&lt;/h2>&lt;p>本文从四个层面对可观测性平台实现的技术要点，做出了一定深度和时间跨度上的探讨。希望：在您的工作环境中，统一融合的可观测性平台可以很快的落地。穿上两只靴子的你，可以脱离以前赤足上阵，光脚救火的困境。希望可观测性平台能够帮助到软件交付流水线中的所有人，运用可观测性来补Ops的锅，助SRE的威，壮Dev胆。&lt;/p></description></item><item><title>Elastic Agent 和 Fleet 服务器 安装手册 v8.4</title><link>https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/</link><pubDate>Tue, 18 Oct 2022 21:32:14 +0800</pubDate><guid>https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/</guid><description>&lt;img src="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/observability.png" alt="Featured image of post Elastic Agent 和 Fleet 服务器 安装手册 v8.4" />&lt;p>测试过程和环境概述：&lt;/p>
&lt;ul>
&lt;li>用一个 RHEL 9 虚拟机安装 Elasticsearch 和 Kibana；然后部署 Fleet 服务器。&lt;/li>
&lt;li>在另外一个虚拟机安装 Elastic Agent，初始化注册到 Fleet 服务器，然后更新对它的管理策略。&lt;/li>
&lt;li>在 Kibana 的可观测性和安全解决方案中观察采集到的数据。&lt;/li>
&lt;/ul>
&lt;h2 id="安装-elasticsearch">安装 Elasticsearch
&lt;/h2>&lt;p>下载 Elasticsearch 的 rpm 安装包，用 rpm 的方式安装 Elasticssearch 服务器。 &lt;code>dnf install elasticsearch-8.4.3-x86_64.rpm &lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@elk8 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># dnf install elasticsearch-8.4.3-x86_64.rpm &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Updating Subscription Management repositories.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Red Hat Enterprise Linux &lt;span class="m">9&lt;/span> &lt;span class="k">for&lt;/span> x86_64 - BaseOS &lt;span class="o">(&lt;/span>RPMs&lt;span class="o">)&lt;/span> 3.9 kB/s &lt;span class="p">|&lt;/span> 4.1 kB 00:01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Red Hat Enterprise Linux &lt;span class="m">9&lt;/span> &lt;span class="k">for&lt;/span> x86_64 - AppStream &lt;span class="o">(&lt;/span>RPMs&lt;span class="o">)&lt;/span> 3.9 kB/s &lt;span class="p">|&lt;/span> 4.1 kB 00:01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Dependencies resolved.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=============================================================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Package Architecture Version Repository &lt;span class="nv">Size&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=============================================================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Installing:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> elasticsearch x86_64 8.4.3-1 @commandline &lt;span class="m">540&lt;/span> M
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Transaction &lt;span class="nv">Summary&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=============================================================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Install &lt;span class="m">1&lt;/span> Package
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Total size: &lt;span class="m">540&lt;/span> M
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Installed size: 1.1 G
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Is this ok &lt;span class="o">[&lt;/span>y/N&lt;span class="o">]&lt;/span>: y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Downloading Packages:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Running transaction check
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Transaction check succeeded.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Running transaction &lt;span class="nb">test&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Transaction &lt;span class="nb">test&lt;/span> succeeded.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Running transaction
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Preparing : 1/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Running scriptlet: elasticsearch-8.4.3-1.x86_64 1/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating elasticsearch group... OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating elasticsearch user... OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Installing : elasticsearch-8.4.3-1.x86_64 1/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Running scriptlet: elasticsearch-8.4.3-1.x86_64 1/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--------------------------- Security autoconfiguration information ------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Authentication and authorization are enabled.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TLS &lt;span class="k">for&lt;/span> the transport and HTTP layers is enabled and configured.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The generated password &lt;span class="k">for&lt;/span> the elastic built-in superuser is : guJrLagKN5bsmUh72bha
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">If this node should join an existing cluster, you can reconfigure this with
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;/usr/share/elasticsearch/bin/elasticsearch-reconfigure-node --enrollment-token &amp;lt;token-here&amp;gt;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">after creating an enrollment token on your existing cluster.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You can &lt;span class="nb">complete&lt;/span> the following actions at any time:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Reset the password of the elastic built-in superuser with
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;/usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic&amp;#39;&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Generate an enrollment token &lt;span class="k">for&lt;/span> Kibana instances with
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;/usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana&amp;#39;&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Generate an enrollment token &lt;span class="k">for&lt;/span> Elasticsearch nodes with
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;/usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s node&amp;#39;&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------------------------------------------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### NOT starting on installation, please execute the following statements to configure elasticsearch service to start automatically using systemd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sudo systemctl daemon-reload
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sudo systemctl &lt;span class="nb">enable&lt;/span> elasticsearch.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### You can start elasticsearch service by executing&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sudo systemctl start elasticsearch.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/tmpfiles.d/elasticsearch.conf:1: Line references path below legacy directory /var/run/, updating /var/run/elasticsearch → /run/elasticsearch&lt;span class="p">;&lt;/span> please update the tmpfiles.d/ drop-in file accordingly.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Verifying : elasticsearch-8.4.3-1.x86_64 1/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Installed products updated.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Installed:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> elasticsearch-8.4.3-1.x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Complete!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@elk8 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>安装完毕之后，用 vi 编辑器打开 &lt;code>/etc/elasticsearch/elasticsearch.yml&lt;/code> 配置文件 ； 在这个默认配置文件中寻找类似这样的一行 &lt;code>cluster.initial_master_nodes: [&amp;quot;elk8&amp;quot;]&lt;/code> ；将这一行注释掉。&lt;/p>
&lt;p>然后在此配置文件的最下面增加下面这几行。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">cluster.name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">homelab-elk8&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">discovery.type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">single-node&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">network.host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">0.0.0.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">xpack.security.authc.api_key.enabled&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>启动 Elasticsearch 服务，并查看服务的状态。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo systemctl daemon-reload
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl &lt;span class="nb">enable&lt;/span> elasticsearch.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start elasticsearch.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl status elasticsearch
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在使用 ES 前，可以先修改ES服务初始化的内建用户密码，改成自己好记的安全可控密码。否则需要到 ES 的启动日志里寻找系统自动生产的管理员密码。&lt;/p>
&lt;p>运行 &lt;code>/usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic -i&lt;/code> 命令修改 ES 的管理员账号 elastic 的密码。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@elk8 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># /usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic -i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">This tool will reset the password of the &lt;span class="o">[&lt;/span>elastic&lt;span class="o">]&lt;/span> user.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You will be prompted to enter the password.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Please confirm that you would like to &lt;span class="k">continue&lt;/span> &lt;span class="o">[&lt;/span>y/N&lt;span class="o">]&lt;/span>y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter password &lt;span class="k">for&lt;/span> &lt;span class="o">[&lt;/span>elastic&lt;span class="o">]&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Re-enter password &lt;span class="k">for&lt;/span> &lt;span class="o">[&lt;/span>elastic&lt;span class="o">]&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password &lt;span class="k">for&lt;/span> the &lt;span class="o">[&lt;/span>elastic&lt;span class="o">]&lt;/span> user successfully reset.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在启动 ES 服务前，打开后续测试所需要的防火墙端口。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --permanent --add-port&lt;span class="o">=&lt;/span>9200/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --permanent --add-port&lt;span class="o">=&lt;/span>5601/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --permanent --add-port&lt;span class="o">=&lt;/span>8220/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在浏览器里访问 es 的访问网址 https://10.0.30.105:9200/ ，忽略关于证书的安全提示，输入上面所修改的 elastic 账户信息，测试是否可以正常登录。&lt;/p>
&lt;h2 id="安装-kibana">安装 Kibana
&lt;/h2>&lt;p>下载 Kibana 的 rpm 安装包到服务器，然后执行下面的安装命令&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@elk8 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># dnf install kibana-8.4.3-x86_64.rpm &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Updating Subscription Management repositories.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last metadata expiration check: 0:22:56 ago on Sun &lt;span class="m">16&lt;/span> Oct &lt;span class="m">2022&lt;/span> 02:20:20 PM CST.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Dependencies resolved.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=======================================================================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Package Architecture Version Repository &lt;span class="nv">Size&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=======================================================================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Installing:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> kibana x86_64 8.4.3-1 @commandline &lt;span class="m">274&lt;/span> M
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Transaction &lt;span class="nv">Summary&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=======================================================================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Install &lt;span class="m">1&lt;/span> Package
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Total size: &lt;span class="m">274&lt;/span> M
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Installed size: &lt;span class="m">649&lt;/span> M
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Is this ok &lt;span class="o">[&lt;/span>y/N&lt;span class="o">]&lt;/span>: y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Downloading Packages:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Running transaction check
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Transaction check succeeded.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Running transaction &lt;span class="nb">test&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Transaction &lt;span class="nb">test&lt;/span> succeeded.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Running transaction
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Preparing : 1/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Running scriptlet: kibana-8.4.3-1.x86_64 1/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Installing : kibana-8.4.3-1.x86_64 1/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Running scriptlet: kibana-8.4.3-1.x86_64 1/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating kibana group... OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating kibana user... OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created Kibana keystore in /etc/kibana/kibana.keystore
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/tmpfiles.d/elasticsearch.conf:1: Line references path below legacy directory /var/run/, updating /var/run/elasticsearch → /run/elasticsearch&lt;span class="p">;&lt;/span> please update the tmpfiles.d/ drop-in file accordingly.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Verifying : kibana-8.4.3-1.x86_64 1/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Installed products updated.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Installed:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> kibana-8.4.3-1.x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Complete!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在启动 Kiban 服务器之前，先需要创建 Kibana 需要的各种加密 key ，执行下面的命令。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/usr/share/kibana/bin/kibana-encryption-keys generate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">xpack.encryptedSavedObjects.encryptionKey: 2e71f1b16031c2b111b76276268dbf9e
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">xpack.reporting.encryptionKey: 84cb58b5e944fa9f65f73382384612a5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">xpack.security.encryptionKey: c5ac5b306ee011838a67e2eaf4154dd0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>记录以上三行配置参数，并增加2行新参数，将它们全部添加到 Kibana 默认的配置文件中。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">server.host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">0.0.0.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">server.publicBaseUrl&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;http://10.0.30.105:5601&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">xpack.encryptedSavedObjects.encryptionKey&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">2e71f1b16031c2b111b76276268dbf9e&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">xpack.reporting.encryptionKey&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">84cb58b5e944fa9f65f73382384612a5&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">xpack.security.encryptionKey&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">c5ac5b306ee011838a67e2eaf4154dd0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>用 vi 打开 Kibana 的默认配置文件 &lt;code>/etc/kibana/kibana.yml&lt;/code> ，将上面的 5 行配置参数添加到文件中。&lt;/p>
&lt;p>在命令行执行 &lt;code>systemctl enable --now kibana&lt;/code> 命令启动 Kibana 服务器.&lt;/p>
&lt;p>然后执行命令 &lt;code>tail -f /var/log/messages&lt;/code> ， 在日志中寻找 Kibana 服务启动的信息，等待出现 Kibana 配置的访问 URL。在日志中寻找类似这样的信息：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="err">Oct&lt;/span> &lt;span class="mi">18&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="mi">48&lt;/span> &lt;span class="err">elk&lt;/span>&lt;span class="mi">8&lt;/span> &lt;span class="err">kibana&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2163&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">:&lt;/span> &lt;span class="err">i&lt;/span> &lt;span class="err">Kibana&lt;/span> &lt;span class="err">has&lt;/span> &lt;span class="err">not&lt;/span> &lt;span class="err">been&lt;/span> &lt;span class="err">configured.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">Oct&lt;/span> &lt;span class="mi">18&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="mi">48&lt;/span> &lt;span class="err">elk&lt;/span>&lt;span class="mi">8&lt;/span> &lt;span class="err">kibana&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2163&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">:&lt;/span> &lt;span class="err">Go&lt;/span> &lt;span class="err">to&lt;/span> &lt;span class="err">http:&lt;/span>&lt;span class="c1">//0.0.0.0:5601/?code=732948 to get started.
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>将 0.0.0.0 替换为这台虚拟机的 IP 地址，然后在浏览器中打开这个类似这个 &lt;code>http://10.0.30.105:5601/?code=732948&lt;/code> 网址。网页中会出现一个大输入框，等待输入Kibana 注册秘钥。&lt;/p>
&lt;p>在命令行执行 &lt;code>/usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana&lt;/code> 命令，从而获取 Kibana 的注册令牌。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@elk8 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">eyJ2ZXIiOiI4LjQuMyIsImFkciI6WyIxOTIuMTY4LjEwLjEwOjkyMDAiXSwiZmdyIjoiZTdlOTdlZWU2YWVlYjVmYTczZWM1YTVkNzBiNDJkZGUzZjlkZmNjMDJhNTVmZDcwZjAxOTQwZmExNzE5YWM2MSIsImtleSI6IjNHLVEzNE1CYnA4c3p4TEZEZXpCOk0wUDMzRC1VVFAyT0ZxQVFBekNKSWcifQ&lt;/span>&lt;span class="o">==&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>将这个 Token 复制到网页里，完成Kibana 的初始化配置，最后用 es 的管理员账号登录 Kibana。&lt;/p>
&lt;p>从 kiban 目录中找到 es 的根 ca 证书，将其安装在系统的默认根证书目录中。查看 Kibana 的配置文件找到类似这样的一行配置信息。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">elasticsearch.ssl.certificateAuthorities: &lt;span class="o">[&lt;/span>/var/lib/kibana/ca_1666060779947.crt&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>运行下面的命令安装这个根证书。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">update-ca-trust &lt;span class="nb">enable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp /var/lib/kibana/ca_1666060779947.crt /etc/pki/ca-trust/source/anchors/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">update-ca-trust extract
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>建议将这个根证书也用这个方法复制到其他需要用 Elastic Agent 采集监控数据的操作系统中，并安装备用。也可以在 Elastic Agent 安装的时候指定忽略 ES 证书校验的参数。&lt;/p>
&lt;h2 id="安装-fleet-服务器">安装 Fleet 服务器
&lt;/h2>&lt;p>在 Kibana 的菜单中找到， Fleet 选项，点击 Settings，然后点击 Edit Hosts ，选择增加 Fleet server 配置信息，输入 &lt;code>https://10.0.30.105:8220&lt;/code> ，注意这里必须是 https协议。&lt;/p>
&lt;p>回到 Fleet 主页，找到 agent 管理的地方，按照流程做，点击创建 Fleet Server 配置。然后就会在页面上生成 Fleet 服务器的安装配置命令。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_10-46-39.png"
width="1280"
height="1090"
srcset="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_10-46-39_hu_3d0e290281eca0ee.png 480w, https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_10-46-39_hu_55ca710f9e4a41b3.png 1024w"
loading="lazy"
alt="Fleet server"
class="gallery-image"
data-flex-grow="117"
data-flex-basis="281px"
>&lt;/p>
&lt;p>按着提示的命令参数安装 Fleet 服务器。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -L -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar xzvf elastic-agent-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> elastic-agent-8.4.3-linux-x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ./elastic-agent install &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --fleet-server-es&lt;span class="o">=&lt;/span>https://192.168.10.10:9200 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --fleet-server-service-token&lt;span class="o">=&lt;/span>AAEAAWVsYXN0aWMvZmxlZXQtc2VydmVyL3Rva2VuLTE2NjU5MTM3ODg1NTA6aWdrR1pvNk9SWmk5N09tV3pUQktTUQ &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --fleet-server-policy&lt;span class="o">=&lt;/span>fleet-server-policy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --insecure
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上面是连续四条安装命令，需要在最后一条命中，增加一个参数 &lt;code>--insecure&lt;/code> ；这样可以确保 Fleet 服务器的正常配置。&lt;/p>
&lt;p>在 Fleet 服务器正常启动以后，上面创建 Fleet 服务器配置的网页上的最后一步就会显示：Fleet 服务器已经连接正常，等待注册 Elastic Agent 。这样表明 Fleet 服务器已经安装正常，并且运行在默认的代理配置采集策略下。&lt;/p>
&lt;p>可以在 Kibana 的界面里查看 Fleet 服务器的监控信息。点击 Kibana 左上角的菜单：Observability -&amp;gt; Infrastructure -&amp;gt; Inventory ，即可看到 Fleet 服务器的监控数据。&lt;/p>
&lt;h2 id="安装-elastic-agent-监控代理">安装 Elastic Agent 监控代理
&lt;/h2>&lt;p>在 Fleet 的管理界面中新增一个名为 my-policy1 的管理策略，避免和 Fleet 服务器使用相同的策略。点击 Add agent 连接，获取如下代理注册命令。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">curl -L -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar xzvf elastic-agent-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> elastic-agent-8.4.3-linux-x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ./elastic-agent install --url&lt;span class="o">=&lt;/span>https://10.0.30.105:8220 --enrollment-token&lt;span class="o">=&lt;/span>&lt;span class="nv">NW9ZTjZZTUJtUENhc0ZFTDI5SV86MkZQT1hlc2dUOEdWZnRrWWhNbXVjdw&lt;/span>&lt;span class="o">==&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>将上面的命令复制到一个写字板中，修改最后一条命令，在最后增加&lt;code>--insecure&lt;/code> 参数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">./elastic-agent install --url&lt;span class="o">=&lt;/span>https://10.0.30.105:8220 --enrollment-token&lt;span class="o">=&lt;/span>&lt;span class="nv">NW9ZTjZZTUJtUENhc0ZFTDI5SV86MkZQT1hlc2dUOEdWZnRrWWhNbXVjdw&lt;/span>&lt;span class="o">==&lt;/span> --insecure
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>通过执行上面的命令，我们就在被管理服务器上，一键式的安装了用于数据采集功能的 Elastic Agent ，并将其注册到 Fleet 服务器上。你也可以手工下载好 &lt;code>elastic-agent-8.4.3-linux-x86_64.tar.gz &lt;/code> 文件，但是反复在多个被管理服务器上复制也很麻烦。&lt;/p>
&lt;h2 id="搭建本地安装包下载服务器">搭建本地安装包下载服务器
&lt;/h2>&lt;p>为了让局域网中的操作系统能就近下载 Elastic Stack 技术栈中，所有可以通过 Fleet 服务器管理（安装、配置、升级、删除等）的组件，我们可以参考文档的方法：https://www.elastic.co/guide/en/fleet/8.4/air-gapped.html#host-artifact-registry 在本地部署一个安装包下载服务器。&lt;/p>
&lt;p>首先，安装一个 Nginx 服务器，在根目录下创建目录 downloads ，并且运行下面的下载脚本。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/apm-server/apm-server-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/apm-server/apm-server-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/apm-server/apm-server-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/auditbeat/auditbeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/auditbeat/auditbeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/auditbeat/auditbeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/heartbeat/heartbeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/heartbeat/heartbeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/heartbeat/heartbeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/metricbeat/metricbeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/metricbeat/metricbeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/metricbeat/metricbeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/osquerybeat/osquerybeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/osquerybeat/osquerybeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/osquerybeat/osquerybeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/packetbeat/packetbeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/packetbeat/packetbeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/beats/packetbeat/packetbeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/cloudbeat/cloudbeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/cloudbeat/cloudbeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/cloudbeat/cloudbeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/endpoint-dev/endpoint-security-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/endpoint-dev/endpoint-security-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/endpoint-dev/endpoint-security-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/fleet-server/fleet-server-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/fleet-server/fleet-server-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O https://artifacts.elastic.co/downloads/fleet-server/fleet-server-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>将下载后的目录结构整理的和下载路径一致，目录结构如下所示：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@elk8 html&lt;span class="o">]&lt;/span>&lt;span class="c1"># tree downloads/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">downloads/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── apm-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── apm-server-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── apm-server-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ └── apm-server-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── beats
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── auditbeat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── auditbeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── auditbeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ └── auditbeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── elastic-agent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── elastic-agent-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── elastic-agent-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ └── elastic-agent-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── filebeat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── filebeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── filebeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ └── filebeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── heartbeat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── heartbeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── heartbeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ └── heartbeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── metricbeat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── metricbeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── metricbeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ └── metricbeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── osquerybeat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── osquerybeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ ├── osquerybeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ │ └── osquerybeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ └── packetbeat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── packetbeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── packetbeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ └── packetbeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── cloudbeat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── cloudbeat-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── cloudbeat-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ └── cloudbeat-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── endpoint-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── endpoint-security-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── endpoint-security-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ └── endpoint-security-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── fleet-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── fleet-server-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── fleet-server-8.4.3-linux-x86_64.tar.gz.asc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ └── fleet-server-8.4.3-linux-x86_64.tar.gz.sha512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└── pull-bin.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">12&lt;/span> directories, &lt;span class="m">34&lt;/span> files
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@elk8 html&lt;span class="o">]&lt;/span>&lt;span class="c1"># &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>为了方便查看这个目录的内容，修改 nginx 的默认配置文件，在 http 这个部分增加下面三个参数：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">autoindex on; &lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">autoindex_exact_size off;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">autoindex_localtime on; &lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>重启 Nginix 服务器后，在浏览器中可以访问： http://192.168.10.10/downloads/ ，确保可以看到正确的目录结构和文件。&lt;/p>
&lt;p>进入 Fleet 的配置页面，在 &lt;code>Agent Binary Download&lt;/code> 下面点击 “Add agent binary source” ，新建一个新的代理安装包下载来源网站。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_14-21-44.png"
width="1920"
height="1436"
srcset="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_14-21-44_hu_c95d59291820b55d.png 480w, https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_14-21-44_hu_2bf663dfb53b4dea.png 1024w"
loading="lazy"
alt="Agent Binary Download"
class="gallery-image"
data-flex-grow="133"
data-flex-basis="320px"
>&lt;/p>
&lt;p>在 Agent Policies 页面新建一个新的测试用 Agent 管理策略，名为 “my-policy2”；进入这个策略的配置界面，修改 &lt;em>Agent Binary Download&lt;/em> 为刚才创建的下载源。保存并测试这个策略。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_14-25-35.png"
width="1920"
height="1860"
srcset="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_14-25-35_hu_e9e762737e6eae10.png 480w, https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_14-25-35_hu_5a9d2e0438907373.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="103"
data-flex-basis="247px"
>&lt;/p>
&lt;p>点击 “Add agent” 连接，获取下面的新注册代理注册命令。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">curl -L -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.4.3-linux-x86_64.tar.gz tar xzvf elastic-agent-8.4.3-linux-x86_64.tar.gz &lt;span class="nb">cd&lt;/span> elastic-agent-8.4.3-linux-x86_64 sudo ./elastic-agent install --url&lt;span class="o">=&lt;/span>https://10.0.30.105:8220 --enrollment-token&lt;span class="o">=&lt;/span>&lt;span class="nv">R29qRDZZTUJtUENhc0ZFTFNDSW06bVFOeW5vcUpTQmFmZDBwLUgyTDBYZw&lt;/span>&lt;span class="o">==&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>修改这些命令参数，如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -L -O http://192.168.10.10/downloads/beats/elastic-agent/elastic-agent-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar xzvf elastic-agent-8.4.3-linux-x86_64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> elastic-agent-8.4.3-linux-x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ./elastic-agent install --url&lt;span class="o">=&lt;/span>https://10.0.30.105:8220 --enrollment-token&lt;span class="o">=&lt;/span>&lt;span class="nv">R29qRDZZTUJtUENhc0ZFTFNDSW06bVFOeW5vcUpTQmFmZDBwLUgyTDBYZw&lt;/span>&lt;span class="o">==&lt;/span> --insecure
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>SSH 登录到另外一个虚拟机，用新创建的 Agent 管理策略，一键式安装 Elastic Agent 并注册到 Fleet 服务器。由于这个策略使用了本地的安装包（默认会使用到 Filebeat 和 Metricbeat），所以它的部署速度应该会比较快。&lt;/p>
&lt;p>在 Elastic Agent 的日志文件中应该可以看到类似这样的信息。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">cat /opt/Elastic/Agent/elastic-agent-20221018.ndjson
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sb">```&lt;/span>json
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">{&lt;/span>&lt;span class="s2">&amp;#34;log.level&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;info&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;@timestamp&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;2022-10-18T14:37:26.697+0800&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;log.origin&amp;#34;&lt;/span>:&lt;span class="o">{&lt;/span>&lt;span class="s2">&amp;#34;file.name&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;artifact/config.go&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;file.line&amp;#34;&lt;/span>:138&lt;span class="o">}&lt;/span>,&lt;span class="s2">&amp;#34;message&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;Source URI changed from \&amp;#34;https://artifacts.elastic.co/downloads/\&amp;#34; to \&amp;#34;http://192.168.10.10/downloads/\&amp;#34;&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;ecs.version&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;1.6.0&amp;#34;&lt;/span>&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这个信息表示：当前的 Agent 会使用上面自建的安装包下载源服务器。&lt;/p>
&lt;p>用这个命令 &lt;code>elastic-agent inspect&lt;/code> 也可以确认这个配置。&lt;/p>
&lt;h2 id="万用采集端的好处">万用采集端的好处
&lt;/h2>&lt;p>在上一篇文章中已经说过了这个问题，这里不赘述。&lt;/p>
&lt;p>为了验证这个功能，可以尝试更新当前的一个 policy，增加 Packetbeat 数据采集能力。操作步骤如下：&lt;/p>
&lt;ol>
&lt;li>打开当前的一个正在使用中 policy&lt;/li>
&lt;li>点击 Add intergation 按钮，在众多选项中选择 Network Packet Capture 模块。&lt;/li>
&lt;li>增加新的采集模块后，保存这个策略。&lt;/li>
&lt;li>它更新了版本，观察 Fleet 界面上所有使用这个策略的节点的状态变化。&lt;/li>
&lt;li>这些节点会自动的，很快的更新到新的管理策略中，Elastic Agent 会自动化安装 Packetbeat 采集模块。&lt;/li>
&lt;li>返回 Kiban ，进入安全管理解决方案，我们可以看到 Filebeat 和 Packetbeat 的采集结果。&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_22-49-08.png"
width="1920"
height="817"
srcset="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_22-49-08_hu_63b82c96a00d5d41.png 480w, https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_22-49-08_hu_78045171d2680604.png 1024w"
loading="lazy"
alt="添加 Packetbeat 模块"
class="gallery-image"
data-flex-grow="235"
data-flex-basis="564px"
>&lt;/p>
&lt;p>在策略更新了以后，我们没有在 Elastic Agent 端做任何操作，它就已经自动化的下载新的策略，并更新了自身。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_22-53-55.png"
width="1920"
height="1675"
srcset="https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_22-53-55_hu_677fb959b954497d.png 480w, https://martinliu.cn/blog/elastic-agent-fleet-update-8-4/2022-10-18_22-53-55_hu_af73df2f5290255.png 1024w"
loading="lazy"
alt="查看 安全管理解决方案"
class="gallery-image"
data-flex-grow="114"
data-flex-basis="275px"
>&lt;/p>
&lt;h2 id="常见问题">常见问题
&lt;/h2>&lt;p>Elastic Agent 在采集数据的服务上安装正常，在 Fleet 服务器的管理界面中也可以看到其状态正常。但是在可观测性的页面中看不到它的任何数据。&lt;/p>
&lt;p>可能的原因：Elastic Agent 采集端程序和 ES 后台服务器的通讯不正常，检查 9200 端口，用 curl + ES 服务器端的数字证书，用户名和密码，尝试访问 ES 的服务地址 &lt;code>https://192.168.10.10:9200&lt;/code>。&lt;/p>
&lt;p>也可以尝试在 Fleet 的管理页面上删除这个 Agent；然后在被管理服务器上，用命令 &lt;code>elastic-agent uninstall&lt;/code> 删除服务，然后重新安装注册这个被管理服务器，注意在注册命令的最后面可以尝试增加这两个参数：&lt;code> --insecure --fleet-server-es-insecure&lt;/code> 第一个参数是忽略 Fleet 服务器的 ssl 证书校验，第二个参数是忽略 es 服务器的 ssl 证书校验。或者尝试重新手工安装一遍 es 服务器上的 ca 根证书。&lt;/p>
&lt;p>Feature picture ❤️ Brett Sayles图片: &lt;a class="link" href="https://www.pexels.com/zh-cn/photo/2881224/" target="_blank" rel="noopener"
>https://www.pexels.com/zh-cn/photo/2881224/&lt;/a>&lt;/p></description></item><item><title>Elastic 可观测性工作坊</title><link>https://martinliu.cn/blog/workshop-elastic-observability/</link><pubDate>Sat, 06 Feb 2021 10:36:12 +0800</pubDate><guid>https://martinliu.cn/blog/workshop-elastic-observability/</guid><description>&lt;img src="https://martinliu.cn/img/2021/Hubble_01.jpg" alt="Featured image of post Elastic 可观测性工作坊" />&lt;p>本工作坊包括本地虚拟机版本、AWS 和腾讯云共三个版本，目标是用实践的方式理解 Elastic 可观测性解决方案。可观测性是解决运维云原生应用的复杂性和分布式式难点的关键所在。&lt;/p>
&lt;h2 id="简介">简介
&lt;/h2>&lt;p>Elastic 可观测性解决方案是基于 Elastic Stack 的一站式解决方案。该解决方案具有完备的日志、指标、APM 和可用性采集能力，可以在大规模/云原生的环境下，完成服务质量目标（SLO）的管理。本实战工作坊基于多层架构的宠物诊所为示例应用程序，手把手的引导参与者搭建可观测性管理平台，体验分层次的收集整合、分析、关联和搜索运维数据的全过程。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/images/elastic-obv-solution.png"
loading="lazy"
alt="可观测性解决方案"
>&lt;/p>
&lt;h2 id="为什么要做这个工作坊">为什么要做这个工作坊？
&lt;/h2>&lt;p>从理论的理解到技术工具的实操掌握需要一个过程。&lt;/p>
&lt;ul>
&lt;li>关于可观测性的各种一小时左右的技术、方案、产品分享，完全无法让听众正确理解可观测性的相关概念&lt;/li>
&lt;li>而通过实操性质的，上机动手实验则可以让新手迅速入门，使熟手快速全面的提高&lt;/li>
&lt;li>大量 ELK 用户只使用到了日志管理的部分功能，还不了解任何一种可观测性管理方案的全貌&lt;/li>
&lt;li>社区里的朋友们对可观测性心存大量误解，如“ APM 工具就等于可观测性” 等等，因此相关的正确观念和技术急需尽快普及&lt;/li>
&lt;/ul>
&lt;p>通过半天的实战演练，彻底学会相关知识。&lt;/p>
&lt;h2 id="动手实验">动手实验
&lt;/h2>&lt;p>本工作坊的最佳参与方式是在老师的引导下，在线下/线上同步进行。其次是在视频的指导下自学。所有动手实验的目标是：理解可观测性解决方案的各个组成部分，以及为什么要使用这些工具？而且这个整个方案的实施过程和顺序也是经过精心设计的，目标是让理论和实际彻底融会贯通。&lt;/p>
&lt;p>您将会学到：&lt;/p>
&lt;ol>
&lt;li>搭建单节点 Elasticsearch 服务，并且配置好 Kibana 管理图形管理界面。&lt;/li>
&lt;li>学习可观测性的基本概念和实施步骤&lt;/li>
&lt;li>搭建和配置服务健康检查的探针&lt;/li>
&lt;li>部署采集操作系统性能监控指标的流程&lt;/li>
&lt;li>配置操作系统日志的采集和分析工具&lt;/li>
&lt;li>搭建用于 APM 追踪分析的后台服务&lt;/li>
&lt;li>运行一个多层架构的宠物商店应用，对各个子服务进行 APM 监控埋点&lt;/li>
&lt;li>配置常用的服务质量监控大屏&lt;/li>
&lt;/ol>
&lt;p>本工作坊课程基于如下的应用系统。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/images/16042852442364.png"
loading="lazy"
alt="架构图"
>&lt;/p>
&lt;p>应用基本概况：&lt;/p>
&lt;ul>
&lt;li>多层宠物商店应用系统&lt;/li>
&lt;li>所有组件都部署在一个虚拟机上&lt;/li>
&lt;li>包括前端、后端和内置的数据库&lt;/li>
&lt;li>使用到的技术有 JavaScript、NodeJs 和 Java Spring 等。&lt;/li>
&lt;li>本应用系统是被监控的对象&lt;/li>
&lt;/ul>
&lt;p>Elastic Stack 的基本状况：&lt;/p>
&lt;ul>
&lt;li>版本 7.9.3&lt;/li>
&lt;li>组件 Elasticsearch、Kibana、APM、Filebeat、Metricbeat 和 Heatbeat。&lt;/li>
&lt;/ul>
&lt;p>实验环境：&lt;/p>
&lt;ul>
&lt;li>本地虚拟机环境，打包好的虚拟机里包含了所有必要的软件包和演示应用。&lt;/li>
&lt;li>AWS 云环境，本课程所使用的公共 AMI 操作系统镜像：宁夏区 &lt;code>ami-0e5a0e294902966af&lt;/code> 北京区 &lt;code>ami-0e1382088b62cb38d&lt;/code>&lt;/li>
&lt;li>腾讯云环境，基于腾讯云提供的 Elasticsearch 服务，演示用的虚拟机在制作中，稍后会发布到云市场。&lt;/li>
&lt;li>阿里云环境，基于阿里云提供的 Elasticsearch 服务的课件正在开发中。&lt;/li>
&lt;/ul>
&lt;h2 id="可观测性构建四步法">可观测性构建四步法
&lt;/h2>&lt;p>可观测性依赖于应用系统自身和监控工具平台的配合实现。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/images/e2e85893b5dd8014.jpeg"
loading="lazy"
alt="可观测性"
>&lt;/p>
&lt;p>分层次的构建可观测性的推荐过程如下：&lt;/p>
&lt;ol>
&lt;li>STEP0：使用 Heatbeat 构建轻量灵活的服务健康检查能力&lt;/li>
&lt;li>STEP1：使用 Metricbeat 构建全面细致的指标采集能力&lt;/li>
&lt;li>STEP2：使用 Filebeat 构建高维度的日志采集能力&lt;/li>
&lt;li>STEP3：使用 APM 构建分布式应用系统的全堆栈追踪能力&lt;/li>
&lt;/ol>
&lt;p>通过以上的四个构建步骤，使用 Elastic Stack 实施四大服务质量监控能力的构建，搭建了持续统一运维管理的工具平台。&lt;/p>
&lt;p>使用 SRE 基于‘用户旅程’或‘系统边界’的 SLO 分析设定方法，从 Elastic Stack 的已有数据采集能力中，选取第批直接可用的 SLI 采集点。在基于 SLO 的监控过程中，不断的优选 SLI，调整告警的数量和质量，为开发团队提供持续有效的反馈。&lt;/p>
&lt;p>使用 Canvas 的画布功能，定制如下的 SLO 监控大屏。&lt;/p>
&lt;p>&lt;img src="https://martinliu.cn/images/2020-11-05_00-13-06.jpeg"
loading="lazy"
alt="2020-11-05_00-13-06"
>&lt;/p>
&lt;h2 id="工作坊课件">工作坊课件
&lt;/h2>&lt;p>讲师 PPT 下载： &lt;a class="link" href="https://docs.qq.com/slide/DUGRzYVVTU3ZxblBP" target="_blank" rel="noopener"
>https://docs.qq.com/slide/DUGRzYVVTU3ZxblBP&lt;/a>&lt;/p>
&lt;h3 id="本地虚拟机环境">本地虚拟机环境
&lt;/h3>&lt;p>可以使用本地的 VirtualBox 或者 VMWare 的虚拟机环境，配合以下课件完成所有练习。&lt;/p>
&lt;ol>
&lt;li>&lt;a class="link" href="https://elk-workshop.github.io/codelabs/one-nodes-es-server/#0" target="_blank" rel="noopener"
>‘Elastic Stack 单节点搭建’ 课件&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://elk-workshop.github.io/codelabs/elastic-observability-foundation/#0" target="_blank" rel="noopener"
>‘Elastic 可观测性方案’ 课件&lt;/a>&lt;/li>
&lt;/ol>
&lt;h3 id="aws-云计算环境">AWS 云计算环境
&lt;/h3>&lt;p>可以使用 AWS 云计算（中国区北京或宁夏区）环境，配合以下的课件完成所有练习。&lt;/p>
&lt;ol>
&lt;li>&lt;a class="link" href="https://elk-workshop.github.io/codelabs/one-nodes-es-server/#0" target="_blank" rel="noopener"
>‘Elastic Stack 单节点搭建’ 课件&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://elk-workshop.github.io/codelabs/elastic-observability-foundation/#0" target="_blank" rel="noopener"
>‘Elastic 可观测性方案’ 课件&lt;/a>&lt;/li>
&lt;/ol>
&lt;h3 id="腾讯云计算环境">腾讯云计算环境
&lt;/h3>&lt;p>可以使用腾讯云计环境，配合以下的课件完成所有练习。&lt;/p>
&lt;ol>
&lt;li>在本环境下，不需要搭建 Elastic Stack 的服务器，参展下面课件的第二步骤，创建 Elasticsearch 服务集群。&lt;/li>
&lt;li>&lt;a class="link" href="https://elk-workshop.github.io/codelabs/elastic-observability-foundation-qq/#0" target="_blank" rel="noopener"
>‘Elastic 可观测性方案’ 课件&lt;/a>&lt;/li>
&lt;li>腾讯云环境录播网址：&lt;a class="link" href="https://cloud.tencent.com/developer/salon/live-1304" target="_blank" rel="noopener"
>腾讯课堂查看&lt;/a>&lt;/li>
&lt;/ol>
&lt;h3 id="阿里云计算环境">阿里云计算环境
&lt;/h3>&lt;p>可以使用阿里云环境，配合以下的课件完成所有练习。&lt;/p>
&lt;blockquote>
&lt;p>课件开发中。&lt;/p>&lt;/blockquote>
&lt;h2 id="如何参与本工作坊">如何参与本工作坊？
&lt;/h2>&lt;p>本工作坊会在多个社区中举办，具体安排如下：&lt;/p>
&lt;ul>
&lt;li>定期在 Elastic 社区中举办可观测性主题的线上或者线下的社区活动，具体报名方式，
&lt;ol>
&lt;li>请关注 Elastic 公司的官方微公众号 “Elastic搜索”。&lt;/li>
&lt;li>关注 Elastic 公司社区在百格的社区活动报名网址：&lt;a class="link" href="https://www.bagevent.com/org/738410" target="_blank" rel="noopener"
>https://www.bagevent.com/org/738410&lt;/a>&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Elasitc 用户日 专场活动，接受企业的团队预约，可以在约定的时间里，通过线上或者线下的方式进行，建议参与学习交流的人数在 10~20 人。 预约邮件： &lt;a class="link" href="mailto:zheng.liu@elastic.co" >zheng.liu@elastic.co&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>由于 Elastic Stack 产品的更新迭代速度特别快，本工作坊的软件版本和学习课件也会不定期更新。欢迎大家积极参与 Elastic 技术社区的交流和学习活动。&lt;/p></description></item></channel></rss>
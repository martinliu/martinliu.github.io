<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>MS Windows on Martin Liu's Blog</title><link>https://martinliu.cn/tags/ms-windows/</link><description>Recent content in MS Windows on Martin Liu's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Sun, 09 Oct 2022 21:44:15 +0800</lastBuildDate><atom:link href="https://martinliu.cn/tags/ms-windows/index.xml" rel="self" type="application/rss+xml"/><item><title>如何用通过OpenNMS监控Windows 服务器</title><link>https://martinliu.cn/2007/12/14/opennms-monitoring-ms-windows/</link><pubDate>Fri, 14 Dec 2007 11:34:00 +0000</pubDate><guid>https://martinliu.cn/2007/12/14/opennms-monitoring-ms-windows/</guid><description>&lt;p>OpenNMS 可以监控可用性和性能参数。下面看看 OpenNMS 监控 Windows 服务器的三种情况。&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->第一种情况：&lt;!-- raw HTML omitted -->Windows 机器上没有安装 SNMP 服务，在自动发现了这个节点后，它会被加入节点列表，之后它被定期的轮询。如果这个节点断网了，OpenNMS 会报警；同时这个节点的可用性被计算。自动发现还会发现这个机器上的服务。ICMP 是肯定会有的，还可能有 http 等其他的服务；这些服务也会被定时的轮询，如果某个服务停了，这个节点的整个的可用性受到影响。这种情况下该节点的所有服务的响应时间会被 OpenNMS 收集并保持历史数据。&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->第二种情况：&lt;!-- raw HTML omitted -->安装了 SNMP 服务。先说一下 windows 服务的安全性，默认情况下 public 是默认的只读密码；为了更加安全可以配置其他的只读密码，并指定某些特定的 IP 才能访问这个节点。这个策略在 Windows 的觉策略中很容易实现，或者说建议使用域控制器来管理这个策略，比较方便。假定 OpenNMS 能访问该节点的 snmp 服务的情况下。这些数据会增加：SNMP Attributes；在选择了资源图后，可以看到 snmp 的节点数据和接口数据。进入后可以看到，其实收集 的是一个 tcp／ip 接口上基本的信息：流量，连接数，丢包，错包等。个人认为流量是个最有用的数据，特别是对于一些简单的 web/ftp 服务器也就够用了。&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->第三种情况：&lt;!-- raw HTML omitted -->我们需要监控到操作系统的性能数据 cpu/disk/RAM 等。就需要安装一个 snmp 代理，这个代理可以提供这些信息，opennms 才能通过 snmp 协议收集这些数据。需要到下面网址下载一个免费的 snmp 代理，当然这个产品也有收费版本：http://www.wtcs.org/informant/download.htm 这个代理很小需要在 windows 机器上安装一下。默认情况下 OpenNMS 的对 windows 采集模板中包含了对 cpu/disk/ram 等数据的采集，等到下一次 OpenNMS 在采集这个机器的时候相关数据就会被显示在节点 snmp 数据下面。&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->这里是通过这个免费的 snmp 代理能采集到的数据：&lt;!-- raw HTML omitted -->/Program Files/SNMP Informant/standard/mibs/informant-std-tree.txt&lt;!-- raw HTML omitted -->&amp;ndash;standard(1.3.6.1.4.1.9600.1.1)&lt;!-- raw HTML omitted -->|&lt;!-- raw HTML omitted -->+&amp;ndash;logicalDiskTable(1)&lt;!-- raw HTML omitted -->| |&lt;!-- raw HTML omitted -->| +&amp;ndash;logicalDiskEntry(1) [lDiskInstance]&lt;!-- raw HTML omitted -->| |&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n InstanceName lDiskInstance(1)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskPercentDiskReadTime(2)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskPercentDiskTime(3)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskPercentDiskWriteTime(4)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskPercentFreeSpace(5)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskPercentIdleTime(6)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskAvgDiskQueueLength(7)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskAvgDiskReadQueueLength(8)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskAvgDiskWriteQueueLength(9)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskAvgDiskSecPerRead(10)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskAvgDiskSecPerTransfer(11)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskAvgDiskSecPerWrite(12)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskCurrentDiskQueueLength(13)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskDiskBytesPerSec(14)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskDiskReadBytesPerSec(15)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskDiskReadsPerSec(16)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskDiskTransfersPerSec(17)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskDiskWriteBytesPerSec(18)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskDiskWritesPerSec(19)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskFreeMegabytes(20)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 lDiskSplitIOPerSec(21)&lt;!-- raw HTML omitted -->|&lt;!-- raw HTML omitted -->+&amp;ndash;memory(2)&lt;!-- raw HTML omitted -->| |&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryAvailableBytes(1)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryAvailableKBytes(2)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryAvailableMBytes(3)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryCommittedBytes(4)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryCacheBytes(5)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryCacheBytesPeak(6)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryPageFaultsPerSec(7)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryPagesInputPerSec(8)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryPagesOutputPerSec(9)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryPagesPerSec(10)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryPoolNonpagedBytes(11)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryPoolPagedBytes(12)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memoryPoolPagedResidentBytes(13)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memorySystemCacheResidentBytes(14)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memorySystemCodeResidentBytes(15)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memorySystemCodeTotalBytes(16)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memorySystemDriverResidentBytes(17)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 memorySystemDriverTotalBytes(18)&lt;!-- raw HTML omitted -->|&lt;!-- raw HTML omitted -->+&amp;ndash;networkInterfaceTable(3)&lt;!-- raw HTML omitted -->| |&lt;!-- raw HTML omitted -->| +&amp;ndash;networkInterfaceEntry(1) [netInstance]&lt;!-- raw HTML omitted -->| |&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n InstanceName netInstance(1)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netBytesReceivedPerSec(2)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netBytesSentPerSec(3)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netBytesTotalPerSec(4)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netCurrentBandwidth(5)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netOutputQueueLength(6)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netPacketsOutboundDiscarded(7)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netPacketsOutboundErrors(8)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netPacketsReceivedDiscarded(9)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netPacketsReceivedErrors(10)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netPacketsReceivedUnknown(11)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netPacketsReceivedPerSec(12)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netPacketsSentPerSec(13)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 netPacketsPerSec(14)&lt;!-- raw HTML omitted -->|&lt;!-- raw HTML omitted -->+&amp;ndash;objects(4)&lt;!-- raw HTML omitted -->| |&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 objectsProcesses(1)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 objectsThreads(2)&lt;!-- raw HTML omitted -->|&lt;!-- raw HTML omitted -->+&amp;ndash;processorTable(5)&lt;!-- raw HTML omitted -->| |&lt;!-- raw HTML omitted -->| +&amp;ndash;processorEntry(1) [cpuInstance]&lt;!-- raw HTML omitted -->| |&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n InstanceName cpuInstance(1)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 cpuPercentDPCTime(2)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 cpuPercentInterruptTime(3)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 cpuPercentPrivilegedTime(4)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 cpuPercentProcessorTime(5)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 cpuPercentUserTime(6)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 cpuAPCBypassesPerSec(7)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 cpuDPCBypassesPerSec(8)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 cpuDPCRate(9)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 cpuDPCsQueuedPerSec(10)&lt;!-- raw HTML omitted -->| +&amp;ndash; r-n Gauge32 cpuInterruptsPerSec(11)&lt;!-- raw HTML omitted -->|&lt;!-- raw HTML omitted -->+&amp;ndash;system(6)&lt;!-- raw HTML omitted -->|&lt;!-- raw HTML omitted -->+&amp;ndash; r-n Gauge32 systemSystemUpTime(1)&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->最后记得在看看这个许可证文件：&lt;!-- raw HTML omitted -->Program Files/SNMP Informant/standard/license.txt&lt;!-- raw HTML omitted -->LICENSE.TXT&lt;!-- raw HTML omitted -->&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;&lt;!-- raw HTML omitted -->FREE OF CHARGE SOFTWARE PROGRAM LICENSE AGREEMENT for&lt;!-- raw HTML omitted -->SNMP INFORMANT STANDARD EDITION (The Software)&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&lt;!-- raw HTML omitted -->Copyright(c) 2005, Informant Systems, Inc. (&lt;a class="link" href="https://www.informant-systems.com" target="_blank" rel="noopener"
>www.informant-systems.com&lt;/a>), and&lt;!-- raw HTML omitted -->Copyright(c) 2003-2005, Williams Technology Consulting Services (&lt;a class="link" href="https://www.wtcs.org" target="_blank" rel="noopener"
>www.wtcs.org&lt;/a>)&lt;!-- raw HTML omitted -->&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&lt;!-- raw HTML omitted -->Product names used in this document are trademarks of their respective owners.&lt;!-- raw HTML omitted -->* IMPORTANT-PLEASE READ CAREFULLY BEFORE INSTALLING THE SOFTWARE.&lt;!-- raw HTML omitted -->&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&lt;!-- raw HTML omitted -->后面略&amp;hellip;.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->在安装了 snmp 代理之后，我们可以看到 OpenNMS 可以帮助我们完成 windows 服务器的可用性和性能管理。&lt;/p></description></item></channel></rss>
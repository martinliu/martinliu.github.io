<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="测试环境说明 我的笔记本电脑的环境描述如下。\nOS MacBook Pro 2011 版， 2.3 GHz Intel Core i5， 8GB DDR3， 256 GB SSD。 OS X EI Capitan version 10.11.5\nDocker Docker for Mac Version 1.12.0-rc2-beta17 (build: 9779)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 $ docker version Client: Version: 1.12.0-rc2 API version: 1.24 Go version: go1.6.2 Git commit: 906eacd Built: Fri Jun 17 20:35:33 2016 OS/Arch: darwin/amd64 Experimental: true Server: Version: 1.12.0-rc2 API version: 1.24 Go version: go1.6.2 Git commit: a7119de Built: Wed Jun 29 10:03:33 2016 OS/Arch: linux/amd64 Experimental: true $ docker-machine version docker-machine version 0.8.0-rc1, build fffa6c9 martin@localhost ~/Documents [9:38:31] $ docker-compose version docker-compose version 1.8.0-rc1, build 9bf6bc6 docker-py version: 1.8.1 CPython version: 2.7.9 OpenSSL version: OpenSSL 1.0.2h 3 May 2016 VirtualBox version 5.0.22r108108\n"><title>DevOps 的起点-入手微型数据中心</title><link rel=canonical href=https://martinliu.cn/2016/07/01/devops-in-a-box/><link rel=stylesheet href=/scss/style.min.6cdf49b1ce11fdcb5b101472ec608dcfd7395a19af16339a150cd1a4536b6113.css><meta property='og:title' content="DevOps 的起点-入手微型数据中心"><meta property='og:description' content="测试环境说明 我的笔记本电脑的环境描述如下。\nOS MacBook Pro 2011 版， 2.3 GHz Intel Core i5， 8GB DDR3， 256 GB SSD。 OS X EI Capitan version 10.11.5\nDocker Docker for Mac Version 1.12.0-rc2-beta17 (build: 9779)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 $ docker version Client: Version: 1.12.0-rc2 API version: 1.24 Go version: go1.6.2 Git commit: 906eacd Built: Fri Jun 17 20:35:33 2016 OS/Arch: darwin/amd64 Experimental: true Server: Version: 1.12.0-rc2 API version: 1.24 Go version: go1.6.2 Git commit: a7119de Built: Wed Jun 29 10:03:33 2016 OS/Arch: linux/amd64 Experimental: true $ docker-machine version docker-machine version 0.8.0-rc1, build fffa6c9 martin@localhost ~/Documents [9:38:31] $ docker-compose version docker-compose version 1.8.0-rc1, build 9bf6bc6 docker-py version: 1.8.1 CPython version: 2.7.9 OpenSSL version: OpenSSL 1.0.2h 3 May 2016 VirtualBox version 5.0.22r108108\n"><meta property='og:url' content='https://martinliu.cn/2016/07/01/devops-in-a-box/'><meta property='og:site_name' content="Martin Liu's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='docker'><meta property='article:tag' content='Habitat'><meta property='article:tag' content='rancher'><meta property='article:published_time' content='2016-07-01T03:11:10+00:00'><meta property='article:modified_time' content='2022-10-09T21:44:15+08:00'><meta property='og:image' content='https://martinliu.cn/img/avatar.png'><meta name=twitter:title content="DevOps 的起点-入手微型数据中心"><meta name=twitter:description content="测试环境说明 我的笔记本电脑的环境描述如下。\nOS MacBook Pro 2011 版， 2.3 GHz Intel Core i5， 8GB DDR3， 256 GB SSD。 OS X EI Capitan version 10.11.5\nDocker Docker for Mac Version 1.12.0-rc2-beta17 (build: 9779)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 $ docker version Client: Version: 1.12.0-rc2 API version: 1.24 Go version: go1.6.2 Git commit: 906eacd Built: Fri Jun 17 20:35:33 2016 OS/Arch: darwin/amd64 Experimental: true Server: Version: 1.12.0-rc2 API version: 1.24 Go version: go1.6.2 Git commit: a7119de Built: Wed Jun 29 10:03:33 2016 OS/Arch: linux/amd64 Experimental: true $ docker-machine version docker-machine version 0.8.0-rc1, build fffa6c9 martin@localhost ~/Documents [9:38:31] $ docker-compose version docker-compose version 1.8.0-rc1, build 9bf6bc6 docker-py version: 1.8.1 CPython version: 2.7.9 OpenSSL version: OpenSSL 1.0.2h 3 May 2016 VirtualBox version 5.0.22r108108\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://martinliu.cn/img/avatar.png'><script async src="https://www.googletagmanager.com/gtag/js?id=G-30EQ6H78E5"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-30EQ6H78E5")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_3effc2c05c79978f.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Martin Liu's Blog</a></h1><h2 class=site-description>Founder of DevOps China</h2></div></header><ol class=menu-social><li><a href=https://github.com/martinliu/ target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/liuzheng/ target=_blank title=LinkedIn rel=me><svg viewBox="0 0 32 32" width="32" height="32"><path d="M7.5 5C6.132813 5 5 6.132813 5 7.5v17C5 25.867188 6.132813 27 7.5 27h17c1.367188.0 2.5-1.132812 2.5-2.5V7.5C27 6.132813 25.867188 5 24.5 5zm0 2h17C24.785156 7 25 7.214844 25 7.5v17C25 24.785156 24.785156 25 24.5 25H7.5C7.214844 25 7 24.785156 7 24.5V7.5c0-.285156.214844-.5.5-.5zm2.9375 1.71875C9.488281 8.71875 8.71875 9.488281 8.71875 10.4375S9.488281 12.15625 10.4375 12.15625 12.15625 11.386719 12.15625 10.4375 11.386719 8.71875 10.4375 8.71875zm9.03125 4.5625c-1.433594.0-2.386719.785156000000001-2.78125 1.53125H16.625V13.5H13.8125V23H16.75V18.3125C16.75 17.074219 16.996094 15.875 18.53125 15.875c1.511719.0 1.53125 1.398438 1.53125 2.5V23H23V17.78125c0-2.554687-.542968999999999-4.5-3.53125-4.5zM9 13.5V23h2.96875V13.5z"/></svg></a></li><li><a href=https://twitter.com/martinliu target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>首页</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg>
<span>关于</span></a></li><li><a href=/course/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>课程</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>链接</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://martinliu.cn/ selected>中文</option><option value=https://martinliu.cn/en/>English</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#测试环境说明>测试环境说明</a><ol><li><a href=#os>OS</a></li><li><a href=#docker>Docker</a></li><li><a href=#本机下载的-docker-镜像>本机下载的 Docker 镜像</a></li><li><a href=#本机下载的代码>本机下载的代码</a></li></ol></li><li><a href=#创建-rancher-服务器>创建 Rancher 服务器</a><ol><li><a href=#生成虚拟机>生成虚拟机</a></li><li><a href=#导入-rancher-服务器镜像>导入 Rancher 服务器镜像</a></li></ol></li><li><a href=#容器运行节点-rancher-agent-节点>容器运行节点 Rancher Agent 节点</a><ol><li><a href=#创建-node1-虚拟机>创建 node1 虚拟机</a></li><li><a href=#加载-rancher-agent-的镜像>加载 Rancher Agent 的镜像</a></li><li><a href=#添加-node1-节点到-rancher-server>添加 node1 节点到 Rancher Server。</a></li></ol></li><li><a href=#调试-habitat-的测试程序>调试 habitat 的测试程序</a><ol><li><a href=#安装-hab>安装 hab</a></li><li><a href=#配置-hab-cli>配置 hab cli</a></li><li><a href=#调试-habitat-demo-应用>调试 Habitat demo 应用</a></li><li><a href=#build-habitat-demo-代码>build habitat demo 代码</a></li><li><a href=#昨晚分享的高潮部分-habitat-导出-docker-image>昨晚分享的高潮部分, habitat 导出 docker image</a></li><li><a href=#运行这个-demo>运行这个 demo</a></li><li><a href=#在-rancher-中上架这个-demo>在 rancher 中上架这个 demo</a></li><li><a href=#测试-rancher-官方的-redis-demo>测试 Rancher 官方的 redis demo</a></li></ol></li><li><a href=#福利调试-docker-官方投票应用>福利：调试 docker 官方投票应用</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/opensource/ style=background-color:#2a9d8f;color:#fff>开源</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/2016/07/01/devops-in-a-box/>DevOps 的起点-入手微型数据中心</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2016-07-01, Friday</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 10 分钟</time></div></footer></div></header><section class=article-content><h2 id=测试环境说明>测试环境说明</h2><p>我的笔记本电脑的环境描述如下。</p><h3 id=os>OS</h3><p>MacBook Pro 2011 版， 2.3 GHz Intel Core i5， 8GB DDR3， 256 GB SSD。 OS X EI Capitan version 10.11.5</p><h3 id=docker>Docker</h3><p>Docker for Mac Version 1.12.0-rc2-beta17 (build: 9779)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ docker version
</span></span><span class=line><span class=cl>Client:
</span></span><span class=line><span class=cl> Version:      1.12.0-rc2
</span></span><span class=line><span class=cl> API version:  1.24
</span></span><span class=line><span class=cl> Go version:   go1.6.2
</span></span><span class=line><span class=cl> Git commit:   906eacd
</span></span><span class=line><span class=cl> Built:        Fri Jun 17 20:35:33 2016
</span></span><span class=line><span class=cl> OS/Arch:      darwin/amd64
</span></span><span class=line><span class=cl> Experimental: true
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Server:
</span></span><span class=line><span class=cl> Version:      1.12.0-rc2
</span></span><span class=line><span class=cl> API version:  1.24
</span></span><span class=line><span class=cl> Go version:   go1.6.2
</span></span><span class=line><span class=cl> Git commit:   a7119de
</span></span><span class=line><span class=cl> Built:        Wed Jun 29 10:03:33 2016
</span></span><span class=line><span class=cl> OS/Arch:      linux/amd64
</span></span><span class=line><span class=cl> Experimental: true
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  $ docker-machine version
</span></span><span class=line><span class=cl>docker-machine version 0.8.0-rc1, build fffa6c9
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>martin@localhost ~/Documents                                                                                  [9:38:31]
</span></span><span class=line><span class=cl> $ docker-compose version
</span></span><span class=line><span class=cl>docker-compose version 1.8.0-rc1, build 9bf6bc6
</span></span><span class=line><span class=cl>docker-py version: 1.8.1
</span></span><span class=line><span class=cl>CPython version: 2.7.9
</span></span><span class=line><span class=cl>OpenSSL version: OpenSSL 1.0.2h  3 May 2016
</span></span></code></pre></td></tr></table></div></div><p>VirtualBox version 5.0.22r108108</p><h3 id=本机下载的-docker-镜像>本机下载的 Docker 镜像</h3><p>/Users/martin/Downloads/1.12.0-rc2/boot2docker.iso</p><p>~/Downloads/rancher-all/rancher-agent-v1.0.1.tar</p><p>~/Downloads/rancher-all/rancher-agent-instance-v0.8.1.tar</p><p>~/Downloads/habitat-docker-registry.bintray.io-studio.tar</p><p>~/Downloads/rancher-all/rancher-server-stable.tar</p><p>我本机还有一个 Docker Registry 的 vm，这里面提供了我需要积累以后用的镜像存储，想象一下你在飞机上的时候去哪里拉取镜像 ：）</p><h3 id=本机下载的代码>本机下载的代码</h3><p><a class=link href=https://github.com/habitat-sh/habitat-example-plans target=_blank rel=noopener>https://github.com/habitat-sh/habitat-example-plans</a> <a class=link href=https://github.com/janeczku/habitat-plans target=_blank rel=noopener>https://github.com/janeczku/habitat-plans</a> <a class=link href=https://github.com/chrisurwin/may2016-demo target=_blank rel=noopener>https://github.com/chrisurwin/may2016-demo</a> <a class=link href=https://github.com/docker/example-voting-app target=_blank rel=noopener>https://github.com/docker/example-voting-app</a></p><p>注意以上代码可能需要修改才能在本机调试成功。</p><h2 id=创建-rancher-服务器>创建 Rancher 服务器</h2><h3 id=生成虚拟机>生成虚拟机</h3><p>用 docker-machine 创建 rancher 服务器。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>docker</span><span class=o>-</span><span class=n>machine</span> <span class=n>create</span> <span class=n>rancher</span> <span class=o>--</span><span class=n>driver</span> <span class=n>virtualbox</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>cpu</span><span class=o>-</span><span class=n>count</span> <span class=s2>&#34;1&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>disk</span><span class=o>-</span><span class=n>size</span> <span class=s2>&#34;8000&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>memory</span> <span class=s2>&#34;1024&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>boot2docker</span><span class=o>-</span><span class=n>url</span><span class=o>=/</span><span class=n>Users</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>Downloads</span><span class=o>/</span><span class=mf>1.12</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=n>rc2</span><span class=o>/</span><span class=n>boot2docker</span><span class=o>.</span><span class=n>iso</span> <span class=o>&amp;&amp;</span> <span class=n>eval</span> <span class=o>$</span><span class=p>(</span><span class=n>docker</span><span class=o>-</span><span class=n>machine</span> <span class=n>env</span> <span class=n>rancher</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=导入-rancher-服务器镜像>导入 Rancher 服务器镜像</h3><p>用 docker-machine ls 应该看到 rancher 这个节点打了星号。否则 docker 命令会执行失败或者错误。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>docker</span> <span class=nb>load</span> <span class=o>&lt;</span> <span class=o>~/</span><span class=n>Downloads</span><span class=o>/</span><span class=n>rancher</span><span class=o>-</span><span class=n>all</span><span class=o>/</span><span class=n>rancher</span><span class=o>-</span><span class=n>server</span><span class=o>-</span><span class=n>stable</span><span class=o>.</span><span class=n>tar</span>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=n>run</span> <span class=o>-</span><span class=n>d</span> <span class=o>--</span><span class=n>restart</span><span class=o>=</span><span class=n>always</span> <span class=o>--</span><span class=n>name</span> <span class=n>rancher</span><span class=o>-</span><span class=n>srv</span> <span class=o>-</span><span class=n>p</span> <span class=mi>8080</span><span class=p>:</span><span class=mi>8080</span> <span class=n>rancher</span><span class=o>/</span><span class=n>server</span><span class=p>:</span><span class=n>stable</span>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=n>logs</span> <span class=o>-</span><span class=n>f</span> <span class=n>rancher</span><span class=o>-</span><span class=n>srv</span>
</span></span></code></pre></td></tr></table></div></div><p>查看 rancher 服务器的 ip 地址。 docker-machine ip rancher</p><p>用浏览器打开 Rancher 服务器的登录页面。 open http://Rancher_Server_IP:8080</p><p>下面是一些如何让虚拟机保持固定 IP 和 rancher 容器存储的数据持久存在的代码，我没有测试成功，留下大家一起搞，成功了，给我一个回复。另外还有关于稿 jekins 和 mirror 的代码。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>echo</span> <span class=s2>&#34;ifconfig eth1 192.168.99.60 netmask 255.255.255.0 broadcast 192.168.99.255 up&#34;</span> <span class=o>|</span> <span class=n>docker</span><span class=o>-</span><span class=n>machine</span> <span class=n>ssh</span> <span class=n>node1</span> <span class=n>sudo</span> <span class=n>tee</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>boot2docker</span><span class=o>/</span><span class=n>bootsync</span><span class=o>.</span><span class=n>sh</span> <span class=o>&gt;</span> <span class=o>/</span><span class=n>dev</span><span class=o>/</span><span class=n>null</span>
</span></span><span class=line><span class=cl><span class=n>docker</span><span class=o>-</span><span class=n>machine</span> <span class=n>regenerate</span><span class=o>-</span><span class=n>certs</span> <span class=n>node1</span> <span class=o>-</span><span class=n>f</span>
</span></span><span class=line><span class=cl><span class=n>docker</span><span class=o>-</span><span class=n>machine</span> <span class=n>ssh</span> <span class=n>ndoe1</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>mkdir</span> <span class=o>/</span><span class=n>mnt</span><span class=o>/</span><span class=n>sda1</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>rancher</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docker</span><span class=err>@</span><span class=n>node1</span><span class=p>:</span><span class=o>/</span><span class=n>mnt</span><span class=o>/</span><span class=n>sda1</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>boot2docker</span><span class=o>$</span> <span class=n>cat</span> <span class=n>bootsync</span><span class=o>.</span><span class=n>sh</span>
</span></span><span class=line><span class=cl><span class=n>ifconfig</span> <span class=n>eth1</span> <span class=mf>192.168</span><span class=o>.</span><span class=mf>99.60</span> <span class=n>netmask</span> <span class=mf>255.255</span><span class=o>.</span><span class=mf>255.0</span> <span class=n>broadcast</span> <span class=mf>192.168</span><span class=o>.</span><span class=mf>99.255</span> <span class=n>up</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>mkdir</span> <span class=o>/</span><span class=n>mnt</span><span class=o>/</span><span class=n>sda1</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>rancher</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>ln</span> <span class=o>-</span><span class=n>s</span> <span class=o>/</span><span class=n>mnt</span><span class=o>/</span><span class=n>sda1</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>rancher</span><span class=o>/</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=nb>load</span> <span class=o>&lt;</span> <span class=o>~/</span><span class=n>Downloads</span><span class=o>/</span><span class=n>rancher</span><span class=o>-</span><span class=n>all</span><span class=o>/</span><span class=n>jenkins</span><span class=o>.</span><span class=n>tar</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=n>run</span> <span class=o>-</span><span class=n>d</span> <span class=o>--</span><span class=n>name</span> <span class=n>jekins</span> <span class=o>--</span><span class=n>privileged</span> <span class=o>-</span><span class=n>p</span> <span class=mi>9001</span><span class=p>:</span><span class=mi>8080</span> <span class=o>-</span><span class=n>v</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>docker</span><span class=o>/</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>docker</span><span class=o>/</span> <span class=o>-</span><span class=n>v</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>docker</span><span class=o>.</span><span class=n>sock</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>docker</span><span class=o>.</span><span class=n>sock</span> <span class=o>-</span><span class=n>v</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>docker</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>docker</span>  <span class=o>-</span><span class=n>v</span> <span class=o>/</span><span class=n>lib64</span><span class=o>/</span><span class=n>libdevmapper</span><span class=o>.</span><span class=n>so</span><span class=o>.</span><span class=mf>1.02</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>libdevmapper</span><span class=o>.</span><span class=n>so</span><span class=o>.</span><span class=mf>1.02</span>  <span class=o>--</span><span class=n>label</span> <span class=n>io</span><span class=o>.</span><span class=n>rancher</span><span class=o>.</span><span class=n>container</span><span class=o>.</span><span class=n>network</span><span class=o>=</span><span class=bp>true</span> <span class=n>jenkins</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docker</span><span class=o>-</span><span class=n>machine</span> <span class=n>create</span> <span class=n>mirror</span> <span class=o>--</span><span class=n>driver</span> <span class=n>virtualbox</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>cpu</span><span class=o>-</span><span class=n>count</span> <span class=s2>&#34;1&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>disk</span><span class=o>-</span><span class=n>size</span> <span class=s2>&#34;8000&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>memory</span> <span class=s2>&#34;512&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>boot2docker</span><span class=o>-</span><span class=n>url</span><span class=o>=/</span><span class=n>Users</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>Downloads</span><span class=o>/</span><span class=n>boot2docker</span><span class=o>.</span><span class=n>iso</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=nb>load</span> <span class=o>&lt;</span> <span class=o>~/</span><span class=n>Downloads</span><span class=o>/</span><span class=n>rancher</span><span class=o>-</span><span class=n>all</span><span class=o>/</span><span class=n>registry</span><span class=o>.</span><span class=n>tar</span>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=n>run</span> <span class=o>-</span><span class=n>d</span> <span class=o>-</span><span class=n>p</span> <span class=mi>80</span><span class=p>:</span><span class=mi>5000</span> <span class=o>--</span><span class=n>restart</span><span class=o>=</span><span class=n>always</span> <span class=o>--</span><span class=n>name</span> <span class=n>registry</span> <span class=n>registry</span><span class=p>:</span><span class=mi>2</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=容器运行节点-rancher-agent-节点>容器运行节点 Rancher Agent 节点</h2><h3 id=创建-node1-虚拟机>创建 node1 虚拟机</h3><p>使用 docker-machine 命令创建容器运行节点。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>docker</span><span class=o>-</span><span class=n>machine</span> <span class=n>create</span> <span class=n>node1</span> <span class=o>--</span><span class=n>driver</span> <span class=n>virtualbox</span> <span class=o>--</span><span class=n>engine</span><span class=o>-</span><span class=n>insecure</span><span class=o>-</span><span class=n>registry</span> <span class=mf>192.168</span><span class=o>.</span><span class=mf>99.20</span><span class=p>:</span><span class=mi>5000</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>cpu</span><span class=o>-</span><span class=n>count</span> <span class=s2>&#34;1&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>disk</span><span class=o>-</span><span class=n>size</span> <span class=s2>&#34;80000&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>memory</span> <span class=s2>&#34;1024&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>boot2docker</span><span class=o>-</span><span class=n>url</span><span class=o>=/</span><span class=n>Users</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>Downloads</span><span class=o>/</span><span class=mf>1.12</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=n>rc2</span><span class=o>/</span><span class=n>boot2docker</span><span class=o>.</span><span class=n>iso</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docker</span><span class=o>-</span><span class=n>machine</span> <span class=n>create</span> <span class=n>node2</span> <span class=o>--</span><span class=n>driver</span> <span class=n>virtualbox</span> <span class=o>--</span><span class=n>engine</span><span class=o>-</span><span class=n>insecure</span><span class=o>-</span><span class=n>registry</span> <span class=mf>192.168</span><span class=o>.</span><span class=mf>99.20</span><span class=p>:</span><span class=mi>5000</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>cpu</span><span class=o>-</span><span class=n>count</span> <span class=s2>&#34;1&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>disk</span><span class=o>-</span><span class=n>size</span> <span class=s2>&#34;80000&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>memory</span> <span class=s2>&#34;1024&#34;</span> <span class=o>--</span><span class=n>virtualbox</span><span class=o>-</span><span class=n>boot2docker</span><span class=o>-</span><span class=n>url</span><span class=o>=/</span><span class=n>Users</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>Downloads</span><span class=o>/</span><span class=mf>1.12</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=n>rc2</span><span class=o>/</span><span class=n>boot2docker</span><span class=o>.</span><span class=n>iso</span>
</span></span></code></pre></td></tr></table></div></div><p>在 node1 或者 node2 测试运行一个容器，使用 mirror 中的 busybox 镜像。如果你的笔记本内存小于 8GB 的话，node2 就别搞了。一个 node 也够用了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker pull 192.168.99.20:5000/busybox:latest
</span></span></code></pre></td></tr></table></div></div><p>docker run 一下这个镜像，验证 node1 工作正常。</p><h3 id=加载-rancher-agent-的镜像>加载 Rancher Agent 的镜像</h3><p>确保 node1 是 docker-machine ls 中打星号的。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>docker</span> <span class=nb>load</span> <span class=o>&lt;</span> <span class=o>~/</span><span class=n>Downloads</span><span class=o>/</span><span class=n>rancher</span><span class=o>-</span><span class=n>all</span><span class=o>/</span><span class=n>rancher</span><span class=o>-</span><span class=n>agent</span><span class=o>-</span><span class=n>v1</span><span class=o>.</span><span class=mf>0.1</span><span class=o>.</span><span class=n>tar</span>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=nb>load</span> <span class=o>&lt;</span> <span class=o>~/</span><span class=n>Downloads</span><span class=o>/</span><span class=n>rancher</span><span class=o>-</span><span class=n>all</span><span class=o>/</span><span class=n>rancher</span><span class=o>-</span><span class=n>agent</span><span class=o>-</span><span class=n>instance</span><span class=o>-</span><span class=n>v0</span><span class=o>.</span><span class=mf>8.1</span><span class=o>.</span><span class=n>tar</span>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=nb>load</span> <span class=o>&lt;</span> <span class=o>~/</span><span class=n>Downloads</span><span class=o>/</span><span class=n>habitat</span><span class=o>-</span><span class=n>docker</span><span class=o>-</span><span class=n>registry</span><span class=o>.</span><span class=n>bintray</span><span class=o>.</span><span class=n>io</span><span class=o>-</span><span class=n>studio</span><span class=o>.</span><span class=n>tar</span>
</span></span></code></pre></td></tr></table></div></div><p>你翻墙下载回来的 habitat-docker-registry.bintray.io/studio 镜像可能需要打标签，否则回头 hab 命令执行失败。 先用 docer images 看下是否所有 image 的标签信息正确。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker tag fc27342e5e0e habitat-docker-registry.bintray.io/studio:latest
</span></span></code></pre></td></tr></table></div></div><h3 id=添加-node1-节点到-rancher-server>添加 node1 节点到 Rancher Server。</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>docker</span> <span class=n>run</span> <span class=o>-</span><span class=n>d</span> <span class=o>--</span><span class=n>privileged</span> <span class=o>-</span><span class=n>v</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>docker</span><span class=o>.</span><span class=n>sock</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>docker</span><span class=o>.</span><span class=n>sock</span> <span class=o>-</span><span class=n>v</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>rancher</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>rancher</span> <span class=n>rancher</span><span class=o>/</span><span class=n>agent</span><span class=p>:</span><span class=n>v1</span><span class=o>.</span><span class=mf>0.1</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>192.168</span><span class=o>.</span><span class=mf>99.100</span><span class=p>:</span><span class=mi>8080</span><span class=o>/</span><span class=n>v1</span><span class=o>/</span><span class=n>scripts</span><span class=o>/</span><span class=mi>33</span><span class=n>B68ED65CEF18F6D7BD</span><span class=p>:</span><span class=mi>1466694000000</span><span class=p>:</span><span class=n>lug2KswoXOOQV4d09ZNMGTphVs0</span>
</span></span></code></pre></td></tr></table></div></div><p>现在在 Hosts 页面上应该能看到该刚创建的节点。在页面上创建一个最小化的容器（如 busybox），来拉起 Network Agent 容器。</p><h2 id=调试-habitat-的测试程序>调试 habitat 的测试程序</h2><p>参考的文档 <a class=link href=https://www.habitat.sh/tutorials/ target=_blank rel=noopener>https://www.habitat.sh/tutorials/</a> 记得一定要把这一组文章先看完，在去调试它的代码，不懂这些基本概念的话，后面对了错了都不知道该怎么搞。</p><p>前置条件，翻墙下载 habitat studio 的 docker image 镜像，load 到 node1 上，下面的所有测试都是在 node1 上完成的。</p><h3 id=安装-hab>安装 hab</h3><p>habitat 的程序只有一个可执行程序， 目前支持 mac 和 linux 版本。下载地址： <a class=link href=https://www.habitat.sh/docs/get-habitat target=_blank rel=noopener>https://www.habitat.sh/docs/get-habitat</a> 就是一个 tag 包，解压缩后放到 shell 的 PATH 里面就安装完了。</p><h3 id=配置-hab-cli>配置 hab cli</h3><p>运行 hab setup</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=n>martin</span><span class=o>@</span><span class=n>localhost</span><span class=w> </span><span class=o>~/</span><span class=n>Documents</span><span class=w>                                                                                  </span><span class=err>$</span><span class=w> </span><span class=n>hab</span><span class=w> </span><span class=n>setup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Habitat</span><span class=w> </span><span class=n>CLI</span><span class=w> </span><span class=n>Setup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>=================</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Welcome</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>hab</span><span class=w> </span><span class=n>setup</span><span class=p>.</span><span class=w> </span><span class=n>Let</span><span class=s1>&#39;s get started.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Set up a default origin
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>  Every package in Habitat belongs to an origin, which indicates the
</span></span></span><span class=line><span class=cl><span class=s1>  person or organization responsible for maintaining that package. Each
</span></span></span><span class=line><span class=cl><span class=s1>  origin also has a key used to cryptographically sign packages in that
</span></span></span><span class=line><span class=cl><span class=s1>  origin.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>  Selecting a default origin tells package building operations such as
</span></span></span><span class=line><span class=cl><span class=s1>  &#39;</span><span class=n>hab</span><span class=w> </span><span class=n>pkg</span><span class=w> </span><span class=n>build</span><span class=s1>&#39; what key should be used to sign the packages produced.
</span></span></span><span class=line><span class=cl><span class=s1>  If you do not set a default origin now, you will have to tell package
</span></span></span><span class=line><span class=cl><span class=s1>  building commands each time what origin to use.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>  For more information on origins and how they are used in building
</span></span></span><span class=line><span class=cl><span class=s1>  packages, please consult the docs at
</span></span></span><span class=line><span class=cl><span class=s1>  https://www.habitat.sh/docs/build-packages-overview/
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Set up a default origin? [Yes/no/quit] yes 这里输入 yes
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>  Enter the name of your origin. If you plan to publish your packages
</span></span></span><span class=line><span class=cl><span class=s1>  publicly, we recommend that you select one that is not already in use on
</span></span></span><span class=line><span class=cl><span class=s1>  the Habitat build service found at https://app.habitat.sh/.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>  You already have a default origin set up as `martin&#39;</span><span class=p>,</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=n>feel</span><span class=w> </span><span class=n>free</span><span class=w> </span><span class=k>to</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>change</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>you</span><span class=w> </span><span class=n>wish</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Default</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=k>default</span><span class=p>:</span><span class=w> </span><span class=n>martin</span><span class=p>]</span><span class=w> </span><span class=err>这是用来做</span><span class=w> </span><span class=n>Habitat</span><span class=w> </span><span class=err>包签名和加密用的标识，在代码里面会用到。</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>You</span><span class=w> </span><span class=n>already</span><span class=w> </span><span class=n>have</span><span class=w> </span><span class=n>an</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=k>key</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>martin</span><span class=w> </span><span class=n>created</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>installed</span><span class=p>.</span><span class=w> </span><span class=n>Great</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>work</span><span class=o>!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>GitHub</span><span class=w> </span><span class=n>Access</span><span class=w> </span><span class=n>Token</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>While</span><span class=w> </span><span class=n>you</span><span class=w> </span><span class=n>can</span><span class=w> </span><span class=n>build</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>run</span><span class=w> </span><span class=n>Habitat</span><span class=w> </span><span class=n>packages</span><span class=w> </span><span class=n>without</span><span class=w> </span><span class=n>sharing</span><span class=w> </span><span class=n>them</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>the</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>public</span><span class=w> </span><span class=n>depot</span><span class=p>,</span><span class=w> </span><span class=n>doing</span><span class=w> </span><span class=n>so</span><span class=w> </span><span class=n>allows</span><span class=w> </span><span class=n>you</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>collaborate</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>Habitat</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>community</span><span class=p>.</span><span class=w> </span><span class=k>In</span><span class=w> </span><span class=n>addition</span><span class=p>,</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>how</span><span class=w> </span><span class=n>you</span><span class=w> </span><span class=n>can</span><span class=w> </span><span class=n>perform</span><span class=w> </span><span class=n>continuous</span><span class=w> </span><span class=n>deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>with</span><span class=w> </span><span class=n>Habitat</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>The</span><span class=w> </span><span class=n>depot</span><span class=w> </span><span class=n>uses</span><span class=w> </span><span class=n>GitHub</span><span class=w> </span><span class=n>authentication</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=n>an</span><span class=w> </span><span class=n>access</span><span class=w> </span><span class=nf>token</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>(</span><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>help</span><span class=p>.</span><span class=n>github</span><span class=p>.</span><span class=n>com</span><span class=o>/</span><span class=n>articles</span><span class=o>/</span><span class=n>creating</span><span class=o>-</span><span class=n>an</span><span class=o>-</span><span class=n>access</span><span class=o>-</span><span class=n>token</span><span class=o>-</span><span class=k>for</span><span class=o>-</span><span class=n>command</span><span class=o>-</span><span class=n>line</span><span class=o>-</span><span class=k>use</span><span class=o>/</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>If</span><span class=w> </span><span class=n>you</span><span class=w> </span><span class=n>would</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>share</span><span class=w> </span><span class=n>your</span><span class=w> </span><span class=n>packages</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>depot</span><span class=p>,</span><span class=w> </span><span class=n>please</span><span class=w> </span><span class=n>enter</span><span class=w> </span><span class=n>your</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>GitHub</span><span class=w> </span><span class=n>access</span><span class=w> </span><span class=n>token</span><span class=p>.</span><span class=w> </span><span class=n>Otherwise</span><span class=p>,</span><span class=w> </span><span class=n>just</span><span class=w> </span><span class=n>enter</span><span class=w> </span><span class=n>No</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>For</span><span class=w> </span><span class=n>more</span><span class=w> </span><span class=n>information</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>sharing</span><span class=w> </span><span class=n>packages</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>depot</span><span class=p>,</span><span class=w> </span><span class=n>please</span><span class=w> </span><span class=k>read</span><span class=w> </span><span class=n>the</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>documentation</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=p>.</span><span class=n>habitat</span><span class=p>.</span><span class=n>sh</span><span class=o>/</span><span class=n>docs</span><span class=o>/</span><span class=n>share</span><span class=o>-</span><span class=n>packages</span><span class=o>-</span><span class=n>overview</span><span class=o>/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kt>Set</span><span class=w> </span><span class=n>up</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=n>GitHub</span><span class=w> </span><span class=n>access</span><span class=w> </span><span class=n>token</span><span class=o>?</span><span class=w> </span><span class=p>[</span><span class=n>Yes</span><span class=o>/</span><span class=n>no</span><span class=o>/</span><span class=n>quit</span><span class=p>]</span><span class=w> </span><span class=n>yes</span><span class=w> </span><span class=err>这里选择</span><span class=n>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Enter</span><span class=w> </span><span class=n>your</span><span class=w> </span><span class=n>GitHub</span><span class=w> </span><span class=n>access</span><span class=w> </span><span class=n>token</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>You</span><span class=w> </span><span class=n>already</span><span class=w> </span><span class=n>have</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=n>auth</span><span class=w> </span><span class=n>token</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=n>up</span><span class=p>,</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=n>feel</span><span class=w> </span><span class=n>free</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=k>change</span><span class=w> </span><span class=n>it</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=n>you</span><span class=w> </span><span class=n>wish</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>GitHub</span><span class=w> </span><span class=n>access</span><span class=w> </span><span class=n>token</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=k>default</span><span class=p>:</span><span class=w> </span><span class=n>martin</span><span class=o>-</span><span class=n>github</span><span class=o>-</span><span class=n>token</span><span class=p>]</span><span class=w>  </span><span class=err>这个</span><span class=w> </span><span class=n>token</span><span class=w> </span><span class=err>需要自己去</span><span class=w> </span><span class=n>github</span><span class=w> </span><span class=err>里面生成</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Analytics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>The</span><span class=w> </span><span class=o>`</span><span class=n>hab</span><span class=o>`</span><span class=w> </span><span class=n>command</span><span class=o>-</span><span class=n>line</span><span class=w> </span><span class=n>tool</span><span class=w> </span><span class=n>will</span><span class=w> </span><span class=k>optionally</span><span class=w> </span><span class=n>send</span><span class=w> </span><span class=n>anonymous</span><span class=w> </span><span class=k>usage</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=k>to</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Habitat</span><span class=s1>&#39;s Google Analytics account. This is a strictly opt-in activity
</span></span></span><span class=line><span class=cl><span class=s1>  and no tracking will occur unless you respond affirmatively to the
</span></span></span><span class=line><span class=cl><span class=s1>  question below.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>  We collect this data to help improve Habitat&#39;</span><span class=n>s</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=n>experience</span><span class=p>.</span><span class=w> </span><span class=k>For</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>example</span><span class=p>,</span><span class=w> </span><span class=n>we</span><span class=w> </span><span class=n>would</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>know</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>category</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>tasks</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>are</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>performing</span><span class=p>,</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>which</span><span class=w> </span><span class=n>ones</span><span class=w> </span><span class=n>they</span><span class=w> </span><span class=n>are</span><span class=w> </span><span class=k>having</span><span class=w> </span><span class=n>trouble</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>g</span><span class=p>.</span><span class=w> </span><span class=n>mistyping</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>command</span><span class=w> </span><span class=n>line</span><span class=w> </span><span class=n>arguments</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>To</span><span class=w> </span><span class=n>see</span><span class=w> </span><span class=n>what</span><span class=w> </span><span class=n>kinds</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=n>are</span><span class=w> </span><span class=n>sent</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>how</span><span class=w> </span><span class=n>they</span><span class=w> </span><span class=n>are</span><span class=w> </span><span class=n>anonymized</span><span class=p>,</span><span class=w> </span><span class=n>please</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>read</span><span class=w> </span><span class=n>more</span><span class=w> </span><span class=n>about</span><span class=w> </span><span class=n>our</span><span class=w> </span><span class=n>analytics</span><span class=w> </span><span class=n>here</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=p>.</span><span class=n>habitat</span><span class=p>.</span><span class=n>sh</span><span class=o>/</span><span class=n>docs</span><span class=o>/</span><span class=n>about</span><span class=o>-</span><span class=n>analytics</span><span class=o>/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Enable</span><span class=w> </span><span class=n>analytics</span><span class=o>?</span><span class=w> </span><span class=p>[</span><span class=n>yes</span><span class=o>/</span><span class=n>No</span><span class=o>/</span><span class=n>quit</span><span class=p>]</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=err>这里选择</span><span class=w> </span><span class=n>no</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=err>»</span><span class=w> </span><span class=n>Opting</span><span class=w> </span><span class=k>out</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>analytics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=err>☑</span><span class=w> </span><span class=n>Creating</span><span class=w> </span><span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=p>.</span><span class=n>hab</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>analytics</span><span class=o>/</span><span class=n>OPTED_OUT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=err>★</span><span class=w> </span><span class=n>Analytics</span><span class=w> </span><span class=n>opted</span><span class=w> </span><span class=k>out</span><span class=p>,</span><span class=w> </span><span class=n>we</span><span class=w> </span><span class=n>salute</span><span class=w> </span><span class=n>you</span><span class=w> </span><span class=n>just</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>same</span><span class=o>!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>CLI</span><span class=w> </span><span class=n>Setup</span><span class=w> </span><span class=n>Complete</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>That</span><span class=s1>&#39;s all for now. Thanks for using Habitat!
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>martin@localhost ~/Documents                                                                                 $
</span></span></span></code></pre></td></tr></table></div></div><p>该注意的都写到上面的代码里面了。这个配置的结果在这里</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat ~/.hab/etc/cli.toml
</span></span><span class=line><span class=cl>auth_token = &#34;martin-github-token&#34;
</span></span><span class=line><span class=cl>origin = &#34;martin&#34;
</span></span></code></pre></td></tr></table></div></div><h3 id=调试-habitat-demo-应用>调试 Habitat demo 应用</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>git clone https://github.com/habitat-sh/habitat-example-plans
</span></span></code></pre></td></tr></table></div></div><p>进入到 mytutorialapp 目录，修改 plan.sh 的 第二行代码，我改后的代码是</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pkg_origin=martin
</span></span></code></pre></td></tr></table></div></div><p>martin 是我在 hab cli 里面配置的 origin。</p><p>其实下面的测试就执行了两个 hab 的命令，都是在 hab studi 的 shell 里面执行的，这个 shell 其实就是一个 studio 容器的 shell。</p><p>在运行下面的命令，确保你是和 node1 正常通讯的，下面我用 default 节点做演示。做完的演示环境我已经删除了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ docker-machine ls                                                                                      NAME      ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER    ERRORS
</span></span><span class=line><span class=cl>default   -        virtualbox   Running   tcp://192.168.99.100:2376           v1.11.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ docker ps                                                                                              CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</span></span></code></pre></td></tr></table></div></div><p>正常的意思是执行所有 docker 命令不报错。</p><h3 id=build-habitat-demo-代码>build habitat demo 代码</h3><p>进入到代码的 plan.sh 的目录 执行 hab studio enter 命令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>martin</span><span class=err>@</span><span class=n>localhost</span> <span class=o>~/</span><span class=n>Documents</span><span class=o>/</span><span class=n>GitHub</span><span class=o>/</span><span class=n>habitat</span><span class=o>-</span><span class=n>example</span><span class=o>-</span><span class=n>plans</span><span class=o>/</span><span class=n>mytutorialapp</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>hab</span> <span class=n>studio</span> <span class=n>enter</span>                                                                                       <span class=p>[</span><span class=err>±</span><span class=n>master</span> <span class=err>●●</span><span class=p>]</span>
</span></span><span class=line><span class=cl>   <span class=n>hab</span><span class=o>-</span><span class=n>studio</span><span class=p>:</span> <span class=n>Creating</span> <span class=n>Studio</span> <span class=n>at</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>studios</span><span class=o>/</span><span class=n>src</span> <span class=p>(</span><span class=n>default</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>hab</span><span class=o>-</span><span class=n>studio</span><span class=p>:</span> <span class=n>Importing</span> <span class=n>martin</span> <span class=n>secret</span> <span class=n>origin</span> <span class=n>key</span>
</span></span><span class=line><span class=cl><span class=err>»</span> <span class=n>Importing</span> <span class=n>origin</span> <span class=n>key</span> <span class=n>from</span> <span class=n>standard</span> <span class=n>input</span>
</span></span><span class=line><span class=cl><span class=err>★</span> <span class=n>Imported</span> <span class=n>secret</span> <span class=n>origin</span> <span class=n>key</span> <span class=n>martin</span><span class=o>-</span><span class=mf>20160630040241.</span>
</span></span><span class=line><span class=cl>   <span class=n>hab</span><span class=o>-</span><span class=n>studio</span><span class=p>:</span> <span class=n>Entering</span> <span class=n>Studio</span> <span class=n>at</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>studios</span><span class=o>/</span><span class=n>src</span> <span class=p>(</span><span class=n>default</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>hab</span><span class=o>-</span><span class=n>studio</span><span class=p>:</span> <span class=n>Exported</span><span class=p>:</span> <span class=n>HAB_ORIGIN</span><span class=o>=</span><span class=n>martin</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>default</span><span class=p>:</span><span class=o>/</span><span class=n>src</span><span class=p>:</span><span class=mi>0</span><span class=p>]</span><span class=c1># build</span>
</span></span><span class=line><span class=cl>   <span class=p>:</span> <span class=n>Loading</span> <span class=o>/</span><span class=n>src</span><span class=o>/</span><span class=n>plan</span><span class=o>.</span><span class=n>sh</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Plan</span> <span class=n>loaded</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>hab</span><span class=o>-</span><span class=n>plan</span><span class=o>-</span><span class=n>build</span> <span class=n>setup</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Using</span> <span class=n>HAB_BIN</span><span class=o>=/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=mf>0.7</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160614230104</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>hab</span> <span class=k>for</span> <span class=n>installs</span><span class=p>,</span> <span class=n>signing</span><span class=p>,</span> <span class=ow>and</span> <span class=n>hashing</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Resolving</span> <span class=n>dependencies</span>
</span></span><span class=line><span class=cl><span class=err>»</span> <span class=n>Installing</span> <span class=n>core</span><span class=o>/</span><span class=n>node</span>
</span></span><span class=line><span class=cl><span class=err>→</span> <span class=n>Using</span> <span class=n>core</span><span class=o>/</span><span class=n>gcc</span><span class=o>-</span><span class=n>libs</span><span class=o>/</span><span class=mf>5.2</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160612075020</span>
</span></span><span class=line><span class=cl><span class=err>→</span> <span class=n>Using</span> <span class=n>core</span><span class=o>/</span><span class=n>glibc</span><span class=o>/</span><span class=mf>2.22</span><span class=o>/</span><span class=mi>20160612063629</span>
</span></span><span class=line><span class=cl><span class=err>→</span> <span class=n>Using</span> <span class=n>core</span><span class=o>/</span><span class=n>linux</span><span class=o>-</span><span class=n>headers</span><span class=o>/</span><span class=mf>4.3</span><span class=o>/</span><span class=mi>20160612063537</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612143531</span>
</span></span><span class=line><span class=cl>    <span class=mf>6.44</span> <span class=n>MB</span> <span class=o>/</span> <span class=mf>6.44</span> <span class=n>MB</span> \ <span class=p>[</span><span class=o>=======================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>457.82</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>-</span><span class=mi>20160612031944</span> <span class=n>public</span> <span class=n>origin</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>    <span class=mi>75</span> <span class=n>B</span> <span class=o>/</span> <span class=mi>75</span> <span class=n>B</span> <span class=o>|</span> <span class=p>[</span><span class=o>=============================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>575.13</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>☑</span> <span class=n>Cached</span> <span class=n>core</span><span class=o>-</span><span class=mi>20160612031944</span> <span class=n>public</span> <span class=n>origin</span> <span class=n>key</span>
</span></span><span class=line><span class=cl><span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612143531</span>
</span></span><span class=line><span class=cl><span class=err>★</span> <span class=n>Install</span> <span class=n>of</span> <span class=n>core</span><span class=o>/</span><span class=n>node</span> <span class=n>complete</span> <span class=n>with</span> <span class=mi>4</span> <span class=n>packages</span> <span class=n>installed</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Resolved</span> <span class=n>dependency</span> <span class=s1>&#39;core/node&#39;</span> <span class=n>to</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612143531</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Setting</span> <span class=n>PATH</span><span class=o>=/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612143531</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>plan</span><span class=o>-</span><span class=n>build</span><span class=o>/</span><span class=mf>0.7</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160614232259</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>bash</span><span class=o>/</span><span class=mf>4.3</span><span class=o>.</span><span class=mi>42</span><span class=o>/</span><span class=mi>20160612075613</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>binutils</span><span class=o>/</span><span class=mf>2.25</span><span class=o>.</span><span class=mi>1</span><span class=o>/</span><span class=mi>20160612064534</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>bzip2</span><span class=o>/</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612075040</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>coreutils</span><span class=o>/</span><span class=mf>8.24</span><span class=o>/</span><span class=mi>20160612075329</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>file</span><span class=o>/</span><span class=mf>5.24</span><span class=o>/</span><span class=mi>20160612064523</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>findutils</span><span class=o>/</span><span class=mf>4.4</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612080341</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>gawk</span><span class=o>/</span><span class=mf>4.1</span><span class=o>.</span><span class=mi>3</span><span class=o>/</span><span class=mi>20160612075739</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>grep</span><span class=o>/</span><span class=mf>2.22</span><span class=o>/</span><span class=mi>20160612075540</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>gzip</span><span class=o>/</span><span class=mf>1.6</span><span class=o>/</span><span class=mi>20160612080637</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=mf>0.7</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160614230104</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>sed</span><span class=o>/</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612075228</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>tar</span><span class=o>/</span><span class=mf>1.28</span><span class=o>/</span><span class=mi>20160612075701</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>unzip</span><span class=o>/</span><span class=mf>6.0</span><span class=o>/</span><span class=mi>20160612081414</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>wget</span><span class=o>/</span><span class=mf>1.16</span><span class=o>.</span><span class=mi>3</span><span class=o>/</span><span class=mi>20160612081342</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>xz</span><span class=o>/</span><span class=mf>5.2</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612080402</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>acl</span><span class=o>/</span><span class=mf>2.2</span><span class=o>.</span><span class=mi>52</span><span class=o>/</span><span class=mi>20160612075215</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>attr</span><span class=o>/</span><span class=mf>2.4</span><span class=o>.</span><span class=mi>47</span><span class=o>/</span><span class=mi>20160612075207</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>glibc</span><span class=o>/</span><span class=mf>2.22</span><span class=o>/</span><span class=mi>20160612063629</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>less</span><span class=o>/</span><span class=mi>481</span><span class=o>/</span><span class=mi>20160612080021</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>libcap</span><span class=o>/</span><span class=mf>2.24</span><span class=o>/</span><span class=mi>20160612075226</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>libidn</span><span class=o>/</span><span class=mf>1.32</span><span class=o>/</span><span class=mi>20160612081104</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>ncurses</span><span class=o>/</span><span class=mf>6.0</span><span class=o>/</span><span class=mi>20160612075116</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>openssl</span><span class=o>/</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>2</span><span class=n>h</span><span class=o>/</span><span class=mi>20160612081127</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>pcre</span><span class=o>/</span><span class=mf>8.38</span><span class=o>/</span><span class=mi>20160612075520</span><span class=o>/</span><span class=n>bin</span>
</span></span><span class=line><span class=cl><span class=n>mkdir</span><span class=p>:</span> <span class=n>created</span> <span class=n>directory</span> <span class=s1>&#39;/hab/cache/src&#39;</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Downloading</span> <span class=s1>&#39;https://s3-us-west-2.amazonaws.com/mytutorialapp/mytutorialapp-0.1.0.tar.gz&#39;</span> <span class=n>to</span> <span class=s1>&#39;mytutorialapp-0.1.0.tar.gz&#39;</span>
</span></span><span class=line><span class=cl><span class=o>--</span><span class=mi>2016</span><span class=o>-</span><span class=mi>07</span><span class=o>-</span><span class=mi>01</span> <span class=mi>02</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>51</span><span class=o>--</span>  <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>s3</span><span class=o>-</span><span class=n>us</span><span class=o>-</span><span class=n>west</span><span class=o>-</span><span class=mf>2.</span><span class=n>amazonaws</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>mytutorialapp</span><span class=o>/</span><span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mf>0.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl><span class=n>Resolving</span> <span class=n>s3</span><span class=o>-</span><span class=n>us</span><span class=o>-</span><span class=n>west</span><span class=o>-</span><span class=mf>2.</span><span class=n>amazonaws</span><span class=o>.</span><span class=n>com</span> <span class=p>(</span><span class=n>s3</span><span class=o>-</span><span class=n>us</span><span class=o>-</span><span class=n>west</span><span class=o>-</span><span class=mf>2.</span><span class=n>amazonaws</span><span class=o>.</span><span class=n>com</span><span class=p>)</span><span class=o>...</span> <span class=mf>54.231</span><span class=o>.</span><span class=mf>184.216</span>
</span></span><span class=line><span class=cl><span class=n>Connecting</span> <span class=n>to</span> <span class=n>s3</span><span class=o>-</span><span class=n>us</span><span class=o>-</span><span class=n>west</span><span class=o>-</span><span class=mf>2.</span><span class=n>amazonaws</span><span class=o>.</span><span class=n>com</span> <span class=p>(</span><span class=n>s3</span><span class=o>-</span><span class=n>us</span><span class=o>-</span><span class=n>west</span><span class=o>-</span><span class=mf>2.</span><span class=n>amazonaws</span><span class=o>.</span><span class=n>com</span><span class=p>)</span><span class=o>|</span><span class=mf>54.231</span><span class=o>.</span><span class=mf>184.216</span><span class=o>|</span><span class=p>:</span><span class=mf>443.</span><span class=o>..</span> <span class=n>connected</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>HTTP</span> <span class=n>request</span> <span class=n>sent</span><span class=p>,</span> <span class=n>awaiting</span> <span class=n>response</span><span class=o>...</span> <span class=mi>200</span> <span class=n>OK</span>
</span></span><span class=line><span class=cl><span class=n>Length</span><span class=p>:</span> <span class=mi>1041</span> <span class=p>(</span><span class=mf>1.0</span><span class=n>K</span><span class=p>)</span> <span class=p>[</span><span class=n>application</span><span class=o>/</span><span class=n>x</span><span class=o>-</span><span class=n>gzip</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Saving</span> <span class=n>to</span><span class=p>:</span> <span class=s1>&#39;mytutorialapp-0.1.0.tar.gz&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mf>0.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>    <span class=mi>100</span><span class=o>%</span><span class=p>[</span><span class=o>===================================================&gt;</span><span class=p>]</span>   <span class=mf>1.02</span><span class=n>K</span>  <span class=o>--.-</span><span class=n>KB</span><span class=o>/</span><span class=n>s</span>   <span class=ow>in</span> <span class=mf>0.03</span><span class=n>s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mi>2016</span><span class=o>-</span><span class=mi>07</span><span class=o>-</span><span class=mi>01</span> <span class=mi>02</span><span class=p>:</span><span class=mi>28</span><span class=p>:</span><span class=mi>08</span> <span class=p>(</span><span class=mf>32.1</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span><span class=p>)</span> <span class=o>-</span> <span class=s1>&#39;mytutorialapp-0.1.0.tar.gz&#39;</span> <span class=n>saved</span> <span class=p>[</span><span class=mi>1041</span><span class=o>/</span><span class=mi>1041</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Downloaded</span> <span class=s1>&#39;mytutorialapp-0.1.0.tar.gz&#39;</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Verifying</span> <span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mf>0.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Checksum</span> <span class=n>verified</span> <span class=k>for</span> <span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mf>0.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Clean</span> <span class=n>the</span> <span class=n>cache</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Unpacking</span> <span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mf>0.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Setting</span> <span class=n>build</span> <span class=n>environment</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Setting</span> <span class=n>PREFIX</span><span class=o>=/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>mytutorialapp</span><span class=o>/</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160701022725</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Setting</span> <span class=n>LD_RUN_PATH</span><span class=o>=/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612143531</span><span class=o>/</span><span class=n>lib</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Setting</span> <span class=n>CFLAGS</span><span class=o>=-</span><span class=n>I</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612143531</span><span class=o>/</span><span class=n>include</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Setting</span> <span class=n>LDFLAGS</span><span class=o>=-</span><span class=n>L</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612143531</span><span class=o>/</span><span class=n>lib</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Preparing</span> <span class=n>to</span> <span class=n>build</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Building</span>
</span></span><span class=line><span class=cl><span class=n>npm</span> <span class=n>WARN</span> <span class=n>package</span><span class=o>.</span><span class=n>json</span> <span class=n>mytutorialapp</span><span class=err>@</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span> <span class=n>No</span> <span class=n>repository</span> <span class=n>field</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>npm</span> <span class=n>WARN</span> <span class=n>package</span><span class=o>.</span><span class=n>json</span> <span class=n>mytutorialapp</span><span class=err>@</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span> <span class=n>No</span> <span class=n>README</span> <span class=n>data</span>
</span></span><span class=line><span class=cl><span class=n>nconf</span><span class=err>@</span><span class=mf>0.8</span><span class=o>.</span><span class=mi>4</span> <span class=n>node_modules</span><span class=o>/</span><span class=n>nconf</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>ini</span><span class=err>@</span><span class=mf>1.3</span><span class=o>.</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>secure</span><span class=o>-</span><span class=n>keys</span><span class=err>@</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>async</span><span class=err>@</span><span class=mf>1.5</span><span class=o>.</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=err>└──</span> <span class=n>yargs</span><span class=err>@</span><span class=mf>3.32</span><span class=o>.</span><span class=mi>0</span> <span class=p>(</span><span class=n>decamelize</span><span class=err>@</span><span class=mf>1.2</span><span class=o>.</span><span class=mi>0</span><span class=p>,</span> <span class=n>camelcase</span><span class=err>@</span><span class=mf>2.1</span><span class=o>.</span><span class=mi>1</span><span class=p>,</span> <span class=n>window</span><span class=o>-</span><span class=n>size</span><span class=err>@</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>4</span><span class=p>,</span> <span class=n>y18n</span><span class=err>@</span><span class=mf>3.2</span><span class=o>.</span><span class=mi>1</span><span class=p>,</span> <span class=n>os</span><span class=o>-</span><span class=n>locale</span><span class=err>@</span><span class=mf>1.4</span><span class=o>.</span><span class=mi>0</span><span class=p>,</span> <span class=n>cliui</span><span class=err>@</span><span class=mf>3.2</span><span class=o>.</span><span class=mi>0</span><span class=p>,</span> <span class=n>string</span><span class=o>-</span><span class=n>width</span><span class=err>@</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Installing</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;node_modules/nconf&#39;</span> <span class=o>-&gt;</span> <span class=s1>&#39;/hab/pkgs/martin/mytutorialapp/0.1.0/20160701022725/node_modules/nconf&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>忽略了好几百行输出</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s1>&#39;node_modules/nconf/node_modules/secure-keys/test/simple-test.js&#39;</span> <span class=o>-&gt;</span> <span class=s1>&#39;/hab/pkgs/martin/mytutorialapp/0.1.0/20160701022725/node_modules/nconf/node_modules/secure-keys/test/simple-test.js&#39;</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;node_modules/nconf/node_modules/secure-keys/test/test.secret.key&#39;</span> <span class=o>-&gt;</span> <span class=s1>&#39;/hab/pkgs/martin/mytutorialapp/0.1.0/20160701022725/node_modules/nconf/node_modules/secure-keys/test/test.secret.key&#39;</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;node_modules/nconf/node_modules/secure-keys/package.json&#39;</span> <span class=o>-&gt;</span> <span class=s1>&#39;/hab/pkgs/martin/mytutorialapp/0.1.0/20160701022725/node_modules/nconf/node_modules/secure-keys/package.json&#39;</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Writing</span> <span class=n>configuration</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Writing</span> <span class=n>service</span> <span class=n>management</span> <span class=n>scripts</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Stripping</span> <span class=n>unneeded</span> <span class=n>symbols</span> <span class=n>from</span> <span class=n>binaries</span> <span class=ow>and</span> <span class=n>libraries</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Creating</span> <span class=n>manifest</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Building</span> <span class=n>package</span> <span class=n>metadata</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Generating</span> <span class=n>blake2b</span> <span class=n>hashes</span> <span class=n>of</span> <span class=n>all</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>the</span> <span class=n>package</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Generating</span> <span class=n>signed</span> <span class=n>metadata</span> <span class=n>FILES</span>
</span></span><span class=line><span class=cl><span class=err>»</span> <span class=n>Signing</span> <span class=n>mytutorialapp_blake2bsums</span>
</span></span><span class=line><span class=cl><span class=err>☛</span> <span class=n>Signing</span> <span class=n>mytutorialapp_blake2bsums</span> <span class=n>with</span> <span class=n>martin</span><span class=o>-</span><span class=mi>20160630040241</span> <span class=n>to</span> <span class=n>create</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>mytutorialapp</span><span class=o>/</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160701022725</span><span class=o>/</span><span class=n>FILES</span>
</span></span><span class=line><span class=cl><span class=err>★</span> <span class=n>Signed</span> <span class=n>artifact</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>mytutorialapp</span><span class=o>/</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160701022725</span><span class=o>/</span><span class=n>FILES</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Generating</span> <span class=n>package</span> <span class=n>artifact</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>tar</span><span class=o>/</span><span class=mf>1.28</span><span class=o>/</span><span class=mi>20160612075701</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>tar</span><span class=p>:</span> <span class=n>Removing</span> <span class=n>leading</span> <span class=err>`</span><span class=o>/</span><span class=s1>&#39; from member names</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>artifacts</span><span class=o>/.</span><span class=n>martin</span><span class=o>-</span><span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>20160701022725</span><span class=o>-</span><span class=n>x86_64</span><span class=o>-</span><span class=n>linux</span><span class=o>.</span><span class=n>tar</span> <span class=p>(</span><span class=mi>1</span><span class=o>/</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>100</span> <span class=o>%</span>       <span class=mf>121.4</span> <span class=n>KiB</span> <span class=o>/</span> <span class=mf>900.0</span> <span class=n>KiB</span> <span class=o>=</span> <span class=mf>0.135</span>
</span></span><span class=line><span class=cl><span class=err>»</span> <span class=n>Signing</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>artifacts</span><span class=o>/.</span><span class=n>martin</span><span class=o>-</span><span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>20160701022725</span><span class=o>-</span><span class=n>x86_64</span><span class=o>-</span><span class=n>linux</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>xz</span>
</span></span><span class=line><span class=cl><span class=err>☛</span> <span class=n>Signing</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>artifacts</span><span class=o>/.</span><span class=n>martin</span><span class=o>-</span><span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>20160701022725</span><span class=o>-</span><span class=n>x86_64</span><span class=o>-</span><span class=n>linux</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>xz</span> <span class=n>with</span> <span class=n>martin</span><span class=o>-</span><span class=mi>20160630040241</span> <span class=n>to</span> <span class=n>create</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>artifacts</span><span class=o>/</span><span class=n>martin</span><span class=o>-</span><span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>20160701022725</span><span class=o>-</span><span class=n>x86_64</span><span class=o>-</span><span class=n>linux</span><span class=o>.</span><span class=n>hart</span>
</span></span><span class=line><span class=cl><span class=err>★</span> <span class=n>Signed</span> <span class=n>artifact</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>artifacts</span><span class=o>/</span><span class=n>martin</span><span class=o>-</span><span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>20160701022725</span><span class=o>-</span><span class=n>x86_64</span><span class=o>-</span><span class=n>linux</span><span class=o>.</span><span class=n>hart</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;/hab/cache/artifacts/martin-mytutorialapp-0.1.0-20160701022725-x86_64-linux.hart&#39;</span> <span class=o>-&gt;</span> <span class=s1>&#39;/src/results/martin-mytutorialapp-0.1.0-20160701022725-x86_64-linux.hart&#39;</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>hab</span><span class=o>-</span><span class=n>plan</span><span class=o>-</span><span class=n>build</span> <span class=n>cleanup</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Source</span> <span class=n>Cache</span><span class=p>:</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>src</span><span class=o>/</span><span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Installed</span> <span class=ne>Path</span><span class=p>:</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>mytutorialapp</span><span class=o>/</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160701022725</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Artifact</span><span class=p>:</span> <span class=o>/</span><span class=n>src</span><span class=o>/</span><span class=n>results</span><span class=o>/</span><span class=n>martin</span><span class=o>-</span><span class=n>mytutorialapp</span><span class=o>-</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>20160701022725</span><span class=o>-</span><span class=n>x86_64</span><span class=o>-</span><span class=n>linux</span><span class=o>.</span><span class=n>hart</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Build</span> <span class=n>Report</span><span class=p>:</span> <span class=o>/</span><span class=n>src</span><span class=o>/</span><span class=n>results</span><span class=o>/</span><span class=n>last_build</span><span class=o>.</span><span class=n>env</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>SHA256</span> <span class=n>Checksum</span><span class=p>:</span> <span class=n>d4bfb3a44989b8a5b1295eac2600d75f42dd2be6f537344312c8917cba47d05d</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Blake2b</span> <span class=n>Checksum</span><span class=p>:</span> <span class=n>fbff257eb36fffa61e6cbf5ec89fa3f507095f80f5cca610c2bb72685d758706</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>I</span> <span class=n>love</span> <span class=n>it</span> <span class=n>when</span> <span class=n>a</span> <span class=n>plan</span><span class=o>.</span><span class=n>sh</span> <span class=n>comes</span> <span class=n>together</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=n>mytutorialapp</span><span class=p>:</span> <span class=n>Build</span> <span class=n>time</span><span class=p>:</span> <span class=mi>1</span><span class=n>m3s</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>default</span><span class=p>:</span><span class=o>/</span><span class=n>src</span><span class=p>:</span><span class=mi>0</span><span class=p>]</span><span class=c1>#</span>
</span></span></code></pre></td></tr></table></div></div><p>检查结果，在代码的目录中可以看的 result 目录，关注一下这个目录，关键看 build 命令的最后一段。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mytutorialapp: hab-plan-build cleanup mytutorialapp: mytutorialapp: Source Cache: /hab/cache/src/mytutorialapp-0.1.0 mytutorialapp: Installed Path: /hab/pkgs/martin/mytutorialapp/0.1.0/20160701022725 mytutorialapp: Artifact: /src/results/martin-mytutorialapp-0.1.0-20160701022725-x86_64-linux.hart mytutorialapp: Build Report: /src/results/last_build.env mytutorialapp: SHA256 Checksum: d4bfb3a44989b8a5b1295eac2600d75f42dd2be6f537344312c8917cba47d05d mytutorialapp: Blake2b Checksum: fbff257eb36fffa61e6cbf5ec89fa3f507095f80f5cca610c2bb72685d758706 mytutorialapp: mytutorialapp: I love it when a plan.sh comes together. mytutorialapp: mytutorialapp: Build time: 1m3s
</span></span></code></pre></td></tr></table></div></div><h3 id=昨晚分享的高潮部分-habitat-导出-docker-image>昨晚分享的高潮部分, habitat 导出 docker image</h3><p>其实就是一条命令，在 habitat Studio 中执行 导出命令 hab pkg export docker martin/mytutorialapp</p><p>导出 docker 镜像的过程和 build 的过程一样，都可能会失败；由于它需要到网上下载所需要的代码，下载所需要的 habitat 模块，core/ 开头的都是 habitat 出品的核心的模块，他们的想法基本也是说把所有的可能用到的模块都做封装，成为自己的 pkg 格式的内容。然后在用他们的 Habitat 服务来解析、部署和运行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=mi>4</span><span class=p>][</span><span class=n>default</span><span class=p>:</span><span class=o>/</span><span class=n>src</span><span class=p>:</span><span class=mi>0</span><span class=p>]</span><span class=c1>#  hab pkg export docker martin/mytutorialapp</span>
</span></span><span class=line><span class=cl>   <span class=n>hab</span><span class=o>-</span><span class=n>studio</span><span class=p>:</span> <span class=n>Creating</span> <span class=n>Studio</span> <span class=n>at</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>pkg</span><span class=o>-</span><span class=n>dockerize</span><span class=o>-</span><span class=n>XxsS</span><span class=o>/</span><span class=n>rootfs</span> <span class=p>(</span><span class=n>baseimage</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=n>Using</span> <span class=n>local</span> <span class=n>package</span> <span class=k>for</span> <span class=n>martin</span><span class=o>/</span><span class=n>mytutorialapp</span>
</span></span><span class=line><span class=cl> <span class=n>Using</span> <span class=n>local</span> <span class=n>package</span> <span class=k>for</span> <span class=n>core</span><span class=o>/</span><span class=n>gcc</span><span class=o>-</span><span class=n>libs</span><span class=o>/</span><span class=mf>5.2</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160612075020</span> <span class=n>via</span> <span class=n>martin</span><span class=o>/</span><span class=n>mytutorialapp</span>
</span></span><span class=line><span class=cl> <span class=n>Using</span> <span class=n>local</span> <span class=n>package</span> <span class=k>for</span> <span class=n>core</span><span class=o>/</span><span class=n>glibc</span><span class=o>/</span><span class=mf>2.22</span><span class=o>/</span><span class=mi>20160612063629</span> <span class=n>via</span> <span class=n>martin</span><span class=o>/</span><span class=n>mytutorialapp</span>
</span></span><span class=line><span class=cl> <span class=n>Using</span> <span class=n>local</span> <span class=n>package</span> <span class=k>for</span> <span class=n>core</span><span class=o>/</span><span class=n>linux</span><span class=o>-</span><span class=n>headers</span><span class=o>/</span><span class=mf>4.3</span><span class=o>/</span><span class=mi>20160612063537</span> <span class=n>via</span> <span class=n>martin</span><span class=o>/</span><span class=n>mytutorialapp</span>
</span></span><span class=line><span class=cl> <span class=n>Using</span> <span class=n>local</span> <span class=n>package</span> <span class=k>for</span> <span class=n>core</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612143531</span> <span class=n>via</span> <span class=n>martin</span><span class=o>/</span><span class=n>mytutorialapp</span>
</span></span><span class=line><span class=cl><span class=err>»</span> <span class=n>Installing</span> <span class=n>core</span><span class=o>/</span><span class=n>hab</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=mf>0.7</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160614230104</span>
</span></span><span class=line><span class=cl>    <span class=mf>2.23</span> <span class=n>MB</span> <span class=o>/</span> <span class=mf>2.23</span> <span class=n>MB</span> <span class=o>/</span> <span class=p>[</span><span class=o>=======================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>500.60</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>-</span><span class=mi>20160612031944</span> <span class=n>public</span> <span class=n>origin</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>    <span class=mi>75</span> <span class=n>B</span> <span class=o>/</span> <span class=mi>75</span> <span class=n>B</span> <span class=o>|</span> <span class=p>[</span><span class=o>=============================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>378.76</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>☑</span> <span class=n>Cached</span> <span class=n>core</span><span class=o>-</span><span class=mi>20160612031944</span> <span class=n>public</span> <span class=n>origin</span> <span class=n>key</span>
</span></span><span class=line><span class=cl><span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=mf>0.7</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160614230104</span>
</span></span><span class=line><span class=cl><span class=err>★</span> <span class=n>Install</span> <span class=n>of</span> <span class=n>core</span><span class=o>/</span><span class=n>hab</span> <span class=n>complete</span> <span class=n>with</span> <span class=mi>1</span> <span class=n>packages</span> <span class=n>installed</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=err>»</span> <span class=n>Installing</span> <span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>sup</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>busybox</span><span class=o>-</span><span class=k>static</span><span class=o>/</span><span class=mf>1.24</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612081725</span>
</span></span><span class=line><span class=cl>    <span class=mf>510.89</span> <span class=n>KB</span> <span class=o>/</span> <span class=mf>510.89</span> <span class=n>KB</span> <span class=o>|</span> <span class=p>[</span><span class=o>====================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>89.61</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>busybox</span><span class=o>-</span><span class=k>static</span><span class=o>/</span><span class=mf>1.24</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612081725</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>bzip2</span><span class=o>/</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612075040</span>
</span></span><span class=line><span class=cl>    <span class=mf>141.05</span> <span class=n>KB</span> <span class=o>/</span> <span class=mf>141.05</span> <span class=n>KB</span> <span class=o>-</span> <span class=p>[</span><span class=o>===================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>349.94</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>bzip2</span><span class=o>/</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612075040</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>cacerts</span><span class=o>/</span><span class=mf>2016.04</span><span class=o>.</span><span class=mi>20</span><span class=o>/</span><span class=mi>20160612081125</span>
</span></span><span class=line><span class=cl>    <span class=mf>132.32</span> <span class=n>KB</span> <span class=o>/</span> <span class=mf>132.32</span> <span class=n>KB</span> <span class=o>|</span> <span class=p>[</span><span class=o>===================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>370.21</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>cacerts</span><span class=o>/</span><span class=mf>2016.04</span><span class=o>.</span><span class=mi>20</span><span class=o>/</span><span class=mi>20160612081125</span>
</span></span><span class=line><span class=cl><span class=err>→</span> <span class=n>Using</span> <span class=n>core</span><span class=o>/</span><span class=n>gcc</span><span class=o>-</span><span class=n>libs</span><span class=o>/</span><span class=mf>5.2</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160612075020</span>
</span></span><span class=line><span class=cl><span class=err>→</span> <span class=n>Using</span> <span class=n>core</span><span class=o>/</span><span class=n>glibc</span><span class=o>/</span><span class=mf>2.22</span><span class=o>/</span><span class=mi>20160612063629</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>libarchive</span><span class=o>/</span><span class=mf>3.2</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160612140528</span>
</span></span><span class=line><span class=cl>    <span class=mf>584.98</span> <span class=n>KB</span> <span class=o>/</span> <span class=mf>584.98</span> <span class=n>KB</span> <span class=o>|</span> <span class=p>[</span><span class=o>===================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>340.75</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>libarchive</span><span class=o>/</span><span class=mf>3.2</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160612140528</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>libsodium</span><span class=o>/</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>8</span><span class=o>/</span><span class=mi>20160612140317</span>
</span></span><span class=line><span class=cl>    <span class=mf>187.96</span> <span class=n>KB</span> <span class=o>/</span> <span class=mf>187.96</span> <span class=n>KB</span> \ <span class=p>[</span><span class=o>===================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>200.27</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>libsodium</span><span class=o>/</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>8</span><span class=o>/</span><span class=mi>20160612140317</span>
</span></span><span class=line><span class=cl><span class=err>→</span> <span class=n>Using</span> <span class=n>core</span><span class=o>/</span><span class=n>linux</span><span class=o>-</span><span class=n>headers</span><span class=o>/</span><span class=mf>4.3</span><span class=o>/</span><span class=mi>20160612063537</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>openssl</span><span class=o>/</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>2</span><span class=n>h</span><span class=o>/</span><span class=mi>20160612081127</span>
</span></span><span class=line><span class=cl>    <span class=mf>2.10</span> <span class=n>MB</span> <span class=o>/</span> <span class=mf>2.10</span> <span class=n>MB</span> <span class=o>|</span> <span class=p>[</span><span class=o>=======================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>518.78</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>openssl</span><span class=o>/</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>2</span><span class=n>h</span><span class=o>/</span><span class=mi>20160612081127</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>xz</span><span class=o>/</span><span class=mf>5.2</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612080402</span>
</span></span><span class=line><span class=cl>    <span class=mf>247.38</span> <span class=n>KB</span> <span class=o>/</span> <span class=mf>247.38</span> <span class=n>KB</span> \ <span class=p>[</span><span class=o>===================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>468.42</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>xz</span><span class=o>/</span><span class=mf>5.2</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612080402</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>zlib</span><span class=o>/</span><span class=mf>1.2</span><span class=o>.</span><span class=mi>8</span><span class=o>/</span><span class=mi>20160612064520</span>
</span></span><span class=line><span class=cl>    <span class=mf>73.06</span> <span class=n>KB</span> <span class=o>/</span> <span class=mf>73.06</span> <span class=n>KB</span> <span class=o>/</span> <span class=p>[</span><span class=o>=====================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>315.44</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>zlib</span><span class=o>/</span><span class=mf>1.2</span><span class=o>.</span><span class=mi>8</span><span class=o>/</span><span class=mi>20160612064520</span>
</span></span><span class=line><span class=cl><span class=err>↓</span> <span class=n>Downloading</span> <span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>sup</span><span class=o>/</span><span class=mf>0.7</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160614232939</span>
</span></span><span class=line><span class=cl>    <span class=mf>1.54</span> <span class=n>MB</span> <span class=o>/</span> <span class=mf>1.54</span> <span class=n>MB</span> <span class=o>|</span> <span class=p>[</span><span class=o>=======================================================================</span><span class=p>]</span> <span class=mf>100.00</span> <span class=o>%</span> <span class=mf>563.90</span> <span class=n>KB</span><span class=o>/</span><span class=n>s</span>  <span class=err>✓</span> <span class=n>Installed</span> <span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>sup</span><span class=o>/</span><span class=mf>0.7</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160614232939</span>
</span></span><span class=line><span class=cl><span class=err>★</span> <span class=n>Install</span> <span class=n>of</span> <span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>sup</span> <span class=n>complete</span> <span class=n>with</span> <span class=mi>12</span> <span class=n>packages</span> <span class=n>installed</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=err>»</span> <span class=n>Symlinking</span> <span class=n>hab</span> <span class=n>from</span> <span class=n>core</span><span class=o>/</span><span class=n>hab</span> <span class=n>into</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>pkg</span><span class=o>-</span><span class=n>dockerize</span><span class=o>-</span><span class=n>XxsS</span><span class=o>/</span><span class=n>rootfs</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>bin</span>
</span></span><span class=line><span class=cl><span class=err>★</span> <span class=n>Binary</span> <span class=n>hab</span> <span class=n>from</span> <span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=mf>0.7</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160614230104</span> <span class=n>symlinked</span> <span class=n>to</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>pkg</span><span class=o>-</span><span class=n>dockerize</span><span class=o>-</span><span class=n>XxsS</span><span class=o>/</span><span class=n>rootfs</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>hab</span>
</span></span><span class=line><span class=cl><span class=err>»</span> <span class=n>Symlinking</span> <span class=n>bash</span> <span class=n>from</span> <span class=n>core</span><span class=o>/</span><span class=n>busybox</span><span class=o>-</span><span class=k>static</span> <span class=n>into</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>pkg</span><span class=o>-</span><span class=n>dockerize</span><span class=o>-</span><span class=n>XxsS</span><span class=o>/</span><span class=n>rootfs</span><span class=o>/</span><span class=n>bin</span>
</span></span><span class=line><span class=cl><span class=err>★</span> <span class=n>Binary</span> <span class=n>bash</span> <span class=n>from</span> <span class=n>core</span><span class=o>/</span><span class=n>busybox</span><span class=o>-</span><span class=k>static</span><span class=o>/</span><span class=mf>1.24</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612081725</span> <span class=n>symlinked</span> <span class=n>to</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>pkg</span><span class=o>-</span><span class=n>dockerize</span><span class=o>-</span><span class=n>XxsS</span><span class=o>/</span><span class=n>rootfs</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=err>»</span> <span class=n>Symlinking</span> <span class=n>sh</span> <span class=n>from</span> <span class=n>core</span><span class=o>/</span><span class=n>busybox</span><span class=o>-</span><span class=k>static</span> <span class=n>into</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>pkg</span><span class=o>-</span><span class=n>dockerize</span><span class=o>-</span><span class=n>XxsS</span><span class=o>/</span><span class=n>rootfs</span><span class=o>/</span><span class=n>bin</span>
</span></span><span class=line><span class=cl><span class=err>★</span> <span class=n>Binary</span> <span class=n>sh</span> <span class=n>from</span> <span class=n>core</span><span class=o>/</span><span class=n>busybox</span><span class=o>-</span><span class=k>static</span><span class=o>/</span><span class=mf>1.24</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612081725</span> <span class=n>symlinked</span> <span class=n>to</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>pkg</span><span class=o>-</span><span class=n>dockerize</span><span class=o>-</span><span class=n>XxsS</span><span class=o>/</span><span class=n>rootfs</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sh</span>
</span></span><span class=line><span class=cl><span class=n>Sending</span> <span class=n>build</span> <span class=n>context</span> <span class=n>to</span> <span class=n>Docker</span> <span class=n>daemon</span> <span class=mf>194.3</span> <span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=n>Step</span> <span class=mi>1</span> <span class=p>:</span> <span class=n>FROM</span> <span class=n>scratch</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span>
</span></span><span class=line><span class=cl><span class=n>Step</span> <span class=mi>2</span> <span class=p>:</span> <span class=n>ENV</span> <span class=k>export</span> <span class=n>PATH</span><span class=o>=</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>glibc</span><span class=o>/</span><span class=mf>2.22</span><span class=o>/</span><span class=mi>20160612063629</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612143531</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>hab</span><span class=o>-</span><span class=n>sup</span><span class=o>/</span><span class=mf>0.7</span><span class=o>.</span><span class=mi>0</span><span class=o>/</span><span class=mi>20160614232939</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>busybox</span><span class=o>-</span><span class=k>static</span><span class=o>/</span><span class=mf>1.24</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612081725</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>bzip2</span><span class=o>/</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>6</span><span class=o>/</span><span class=mi>20160612075040</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>glibc</span><span class=o>/</span><span class=mf>2.22</span><span class=o>/</span><span class=mi>20160612063629</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>openssl</span><span class=o>/</span><span class=mf>1.0</span><span class=o>.</span><span class=mi>2</span><span class=n>h</span><span class=o>/</span><span class=mi>20160612081127</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>xz</span><span class=o>/</span><span class=mf>5.2</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612080402</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>pkgs</span><span class=o>/</span><span class=n>core</span><span class=o>/</span><span class=n>busybox</span><span class=o>-</span><span class=k>static</span><span class=o>/</span><span class=mf>1.24</span><span class=o>.</span><span class=mi>2</span><span class=o>/</span><span class=mi>20160612081725</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>bin</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=n>Running</span> <span class=ow>in</span> <span class=mf>117e90</span><span class=n>c151e7</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=mi>7</span><span class=n>f33585a25ae</span>
</span></span><span class=line><span class=cl><span class=n>Removing</span> <span class=n>intermediate</span> <span class=n>container</span> <span class=mf>117e90</span><span class=n>c151e7</span>
</span></span><span class=line><span class=cl><span class=n>Step</span> <span class=mi>3</span> <span class=p>:</span> <span class=n>WORKDIR</span> <span class=o>/</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=n>Running</span> <span class=ow>in</span> <span class=mi>952257966</span><span class=n>d96</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=n>c0cf3715cbcf</span>
</span></span><span class=line><span class=cl><span class=n>Removing</span> <span class=n>intermediate</span> <span class=n>container</span> <span class=mi>952257966</span><span class=n>d96</span>
</span></span><span class=line><span class=cl><span class=n>Step</span> <span class=mi>4</span> <span class=p>:</span> <span class=n>ADD</span> <span class=n>rootfs</span> <span class=o>/</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=n>d2691da93ccf</span>
</span></span><span class=line><span class=cl><span class=n>Removing</span> <span class=n>intermediate</span> <span class=n>container</span> <span class=mi>4</span><span class=n>aa80e97ea57</span>
</span></span><span class=line><span class=cl><span class=n>Step</span> <span class=mi>5</span> <span class=p>:</span> <span class=n>VOLUME</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>svc</span><span class=o>/</span><span class=n>mytutorialapp</span><span class=o>/</span><span class=n>data</span> <span class=o>/</span><span class=n>hab</span><span class=o>/</span><span class=n>svc</span><span class=o>/</span><span class=n>mytutorialapp</span><span class=o>/</span><span class=n>config</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=n>Running</span> <span class=ow>in</span> <span class=n>f1edcb653432</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=n>bd8888453939</span>
</span></span><span class=line><span class=cl><span class=n>Removing</span> <span class=n>intermediate</span> <span class=n>container</span> <span class=n>f1edcb653432</span>
</span></span><span class=line><span class=cl><span class=n>Step</span> <span class=mi>6</span> <span class=p>:</span> <span class=n>EXPOSE</span> <span class=mi>9631</span> <span class=mi>8080</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=n>Running</span> <span class=ow>in</span> <span class=mi>9</span><span class=n>ca7725ed13e</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=mi>256</span><span class=n>a04cd0fe2</span>
</span></span><span class=line><span class=cl><span class=n>Removing</span> <span class=n>intermediate</span> <span class=n>container</span> <span class=mi>9</span><span class=n>ca7725ed13e</span>
</span></span><span class=line><span class=cl><span class=n>Step</span> <span class=mi>7</span> <span class=p>:</span> <span class=n>ENTRYPOINT</span> <span class=o>/</span><span class=n>init</span><span class=o>.</span><span class=n>sh</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=n>Running</span> <span class=ow>in</span> <span class=mi>81930</span><span class=n>dff8f4e</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=n>d7bdec08530e</span>
</span></span><span class=line><span class=cl><span class=n>Removing</span> <span class=n>intermediate</span> <span class=n>container</span> <span class=mi>81930</span><span class=n>dff8f4e</span>
</span></span><span class=line><span class=cl><span class=n>Step</span> <span class=mi>8</span> <span class=p>:</span> <span class=n>CMD</span> <span class=n>start</span> <span class=n>martin</span><span class=o>/</span><span class=n>mytutorialapp</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=n>Running</span> <span class=ow>in</span> <span class=n>c8cc53d92bc8</span>
</span></span><span class=line><span class=cl> <span class=o>---&gt;</span> <span class=mi>8</span><span class=n>d5e0fe85395</span>
</span></span><span class=line><span class=cl><span class=n>Removing</span> <span class=n>intermediate</span> <span class=n>container</span> <span class=n>c8cc53d92bc8</span>
</span></span><span class=line><span class=cl><span class=n>Successfully</span> <span class=n>built</span> <span class=mi>8</span><span class=n>d5e0fe85395</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>5</span><span class=p>][</span><span class=n>default</span><span class=p>:</span><span class=o>/</span><span class=n>src</span><span class=p>:</span><span class=mi>0</span><span class=p>]</span><span class=c1>#</span>
</span></span></code></pre></td></tr></table></div></div><p>查看 docker 镜像是否存在。推出 studio 容器，运行 docker images</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[5][default:/src:0]# exit
</span></span><span class=line><span class=cl>logout
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>martin@localhost ~/Documents/GitHub/habitat-example-plans/mytutorialapp                                       $ docker images                                                                                          [±master ●●]
</span></span><span class=line><span class=cl>REPOSITORY                                  TAG                    IMAGE ID            CREATED             SIZE
</span></span><span class=line><span class=cl>martin/mytutorialapp                        0.1.0-20160701024401   8d5e0fe85395        3 minutes ago       187.7 MB
</span></span><span class=line><span class=cl>martin/mytutorialapp                        latest                 8d5e0fe85395        3 minutes ago       187.7 MB
</span></span></code></pre></td></tr></table></div></div><h3 id=运行这个-demo>运行这个 demo</h3><p>在命令行运行</p><p>$ docker run -it -p 8080:8080 martin/mytutorialapp</p><p>用浏览器打开 node1 的 ip 8080 端口，应该可以看到 hello world 页面。</p><p>在 rancher web 页面添加测试</p><h3 id=在-rancher-中上架这个-demo>在 rancher 中上架这个 demo</h3><p><a class=link href=https://github.com/martinliu/hab-catalog target=_blank rel=noopener>https://github.com/martinliu/hab-catalog</a> 以上代码是半成品，欢迎协助完成。</p><h3 id=测试-rancher-官方的-redis-demo>测试 Rancher 官方的 redis demo</h3><p>参考文章 <a class=link href=http://rancher.com/using-habitat-to-create-rancher-catalog-templates/ target=_blank rel=noopener>http://rancher.com/using-habitat-to-create-rancher-catalog-templates/</a> 它的 demo 和上架的目录都可以正常测试通过，但是服务运行不起来，报主机名错误，redis 节点的群集建立不起来。</p><p>如果您修复了，请回复贴出代码位置。</p><h2 id=福利调试-docker-官方投票应用>福利：调试 docker 官方投票应用</h2><p>下载投票实例程序。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>git clone https://github.com/martinliu/example-voting-app.git
</span></span></code></pre></td></tr></table></div></div><p>进入该程序的目录，修改所有 image 的来源镜像库，修改为指向本地的 mirror 服务器。 1. result/tests/Dcokerfile -> FROM 192.168.99.20:5000/node 2. result/Dockerfile -> FROM 192.168.99.20:5000/node:5.11.0-slim 3. vote/Dockerfile -> FROM 192.168.99.20:5000/python:2.7-alpine 4. worker/Dockerfile -> FROM 192.168.99.20:5000/microsoft/dotnet:1.0.0-preview1 5. docker-compose.yml -> image: 192.168.99.20:5000/redis:alpine 6. docker-compose.yml -> image: 192.168.99.20:5000/postgres:9.4</p><p>由于以上应用在构建的过程中需要在线安装各种软件包，最好先翻墙，确认你有足够稳定的国外的互联网访问，建议翻墙到美国，然后在执行项目的构建命令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ping facebook.com
</span></span><span class=line><span class=cl>64 bytes from 173.252.90.132: icmp_seq=0 ttl=79 time=4187.066 ms
</span></span><span class=line><span class=cl>64 bytes from 173.252.90.132: icmp_seq=1 ttl=79 time=3186.904 ms
</span></span><span class=line><span class=cl>64 bytes from 173.252.90.132: icmp_seq=2 ttl=79 time=2515.415 ms
</span></span><span class=line><span class=cl>64 bytes from 173.252.90.132: icmp_seq=6 ttl=79 time=296.457 ms
</span></span><span class=line><span class=cl>64 bytes from 173.252.90.132: icmp_seq=7 ttl=79 time=410.215 ms
</span></span><span class=line><span class=cl>^C
</span></span><span class=line><span class=cl>--- facebook.com ping statistics ---
</span></span><span class=line><span class=cl>8 packets transmitted, 5 packets received, 37.5% packet loss
</span></span><span class=line><span class=cl>round-trip min/avg/max/stddev = 296.457/2119.211/4187.066/1537.275 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker-compose build
</span></span></code></pre></td></tr></table></div></div><p>以上结果表明，翻墙成功，以上结果显示翻墙的效果比较差，延迟和丢包都比较严重，可能到只构建的时候下载软件包失败。</p><p>构建完毕之后，可以检查一下是否生产了目标镜像文件，如果输出如下所示，则表明本次本地的项目集成构建成功。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ docker images
</span></span><span class=line><span class=cl>REPOSITORY                            TAG                 IMAGE ID            CREATED             SIZE
</span></span><span class=line><span class=cl>examplevotingapp_result               latest              9bb4126b0905        5 minutes ago       225.8 MB
</span></span><span class=line><span class=cl>examplevotingapp_worker               latest              292396a5aba4        6 minutes ago       644.1 MB
</span></span><span class=line><span class=cl>examplevotingapp_vote                 latest              28052191beea        10 minutes ago      68.31 MB
</span></span></code></pre></td></tr></table></div></div><p>在当前 node1 节点上做本地的集成结果的功能测试，用 docker-compose 启动这个项目。先检查 compose 文件，然后运行 up。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=err>$</span><span class=w> </span><span class=n>docker</span><span class=o>-</span><span class=n>compose</span><span class=w> </span><span class=n>config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>networks</span><span class=p>:</span><span class=w> </span><span class=err>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>db</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>image</span><span class=p>:</span><span class=w> </span><span class=mi>192</span><span class=p>.</span><span class=mi>168</span><span class=p>.</span><span class=mi>99</span><span class=p>.</span><span class=mi>20</span><span class=p>:</span><span class=mi>5000</span><span class=o>/</span><span class=n>postgres</span><span class=p>:</span><span class=mi>9</span><span class=p>.</span><span class=mi>4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>image</span><span class=p>:</span><span class=w> </span><span class=mi>192</span><span class=p>.</span><span class=mi>168</span><span class=p>.</span><span class=mi>99</span><span class=p>.</span><span class=mi>20</span><span class=p>:</span><span class=mi>5000</span><span class=o>/</span><span class=n>redis</span><span class=p>:</span><span class=n>alpine</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=s1>&#39;6379&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>result</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>context</span><span class=p>:</span><span class=w> </span><span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>Documents</span><span class=o>/</span><span class=n>GitHub</span><span class=o>/</span><span class=n>example</span><span class=o>-</span><span class=n>voting</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=n>result</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>command</span><span class=p>:</span><span class=w> </span><span class=n>nodemon</span><span class=w> </span><span class=o>--</span><span class=n>debug</span><span class=w> </span><span class=n>server</span><span class=p>.</span><span class=n>js</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=mi>5001</span><span class=p>:</span><span class=mi>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=mi>5858</span><span class=p>:</span><span class=mi>5858</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>Documents</span><span class=o>/</span><span class=n>GitHub</span><span class=o>/</span><span class=n>example</span><span class=o>-</span><span class=n>voting</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=n>result</span><span class=p>:</span><span class=o>/</span><span class=n>app</span><span class=p>:</span><span class=n>rw</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>vote</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>context</span><span class=p>:</span><span class=w> </span><span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>Documents</span><span class=o>/</span><span class=n>GitHub</span><span class=o>/</span><span class=n>example</span><span class=o>-</span><span class=n>voting</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=n>vote</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>command</span><span class=p>:</span><span class=w> </span><span class=n>python</span><span class=w> </span><span class=n>app</span><span class=p>.</span><span class=n>py</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=mi>5000</span><span class=p>:</span><span class=mi>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>Documents</span><span class=o>/</span><span class=n>GitHub</span><span class=o>/</span><span class=n>example</span><span class=o>-</span><span class=n>voting</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=n>vote</span><span class=p>:</span><span class=o>/</span><span class=n>app</span><span class=p>:</span><span class=n>rw</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>worker</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>context</span><span class=p>:</span><span class=w> </span><span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=n>martin</span><span class=o>/</span><span class=n>Documents</span><span class=o>/</span><span class=n>GitHub</span><span class=o>/</span><span class=n>example</span><span class=o>-</span><span class=n>voting</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=n>worker</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;2.0&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>volumes</span><span class=p>:</span><span class=w> </span><span class=err>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=err>$</span><span class=w> </span><span class=n>docker</span><span class=o>-</span><span class=n>compose</span><span class=w> </span><span class=n>up</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Recreating</span><span class=w> </span><span class=n>examplevotingapp_vote_1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Recreating</span><span class=w> </span><span class=n>examplevotingapp_worker_1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Starting</span><span class=w> </span><span class=n>examplevotingapp_db_1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Starting</span><span class=w> </span><span class=n>examplevotingapp_redis_1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Recreating</span><span class=w> </span><span class=n>examplevotingapp_result_1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Attaching</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>examplevotingapp_db_1</span><span class=p>,</span><span class=w> </span><span class=n>examplevotingapp_redis_1</span><span class=p>,</span><span class=w> </span><span class=n>examplevotingapp_worker_1</span><span class=p>,</span><span class=w> </span><span class=n>examplevotingapp_result_1</span><span class=p>,</span><span class=w> </span><span class=n>examplevotingapp_vote_1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>                 </span><span class=n>_</span><span class=p>.</span><span class=n>_</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>            </span><span class=n>_</span><span class=p>.</span><span class=o>-``</span><span class=n>__</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=o>-</span><span class=p>.</span><span class=n>_</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>       </span><span class=n>_</span><span class=p>.</span><span class=o>-``</span><span class=w>    </span><span class=o>`</span><span class=p>.</span><span class=w>  </span><span class=o>`</span><span class=n>_</span><span class=p>.</span><span class=w>  </span><span class=s1>&#39;&#39;</span><span class=o>-</span><span class=p>.</span><span class=n>_</span><span class=w>           </span><span class=n>Redis</span><span class=w> </span><span class=mi>3</span><span class=p>.</span><span class=mi>2</span><span class=p>.</span><span class=mi>1</span><span class=w> </span><span class=p>(</span><span class=mi>00000000</span><span class=o>/</span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=mi>64</span><span class=w> </span><span class=kt>bit</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>   </span><span class=p>.</span><span class=o>-``</span><span class=w> </span><span class=p>.</span><span class=o>-```</span><span class=p>.</span><span class=w>  </span><span class=o>```</span><span class=err>\</span><span class=o>/</span><span class=w>    </span><span class=n>_</span><span class=p>.,</span><span class=n>_</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=o>-</span><span class=p>.</span><span class=n>_</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>db_1</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>LOG</span><span class=p>:</span><span class=w>  </span><span class=k>database</span><span class=w> </span><span class=n>system</span><span class=w> </span><span class=n>was</span><span class=w> </span><span class=n>shut</span><span class=w> </span><span class=n>down</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=mi>2016</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>20</span><span class=w> </span><span class=mi>09</span><span class=p>:</span><span class=mi>58</span><span class=p>:</span><span class=mi>19</span><span class=w> </span><span class=n>UTC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>  </span><span class=p>(</span><span class=w>    </span><span class=s1>&#39;      ,       .-`  | `,    )     Running in standalone mode
</span></span></span><span class=line><span class=cl><span class=s1>redis_1   |  |`-._`-...-` __...-.``-._|&#39;</span><span class=o>`</span><span class=w> </span><span class=n>_</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;|     Port: 6379
</span></span></span><span class=line><span class=cl><span class=s1>redis_1   |  |    `-._   `._    /     _.-&#39;</span><span class=w>    </span><span class=o>|</span><span class=w>     </span><span class=n>PID</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>   </span><span class=o>`-</span><span class=p>.</span><span class=n>_</span><span class=w>    </span><span class=o>`-</span><span class=p>.</span><span class=n>_</span><span class=w>  </span><span class=o>`-</span><span class=p>.</span><span class=o>/</span><span class=w>  </span><span class=n>_</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;    _.-&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>  </span><span class=o>|`-</span><span class=p>.</span><span class=n>_</span><span class=o>`-</span><span class=p>.</span><span class=n>_</span><span class=w>    </span><span class=o>`-</span><span class=p>.</span><span class=n>__</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;    _.-&#39;</span><span class=n>_</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;|
</span></span></span><span class=line><span class=cl><span class=s1>redis_1   |  |    `-._`-._        _.-&#39;</span><span class=n>_</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;    |           http://redis.io
</span></span></span><span class=line><span class=cl><span class=s1>redis_1   |   `-._    `-._`-.__.-&#39;</span><span class=n>_</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;    _.-&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>  </span><span class=o>|`-</span><span class=p>.</span><span class=n>_</span><span class=o>`-</span><span class=p>.</span><span class=n>_</span><span class=w>    </span><span class=o>`-</span><span class=p>.</span><span class=n>__</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;    _.-&#39;</span><span class=n>_</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;|
</span></span></span><span class=line><span class=cl><span class=s1>db_1      | LOG:  MultiXact member wraparound protections are now enabled
</span></span></span><span class=line><span class=cl><span class=s1>redis_1   |  |    `-._`-._        _.-&#39;</span><span class=n>_</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;    |
</span></span></span><span class=line><span class=cl><span class=s1>redis_1   |   `-._    `-._`-.__.-&#39;</span><span class=n>_</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;    _.-&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>db_1</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>LOG</span><span class=p>:</span><span class=w>  </span><span class=k>database</span><span class=w> </span><span class=n>system</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>ready</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>accept</span><span class=w> </span><span class=n>connections</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>       </span><span class=o>`-</span><span class=p>.</span><span class=n>_</span><span class=w>    </span><span class=o>`-</span><span class=p>.</span><span class=n>__</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;    _.-&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>           </span><span class=o>`-</span><span class=p>.</span><span class=n>_</span><span class=w>        </span><span class=n>_</span><span class=p>.</span><span class=o>-</span><span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>redis_1   |               `-.__.-&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=p>:</span><span class=n>M</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=n>Jun</span><span class=w> </span><span class=mi>10</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>36</span><span class=p>.</span><span class=mi>216</span><span class=w> </span><span class=c1># WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=p>:</span><span class=n>M</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=n>Jun</span><span class=w> </span><span class=mi>10</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>36</span><span class=p>.</span><span class=mi>216</span><span class=w> </span><span class=c1># Server started, Redis version 3.2.1
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=p>:</span><span class=n>M</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=n>Jun</span><span class=w> </span><span class=mi>10</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>36</span><span class=p>.</span><span class=mi>216</span><span class=w> </span><span class=c1># WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add &#39;vm.overcommit_memory = 1&#39; to /etc/sysctl.conf and then reboot or run the command &#39;sysctl vm.overcommit_memory=1&#39; for this to take effect.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>db_1</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>LOG</span><span class=p>:</span><span class=w>  </span><span class=n>autovacuum</span><span class=w> </span><span class=n>launcher</span><span class=w> </span><span class=n>started</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=p>:</span><span class=n>M</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=n>Jun</span><span class=w> </span><span class=mi>10</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>36</span><span class=p>.</span><span class=mi>216</span><span class=w> </span><span class=c1># WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command &#39;echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled&#39; as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>redis_1</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=p>:</span><span class=n>M</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=n>Jun</span><span class=w> </span><span class=mi>10</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>36</span><span class=p>.</span><span class=mi>216</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>The</span><span class=w> </span><span class=n>server</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>now</span><span class=w> </span><span class=n>ready</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>accept</span><span class=w> </span><span class=n>connections</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>port</span><span class=w> </span><span class=mi>6379</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>vote_1</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=o>*</span><span class=w> </span><span class=n>Running</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=p>:</span><span class=mi>80</span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=n>Press</span><span class=w> </span><span class=n>CTRL</span><span class=o>+</span><span class=n>C</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>quit</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>vote_1</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=o>*</span><span class=w> </span><span class=n>Restarting</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=n>stat</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>result_1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=p>[</span><span class=n>nodemon</span><span class=p>]</span><span class=w> </span><span class=mi>1</span><span class=p>.</span><span class=mi>9</span><span class=p>.</span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>result_1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=p>[</span><span class=n>nodemon</span><span class=p>]</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>restart</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=n>any</span><span class=w> </span><span class=kt>time</span><span class=p>,</span><span class=w> </span><span class=n>enter</span><span class=w> </span><span class=o>`</span><span class=n>rs</span><span class=o>`</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>result_1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=p>[</span><span class=n>nodemon</span><span class=p>]</span><span class=w> </span><span class=n>watching</span><span class=p>:</span><span class=w> </span><span class=o>*</span><span class=p>.</span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>result_1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=p>[</span><span class=n>nodemon</span><span class=p>]</span><span class=w> </span><span class=k>starting</span><span class=w> </span><span class=o>`</span><span class=n>node</span><span class=w> </span><span class=o>--</span><span class=n>debug</span><span class=w> </span><span class=n>server</span><span class=p>.</span><span class=n>js</span><span class=o>`</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>result_1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Debugger</span><span class=w> </span><span class=n>listening</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>port</span><span class=w> </span><span class=mi>5858</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>vote_1</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=o>*</span><span class=w> </span><span class=n>Debugger</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>active</span><span class=o>!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>vote_1</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=o>*</span><span class=w> </span><span class=n>Debugger</span><span class=w> </span><span class=n>pin</span><span class=w> </span><span class=n>code</span><span class=p>:</span><span class=w> </span><span class=mi>139</span><span class=o>-</span><span class=mi>254</span><span class=o>-</span><span class=mi>286</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>worker_1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Found</span><span class=w> </span><span class=n>redis</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=mi>172</span><span class=p>.</span><span class=mi>19</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>result_1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Mon</span><span class=p>,</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=n>Jun</span><span class=w> </span><span class=mi>2016</span><span class=w> </span><span class=mi>10</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>40</span><span class=w> </span><span class=n>GMT</span><span class=w> </span><span class=n>body</span><span class=o>-</span><span class=n>parser</span><span class=w> </span><span class=n>deprecated</span><span class=w> </span><span class=n>bodyParser</span><span class=p>:</span><span class=w> </span><span class=k>use</span><span class=w> </span><span class=n>individual</span><span class=w> </span><span class=n>json</span><span class=o>/</span><span class=n>urlencoded</span><span class=w> </span><span class=n>middlewares</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=n>server</span><span class=p>.</span><span class=n>js</span><span class=p>:</span><span class=mi>67</span><span class=p>:</span><span class=mi>9</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>result_1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Mon</span><span class=p>,</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=n>Jun</span><span class=w> </span><span class=mi>2016</span><span class=w> </span><span class=mi>10</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>40</span><span class=w> </span><span class=n>GMT</span><span class=w> </span><span class=n>body</span><span class=o>-</span><span class=n>parser</span><span class=w> </span><span class=n>deprecated</span><span class=w> </span><span class=n>undefined</span><span class=w> </span><span class=n>extended</span><span class=p>:</span><span class=w> </span><span class=n>provide</span><span class=w> </span><span class=n>extended</span><span class=w> </span><span class=k>option</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=p>..</span><span class=o>/</span><span class=n>node_modules</span><span class=o>/</span><span class=n>body</span><span class=o>-</span><span class=n>parser</span><span class=o>/</span><span class=k>index</span><span class=p>.</span><span class=n>js</span><span class=p>:</span><span class=mi>105</span><span class=p>:</span><span class=mi>29</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>result_1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>App</span><span class=w> </span><span class=n>running</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>port</span><span class=w> </span><span class=mi>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>result_1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Connected</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>db</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>打开浏览器测试 vote 应用。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>open http://192.168.99.114:5000
</span></span></code></pre></td></tr></table></div></div><p>正常显示结果如下图所示： <img src=http://yzd.io/images/voting-1.jpg loading=lazy alt=voting></p><p>打开浏览器测试 result 应用。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>open http://192.168.99.114:5001
</span></span></code></pre></td></tr></table></div></div><p>正常显示结果如下图所示： <img src=http://yzd.io/images/result-1.jpg loading=lazy alt=result></p><p>在 Rancher 的 hosts 界面中应该看到这些运行的容器。 <img src=http://yzd.io/images/voting-in-rancher-1.jpg loading=lazy alt=voting-in-ranche></p><p>至此所有关于应用构建和功能测试的过程完成，按 ctl + c 结束 docker-compose up 的运行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>^CGracefully stopping... (press Ctrl+C again to force)
</span></span><span class=line><span class=cl>Stopping examplevotingapp_worker_1 ... done
</span></span><span class=line><span class=cl>Stopping examplevotingapp_result_1 ... done
</span></span><span class=line><span class=cl>Stopping examplevotingapp_vote_1 ... done
</span></span><span class=line><span class=cl>Stopping examplevotingapp_db_1 ... done
</span></span><span class=line><span class=cl>Stopping examplevotingapp_redis_1 ... done
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/docker/>Docker</a>
<a href=/tags/habitat/>Habitat</a>
<a href=/tags/rancher/>Rancher</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>署名-非商业性使用-禁止演绎 4.0 (CC BY-NC-ND 4.0)</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>最后更新于 2022-10-09 21:44 CST</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/2015/07/18/atomic-host-e58e9fe5ad90e4b8bbe69cbae69c80e7ae80e6b58be8af95/><div class=article-details><h2 class=article-title>Atomic Host 原子主机最简测试</h2></div></a></article><article><a href=/2015/06/07/e59ca8centos-7e4b88ae5ae89e8a385e983a8e7bdb2katello2-2/><div class=article-details><h2 class=article-title>在CentOS 7上安装部署Katello2.2</h2></div></a></article><article><a href=/2015/06/05/e5ae89e8a385e5ae8ce7be8e-centos7-e8999ae68b9fe69cbae6a8a1e69dbf/><div class=article-details><h2 class=article-title>安装完美 CentOS7 虚拟机模板</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//martinliu.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2007 -
2025 Martin Liu's Blog</section><section class=powerby>本博客始于 2007 年<br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.29.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>